{"version":3,"sources":["tools.js","Components/i18n.js","Components/PageStart/index.js","Components/PageLoadImages/index.js","Components/PageEditor/ImageThumb.js","Components/PageEditor/ImageEditorZoomCanvas.js","Components/PageEditor/ImageEditorZoom.js","Components/PageEditor/ImageEditorColorCanvas.js","Components/PageEditor/ImageEditorBrightness.js","Components/PageEditor/ImageEditorColor.js","Components/PageEditor/ImageEditor.js","Components/PageEditor/index.js","Components/PageSetup/PageSetupFormats.js","Components/PageSetup/PageSetupArchive.js","Components/PageSetup/PageSetupSources.js","Components/PageSetup/PageSetupParameters.js","Components/PageSetup/index.js","Components/PagePrint/index.js","Components/SetupPin.js","Components/LoaderSplashScreen.js","App.js","index.js"],"names":["AJAX_URI","window","location","href","THEME","createMuiTheme","palette","primary","main","makeGetUri","param","str","key","hasOwnProperty","push","encodeURIComponent","uri","join","ColorCorrection","pixelArray","gain","contrast","gainR","gainG","gainB","intercept","i","data","length","saturate","amount","r","g","b","ColorSepia","calculateImageDimensions","app","indexImage","image","images","realRatio","editorState","imageZoom","ratio","viewportWidth","editorWidth","maskLR","viewportHeight","editorHeight","maskTB","sX","sliderPositionLR","sY","sliderPositionTB","sW","imgWidth","sH","imgHeight","imageRotate","centerX","TB","LR","cW","cH","cX","cY","pX","pY","pW","pH","dpi_dots2inch","dots","dpi","undefined","dpi_inch2dots","inch","Round","x","dec","String","replace","parseFloat","isNaN","toFixed","parseInt","setLang","newLang","i18n","LANG","getLangs","langs","prop","caption","langCaption","t","en","ua","Wait a moment while app loading","Cancel","Warning","Next","Previous","Print","Save","Loaded already","Name","Height","Width","Surface","glance","matte","Files","Selected","Cost","Are you sure?","error","error status, let see log","Select CD, flash card or other source, then select format what you want, and press button","Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture","To continue you should select at least one image","Select all","Select none","No images","Current state of editor images will be lost.","Format","Amount","Total","Successful printed","The number of your order is","Dont forget to remove your source.","Thank you!","PageStart","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","clientUploadProgress","progress","percentage","Math","floor","loaded","total","appSetState","progressBarValue","clientUpload","event","formData","FormData","uploadfiles","target","files","isPleaseWait","config","onUploadProgress","Ev","headers","Content-Type","append","axios","post","tools","q","p","isSetupPassword","then","checkSources","catch","console","log","finally","openLangsPanel","setState","isLangsOpen","state","checkSourceTimer","checkSourceTimerMax","checkSourceTimerCount","clearTimeout","_this2","sources","slice","len","hasFiles","prevProps","prevState","snapshot","isUploadEnable","inputUpload","click","initRefresh","_this3","_loop","enabled","emptyhide","id","get","res","status","setTimeout","bind","_this4","langsList","react_default","a","createElement","ClickAwayListener_default","onClickAway","Paper_default","className","map","lang","index","onClick","scope","Icon_default","source","Card_default","currentSource","onClickSource","CardContent_default","src","icon","alt","name","formats","format","currentFormat","onClickFormat","height","width","round","surface","cost","disabled","onClickNextBtn","type","style","minWidth","title","isSetup","version","htmlFor","ref","input","multiple","onChange","e","LinearProgress_default","variant","value","React","Component","resetState","folders","tree","currentFolder","is_loadind_images","expandedImage","progressAjax","previewMaxResize","isAutoclearLoading","isAutoclearLoaded","PageLoadImages","nextPage","selectedimages","filter","marked","dirs","dir","params","URLSearchParams","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","_d","err","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_f","onDownloadProgress","progressEvent","percentCompleted","lengthComputable","thumbname","thumbs","substr","lastIndexOf","extension","width_pixel","height_pixel","orientation","thumb","works","count","imageZoomMax","imageZoomMin","colorR","colorG","colorB","brightness","sepia","initedImagePosition","initedMask","currentTab","response","responderEnd","onMessage","imagesContainer","isAutoclearTimer","autoclear","onClickDir","direction","scrollTop","scrollHeight","rowH","ceil","currentDir","list","level","_L","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","precache","imagesScroll","reopenThumb","_this5","newIm","reopen","mode","changed","children","viewHeight","clientHeight","is_appeared","rect","getBoundingClientRect","bottom","top","_this6","node","onScroll","PageLoadImages_ImagePreview","assign","itemIndex","onExpand","showExpandImg","onMark","MarkImage","setpreviewMaxResize","role","onClickPrevBtn","scrollImages","markAllImages","PageLoadImages_ModalExpand","itemCurrent","itemPrev","itemNext","onClose","hideExpandImg","ImagePreview","_this7","rotate","imgWrapper","clientWidth","imgStyle","backgroundImage","max","onDoubleClick","Fab_default","stopPropagation","aria-label","PureComponent","ModalExpand","_this8","imgsrc","ImageThumb","nodeThumb","scrollRef","thumbWidth","selected","scrollIntoView","boxStyles","styles","clrZoom","clrFilters","clrColors","onSelect","encodeURI","backgroundColor","color","contrastText","fontSize","ImageEditorZoomCanvas","onDragStart","preventDefault","movingStart","dragImage","dragX","dragY","movingOn","screenX","screenY","shiftX","shiftY","currentImage","appImageChanged","movingStop","canvasImg","Image","crossOrigin","_upd","updateCanvas","assertThisInitialized","onload","renderedImageIndex","imgSrc","appEditorChanged","myImgContainer","img_src","alignInit","appImageInitMask","myCanvas","ctx","getContext","canvasX","canvasY","drawImage","getImageData","putImageData","isDebugShow","_calculateImageDimens","z","lineWidth","strokeStyle","strokeRect","w","newImage","rL","rR","rT","rB","maskTBStyle","viewportStyles","left","maskLRStyle","canvasWidth","canvasHeight","canvasStyle","transform","onMouseMove","onMouseUp","draggable","onMouseDown","ImageEditorZoom","sliderZoom","L","T","newState","needUpdateCanvas","sliderChangeTB","sliderChangeLR","Slider_default","classes","vertical","min","ImageEditorZoomCanvas_ImageEditorZoomCanvas","trackAfter","alignTop","alignLeft","alignLandscape","alignPortrait","alignRight","alignBottom","ImageEditorColorCanvas","fakeThins","ImageEditorBrightness","sliderChangeBrightness","sliderChangeContrast","sliderChangeSaturate","sliderResetBrightness","sliderResetContrast","sliderResetSaturate","sliderChangeSepia","ImageEditorColorCanvas_ImageEditorColorCanvas","FormControlLabel_default","control","Switch_default","checked","label","sliderChangeColorR","sliderChangeColorG","sliderChangeColorB","sliderResetColorR","sliderResetColorG","sliderResetColorB","track","step","ImageEditor","editorControlsStyle","showTabButton","tabChange","editorWrapper","editorTabs","ImageEditorZoom_ImageEditorZoom","ImageEditorBrightness_ImageEditorBrightness","ImageEditorColor_ImageEditorBrightness","right","changeCountImage","PageEditor","checkUndo","undo","history","current","clickUndo","currentUndo","skipChanges","checkRedo","clickRedo","selectImage","changeCurrentImage","newCurrent","countSumm","scrollIntoViewIfNeed","domNode","scrollIntoViewIfNeeded","openFormatsPanel","isFormatsOpen","repeatColors","colors","getColorsToRepeat","hasChange","confirmBack","imagesCount","imagesSum","nextProps","nextState","nextContext","wasChanged","l","leftChain","rightChain","compare2Objects","y","Date","RegExp","Number","toString","isPrototypeOf","constructor","prototype","indexOf","pop","arguments","start","savePages","back","formatsList","formatChange","display","visibility","processCanvasNode","ImageEditor_ImageEditor","processCanvas","backPressed","colSpan","ImageThumb_ImageThumb","Dialog_default","open","backConfirmed","aria-labelledby","aria-describedby","DialogTitle_default","DialogContent_default","DialogContentText_default","DialogActions_default","autoFocus","PageSetupFormats","editedFormats","formatNew","last","formatRemove","splice","ev","JSON","stringify","shift","newIndex","tmp","data-hint","h","portrait","formatMove","size","formatSave","PageSetupArchive","arhives","currentArchive","isLoading","archiveFiles","currentArchiveFile","isMultipleSelectOrders","isDeleteConfirmation","loadList","d","folder","archCount","as","_remove","archiveCount","archiveTotal","archiveDate","date","time","archiveFile","selectedArchiveCount","selectArchive","f","selectFile","file","toggleMultiple","tryDeleteArchive","deleteArchive","PageSetupSources","editedSources","listIcons","listScripts","scriptTxt","sourceNew","sourceRemove","sourceChange","script","data-value","path","scripton","viewScript","scriptoff","sourceMove","sourcesSave","maxWidth","readOnly","PageSetupParameters","inputNP","inputNP2","setup","removeOlder","removeArchiveOlder","inputTyped","needConfigure","document","reload","namingOption","autoComplete","savePass","processMode","setupChange","batchSaveMode","copiesMode","printNaming","n","copiesNaming","removeOlderToggle","saveParameters","PageSetup","openTab","tab","PageSetupFormats_PageSetupFormats","PageSetupSources_PageSetupSources","PageSetupParameters_PageSetupParameters","PageSetupArchive_PageSetupArchive","appWidth","appHeight","confirm","Logout","PagePrint","orderFolder","orderNum","savingImages","orderPrinted","saveImage","first","party","imageslen","processed","savePartialProgress","forEach","autoInitImage","canvas","fn_callback","img","alpha","fillStyle","fillRect","zX","zY","translate","PI","sx","sy","toDataURL","DataURL","job_done","temporary","_flen","ims","summary","totalSum","cnt","j","sum","checkBeforeSaveImage","SetupPin","pwd","passTyped","numb","isSetupLogged","onSubmit","Login","numbClick","LoaderSplashScreen","caseInfinityLoop","tm","serverError","langOnLoad","App","appstate","pages","is_loading_init","snackMessage","isAppStarting","stateToSave","initrotate","format_lanscape","init","viewportY","isWhiteFields","viewportX","checkLoadedState","msg","onMessageHide","uploadEnable","pass","scriptSource","s_key","scripts","autoclearSource","source_id","updateSavePageTimer","appWrapperNode","force","removeEventListener","updateDimensions","addEventListener","message","reset","pageid","pagestate","OKmessage","newAppState","args","removeTmp","resetApp","alert","wrongOrientation","toRenderd","LoaderSplashScreen_LoaderSplashScreen","PageSetup_PageSetup","PageStart_PageStart","sourceClick","formatClick","ClickNextBtn","PageLoadImages_PageLoadImages","ClickPrevBtn","PageEditor_PageEditor","PagePrint_PagePrint","CssBaseline_default","core_styles","theme","SetupPin_SetupPin","Snackbar_default","anchorOrigin","horizontal","autoHideDuration","ContentProps","action","IconButton_default","Close_default","ReactDOM","render","src_App_0","getElementById"],"mappings":"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","file":"static/js/main.5162c34d.chunk.js","sourcesContent":["import { createMuiTheme } from '@material-ui/core/styles';\n\n// must have finishing slash\nexport const AJAX_URI = (window.location.href==='http://localhost:3000/' || window.location.href==='http://localhost:3000') ? 'http://192.168.10.242/server/' : '/server/';\n\n\nexport const THEME = createMuiTheme({\n    palette: {\n        primary: {\n            main:'#007bff',\n        },\n    }\n});\n\nexport function makeGetUri(param) {\n\n    let str = [];\n    for (let key in param)\n        if (param.hasOwnProperty(key)) {\n            str.push(encodeURIComponent(key) + \"=\" + encodeURIComponent(param[key]));\n        }\n    let uri = str.join(\"&\");\n    uri = AJAX_URI+(uri!=='' ? '?'+uri : '');\n\n    return uri;\n}\n\n// 1 inch ≈ 2.54 cm\n// 300 dpi = 300/2.54 ≈ 118.11 dpcm (dot per cantimeter)\n\nexport function ColorCorrection(pixelArray, gain, contrast, gainR, gainG, gainB) {\n    const intercept = 128 * (1 - contrast);\n\n    for (let i = 0; i < pixelArray.data.length; i += 4) {\n        pixelArray.data[i] *= gainR * gain;\n        pixelArray.data[i + 1] *= gainG *gain;\n        pixelArray.data[i + 2] *= gainB *gain;\n\n        pixelArray.data[i] = pixelArray.data[i] * contrast + intercept;\n        pixelArray.data[i+1] = pixelArray.data[i+1] * contrast + intercept;\n        pixelArray.data[i+2] = pixelArray.data[i+2] * contrast + intercept;\n\n        // pixelArray.data[i] = 255 * Math.pow(pixelArray.data[i] / 255, 1 / gamma);\n        // pixelArray.data[i + 1] = 255 * Math.pow(pixelArray.data[i + 1] / 255, 1 / gamma);\n        // pixelArray.data[i + 2] = 255* Math.pow(pixelArray.data[i + 2] / 255, 1 / gamma);\n        //\n        // pixelArray.data[i] = 255 * (pixelArray.data[i]/255 + offset);\n        // pixelArray.data[i + 1] = 255 * (pixelArray.data[i + 1] / 255 + offset);\n        // pixelArray.data[i + 2] = 255 * (pixelArray.data[i + 2] / 255 + offset);\n    }\n    return pixelArray;\n}\n\nexport function saturate(pixelArray, amount) {\n    let r,g,b;\n\n    for (let i=0; i < pixelArray.data.length; i += 4) {\n        r = (.213 + .787 * amount) * pixelArray.data[i]\n            + (.715 - .715 * amount) * pixelArray.data[i + 1]\n            + (.072 - .072 * amount) * pixelArray.data[i + 2];\n        g = (.213 - .213 * amount) * pixelArray.data[i]\n            + (.715 + .285 * amount) * pixelArray.data[i + 1]\n            + (.072 - .072 * amount) * pixelArray.data[i + 2];\n        b = (.213 - .213 * amount) * pixelArray.data[i]\n            + (.715 - .715 * amount) * pixelArray.data[i + 1]\n            + (.072 + .928 * amount) * pixelArray.data[i + 2];\n\n        pixelArray.data[i] = r;\n        pixelArray.data[i + 1] = g;\n        pixelArray.data[i + 2] = b;\n    }\n    return pixelArray;\n}\n\nexport function ColorSepia (pixelArray) {\n    let r,g,b;\n    for (let i=0; i < pixelArray.data.length; i += 4) {\n\n        r = pixelArray.data[i] * 0.393 + pixelArray.data[i+1] * 0.769 + pixelArray.data[i+2] * 0.189;\n        g = pixelArray.data[i] * 0.349 + pixelArray.data[i+1] * 0.686 + pixelArray.data[i+2] * 0.168;\n        b = pixelArray.data[i] * 0.272 + pixelArray.data[i+1] * 0.534 + pixelArray.data[i+2] * 0.131;\n\n        pixelArray.data[i] = r;\n        pixelArray.data[i+1] = g;\n        pixelArray.data[i+2] = b;\n    }\n    return pixelArray;\n}\n\nexport function calculateImageDimensions(app, indexImage) {\n    const image = app.images[indexImage];\n    const realRatio = image.editorState.imageZoom*image.editorState.ratio;\n\n    let viewportWidth = app.editorWidth - image.editorState.maskLR*2;\n    let viewportHeight = app.editorHeight - image.editorState.maskTB*2;\n    // let formatWidth = dpi_inch2dots(image.format.width, image.format.dpi);\n    // let formatHeight = dpi_inch2dots(image.format.height, image.format.dpi);\n\n\n\n    let sX = image.editorState.sliderPositionLR*-1;\n    let sY = image.editorState.sliderPositionTB*-1;\n    let sW = image.editorState.imgWidth;\n    let sH = image.editorState.imgHeight;\n    // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\n    if(image.editorState.imageRotate===0 || image.editorState.imageRotate===180) {\n        if(sX>0) {\n            sW -= sX;\n        } else if(sX<0) {\n            sX=0;\n        }\n        if(sW+image.editorState.sliderPositionLR+sX>viewportWidth) {\n            sW = viewportWidth-image.editorState.sliderPositionLR-sX;\n        }\n        if(sW<0) sW = 0;\n        // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\n        if(sY>0) {\n            sH -= sY;\n            if(sY>image.editorState.imgHeight) sY = image.editorState.imgHeight;\n        } else if(sY<0) {\n            sY=0;\n        }\n        if(sH+image.editorState.sliderPositionTB+sY>viewportHeight) {\n            sH = viewportHeight-image.editorState.sliderPositionTB-sY;\n        }\n        if(sH<0) sH = 0;\n\n    } else { // --------------------------------------------rotated 90 / 270\n        let centerX = image.editorState.sliderPositionLR+image.editorState.imgWidth/2;\n        let centerY = image.editorState.sliderPositionTB+image.editorState.imgHeight/2;\n\n        let TB = centerY - image.editorState.imgWidth/2;\n        sX = 0;\n        if(TB+sW>viewportHeight) { sW = viewportHeight-TB; }\n        if(TB<0) { sX=TB*-1; sW-=sX; }\n        if(TB>viewportHeight){ sW = 0; }\n\n        let LR = centerX - image.editorState.imgHeight/2;\n        sY = 0;\n        if(LR+sH>viewportWidth) { sY = LR+sH-viewportWidth; sH-=sY;  }\n        if(LR<0) { sH += LR; }\n        if(LR>viewportWidth){ sH = 0; }\n\n    }\n    if(image.editorState.imageRotate===180 || image.editorState.imageRotate===270) { // 180 --- upside // 270 --- upside\n        sX = image.editorState.imgWidth - sW - sX;\n        sY = image.editorState.imgHeight - sH - sY;\n    }\n\n\n    // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\n\n    let cW = sW; //#######################################################################################\n    let cH = sH; //#######################################################################################\n\n    sX /= realRatio;\n    sY /= realRatio;\n    sW /= realRatio;\n    sH /= realRatio;\n    // console.log(' ------- Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH), 'dims:', Math.round(sX+sW),Math.round(sY+sH));\n\n\n    let cX = image.editorState.sliderPositionLR;\n    let cY = image.editorState.sliderPositionTB;\n    // console.log(' ------- Pre-Canvas : ',  Math.round(cX), Math.round(cY), Math.round(cW), Math.round(cH));\n    if(cX<0) {\n        cX = 0;\n    }\n    if(cY<0) {\n        cY = 0;\n    }\n\n    // console.log(' ------- Canvas : ',  Math.round(cX), Math.round(cY), Math.round(cW), Math.round(cH) );\n\n    cX /=image.editorState.ratio;\n    cY /=image.editorState.ratio;\n    cW /=image.editorState.ratio;\n    cH /=image.editorState.ratio;\n\n\n    let pX = image.editorState.sliderPositionLR;\n    let pY = image.editorState.sliderPositionTB;\n    let pW = image.editorState.imgWidth;\n    let pH = image.editorState.imgHeight;\n    // console.log('Pre-values: ',  Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\n    if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n        // let imageCenterX = pX + pW/2;\n        // let imageCenterY = pY + pH/2;\n        pX = (pX + pW/2) - pH/2;\n        pY = (pY + pH/2) - pW/2;\n\n        pW = image.editorState.imgHeight;\n        pH = image.editorState.imgWidth;\n    }\n    // console.log('Pre-values: ',  Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\n    if(pW+pX>viewportWidth) {\n        pW = viewportWidth-pX;\n    }\n    if(pX<0) {\n        pW += pX;\n        pX = 0;\n    }\n    if(pW<0) pW = 0;\n\n    if(pH+pY>viewportHeight) {\n        pH = viewportHeight-pY;\n    }\n    if(pY<0) {\n        pH += pY;\n        pY = 0;\n    }\n    if(pH<0) pH = 0;\n\n\n    pX /=image.editorState.ratio;\n    pY /=image.editorState.ratio;\n    pW /=image.editorState.ratio;\n    pH /=image.editorState.ratio;\n\n    // console.log('------Ret-values: ', Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\n\n\n\n    return {\n        sX: sX, sY: sY, sW: sW, sH: sH,\n\n        cX: cX, cY: cY, cW: cW, cH: cH,\n\n        pX: pX, pY: pY, pW: pW, pH: pH,\n    };\n\n}\n\nexport function processImage(canvas, app, index, fn_callback) {\n    // this.props.parentProps.image\n    const image = app.images[index];\n\n    console.log(image);\n    if(typeof fn_callback !== 'function') return;\n\n    let img = new Image();\n    img.crossOrigin = 'anonymous';\n\n    img.onload=function(){\n\n\n        if(image.editorState.imageRotate === 0 || image.editorState.imageRotate === 180) {\n            canvas.width = dpi_inch2dots(image.format.width, image.format.dpi);\n            canvas.height = dpi_inch2dots(image.format.height, image.format.dpi);\n        } else {\n            canvas.width = dpi_inch2dots(image.format.height, image.format.dpi);\n            canvas.height = dpi_inch2dots(image.format.width, image.format.dpi);\n        }\n\n\n        const p = calculateImageDimensions(app, index);\n\n        const ctx = canvas.getContext('2d', {alpha: false});\n        ctx.fillStyle = \"#ffffff\";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n                        console.log('processImage', p);\n\n        if(image.editorState.imageRotate !== 0) {\n            ctx.drawImage(img, p.sX, p.sX, p.sW, p.sH, p.cX, p.cY, p.cW, p.cH);\n        } else {\n            let zX = canvas.width/-2;\n            let zY = canvas.height/-2;\n            if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n                let t = canvas.width;\n                canvas.width = canvas.height;\n                canvas.height = t;\n            }\n            ctx.translate(canvas.width / 2, canvas.height / 2);\n            ctx.rotate(image.editorState.imageRotate * Math.PI / 180);\n            ctx.drawImage(img, p.sx, p.sy, p.sW, p.sH, zX + p.cX, zY + p.cY, p.cW, p.cH);\n\n        }\n\n        let pixelArray = ctx.getImageData(Math.floor(p.pX), Math.floor(p.pY), Math.ceil(p.pW), Math.ceil(p.pH) );\n\n        if(image.editorState.brightness!==1 || image.editorState.contrast!==1 || image.editorState.colorR!==1 || image.editorState.colorG!==1 || image.editorState.colorB!==1 ) {\n            pixelArray = ColorCorrection(pixelArray, image.editorState.brightness, image.editorState.contrast, image.editorState.colorR, image.editorState.colorG, image.editorState.colorB);\n        }\n        if(image.editorState.sepia) {\n            pixelArray = ColorSepia(pixelArray, 1);\n        }\n        if(image.editorState.saturate!==1) {\n            pixelArray = saturate(pixelArray, image.editorState.saturate);\n        }\n\n        ctx.putImageData(pixelArray, Math.floor(p.pX), Math.floor(p.pY));\n\n        //const dataURL = this.myCanvas.toDataURL('image/png');\n        fn_callback( canvas.toDataURL('image/jpeg', 0.7) );\n    };\n    img.src= makeGetUri()+image.src;\n\n}\n\nexport function dpi_dots2cm(dots, dpi) {\n    if(dpi===undefined || !dpi) dpi = 300;\n    return dots / (dpi / 2.54);\n}\n\nexport function dpi_cm2dots(cm, dpi) {\n    if(dpi===undefined || !dpi) dpi = 300;\n    return cm * (dpi / 2.54);\n}\n\nexport function dpi_dots2inch(dots, dpi) {\n    if(dpi===undefined || !dpi) dpi = 300;\n    return dots / dpi;\n}\n\nexport function dpi_inch2dots(inch, dpi) {\n    if(dpi===undefined || !dpi) dpi = 300;\n    return inch * dpi;\n}\n\nexport function Round(x, dec) {\n    if(x===undefined) x=0;\n    x =  String(x).replace(/,/g,'.');\n    x = parseFloat(x);\n    if(isNaN(x)) x = 0;\n\n    if(dec===undefined) {\n        return x.toFixed(2);\n    } else {\n        return x.toFixed( parseInt(dec) );\n    }\n}\n\nexport function deepCompare () {\n    var i, l, leftChain, rightChain;\n\n    function compare2Objects (x, y) {\n        var p;\n\n        // remember that NaN === NaN returns false\n        // and isNaN(undefined) returns true\n        if (isNaN(x) && isNaN(y) && typeof x === 'number' && typeof y === 'number') {\n            return true;\n        }\n\n        // Compare primitives and functions.\n        // Check if both arguments link to the same object.\n        // Especially useful on the step where we compare prototypes\n        if (x === y) {\n            return true;\n        }\n\n        // Works in case when functions are created in constructor.\n        // Comparing dates is a common scenario. Another built-ins?\n        // We can even handle functions passed across iframes\n        if ((typeof x === 'function' && typeof y === 'function') ||\n            (x instanceof Date && y instanceof Date) ||\n            (x instanceof RegExp && y instanceof RegExp) ||\n            (x instanceof String && y instanceof String) ||\n            (x instanceof Number && y instanceof Number)) {\n            return x.toString() === y.toString();\n        }\n\n        // At last checking prototypes as good as we can\n        if (!(x instanceof Object && y instanceof Object)) {\n            return false;\n        }\n\n        if (x.isPrototypeOf(y) || y.isPrototypeOf(x)) {\n            return false;\n        }\n\n        if (x.constructor !== y.constructor) {\n            return false;\n        }\n\n        if (x.prototype !== y.prototype) {\n            return false;\n        }\n\n        // Check for infinitive linking loops\n        if (leftChain.indexOf(x) > -1 || rightChain.indexOf(y) > -1) {\n            return false;\n        }\n\n        // Quick checking of one object being a subset of another.\n        for (p in y) {\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) {\n                return false;\n            }\n            else if (typeof y[p] !== typeof x[p]) {\n                return false;\n            }\n        }\n\n        for (p in x) {\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) {\n                return false;\n            }\n            else if (typeof y[p] !== typeof x[p]) {\n                return false;\n            }\n\n            switch (typeof (x[p])) {\n                case 'object':\n                case 'function':\n\n                    leftChain.push(x);\n                    rightChain.push(y);\n\n                    if (!compare2Objects (x[p], y[p])) {\n                        return false;\n                    }\n\n                    leftChain.pop();\n                    rightChain.pop();\n                    break;\n\n                default:\n                    if (x[p] !== y[p]) {\n                        return false;\n                    }\n                    break;\n            }\n        }\n\n        return true;\n    }\n\n    if (arguments.length < 1) {\n        return true; //Die silently? Don't know how to handle such case, please help...\n        // throw \"Need two or more arguments to compare\";\n    }\n\n    for (i = 1, l = arguments.length; i < l; i++) {\n\n        leftChain = [];\n        rightChain = [];\n\n        if (!compare2Objects(arguments[0], arguments[i])) {\n            return false;\n        }\n    }\n\n    return true;\n}","\nexport function setLang(newLang) {\n    if(i18n[newLang]) window.LANG = newLang;\n}\n\nexport function getLangs() {\n    let langs = [];\n    for(let prop in i18n) {\n        langs.push({key:prop, caption:i18n[prop].langCaption});\n    }\n    return langs;\n}\n\nexport default function t(str) {\n    let LANG = 'ua';\n    if(window.LANG) LANG = window.LANG;\n    return (i18n[LANG][str]===undefined && i18n[LANG][str]!=='') ? str : i18n[LANG][str];\n}\n\nconst i18n = {\n    'en' : {\n        'langCaption' : 'English',\n    },\n    'ua' : {\n        'langCaption' : 'Українська',\n\n        'Wait a moment while app loading': 'Зачекайте трішки, програма завантажується',\n        'Cancel': 'Відміна',\n        'Warning': 'Увага',\n        'Next': 'Далі',\n        'Previous': 'Назад',\n        'Print': 'Друк',\n        'Save': 'Зберегти',\n        'Loaded already': 'Отримано файлів',\n        'Name':'Назва',\n        'Height':'Висота',\n        'Width':'Ширина',\n        'Surface':'Поверхня',\n        'glance':'глянець',\n        'matte':'матовий',\n\n        'Files': 'Файли',\n        'Selected': 'Вибрано',\n        'Cost': 'Вартість',\n\n        'Are you sure?': 'Ви упевнені?',\n        'error': 'помилка ',\n        'error status, let see log': 'статус помилки виведено в консоль',\n\n        'Select CD, flash card or other source, then select format what you want, and press button':\n            'Виберіть CD чи флешку чи інший носій із Вашими знімками. Потім виберіть бажаний формат. Для продовження натисніть',\n\n        'Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture' :\n            'Виберіть папку, та відмічайте потрібні фото. Щоб збільшити фото, натисніть на його назву',\n\n        'To continue you should select at least one image': 'Щоб продовжити потрібно вибрати хоча б одне зображення ',\n        'Select all': 'Вибрати всі',\n        'Select none': 'Не вибирати нічого',\n        'No images': 'Зображень не знайдено',\n\n        'Current state of editor images will be lost.': 'Зроблені правки будуть втрачені при поверненні.',\n\n\n        'Format': 'Формат',\n        'Amount': 'К-сть',\n        'Total': 'Всього',\n        'Successful printed': 'Успішно надруковано',\n        'The number of your order is': 'Номер вашого замовлення',\n        'Dont forget to remove your source.' : 'Не забудьте забрати Ваш носій.',\n        'Thank you!': 'Дякуємо!',\n\n    }\n};","import React from 'react';\nimport * as tools from \"../../tools\";\nimport t from \"../i18n\";\nimport {getLangs} from \"../i18n\";\nimport {setLang} from \"../i18n\";\nimport './index.css';\nimport Icon from '@material-ui/core/Icon';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Paper from \"@material-ui/core/Paper\";\nimport axios from \"axios\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\n\nexport default class PageStart extends React.Component {\n    constructor(props) {\n        super(props);\n        this.checkSourceTimer = null;\n        this.checkSourceTimerMax = 7200; // about 10 hours\n        this.checkSourceTimerCount = this.checkSourceTimerMax;\n\n        this.state = {\n            isLangsOpen: false,\n        }\n    }\n\n\n    componentWillUnmount() {\n        if(this.checkSourceTimer) clearTimeout(this.checkSourceTimer);\n    }\n\n    componentDidMount() {\n        let sources = this.props.app.sources.slice();\n        let len = sources.length;\n\n        for(let i=0; i<len; i++)\n            sources[i].hasFiles = false;\n        this.props.appSetState({sources : sources}, ()=>{\n            this.checkSources(true);\n        });\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if(prevProps.app.isUploadEnable !== this.props.app.isUploadEnable && this.props.app.isUploadEnable){\n            if(this.inputUpload) this.inputUpload.click();\n        }\n    }\n\n    checkSources(initRefresh) {\n        if(!this.props.app.sources) return;\n\n        let sources = this.props.app.sources.slice();\n        let len = sources.length;\n\n        if(initRefresh) {\n            this.checkSourceTimerCount = 0;\n        }\n\n        for(let i=0; i<len; i++) {\n            if(sources[i].enabled && sources[i].emptyhide) {\n                let uri = tools.makeGetUri({'q':'checkEmptySource', 'id': i});\n                axios.get(uri).then(res => {\n                    if(res.status===200) {\n                        if(res.data.error==='') {\n                            sources[i].hasFiles = res.data.data;\n                            this.props.appSetState({sources : sources});\n                        }\n                    }\n\n                });\n            }\n        }\n        if(this.checkSourceTimerCount<this.checkSourceTimerMax)\n            this.checkSourceTimer = setTimeout( this.checkSources.bind(this), 9000 );\n\n        this.checkSourceTimerCount++;\n    }\n\n\n    clientUploadProgress = (progress) => {\n        let percentage = Math.floor((progress.loaded * 100) / progress.total);\n        // console.log(myFileId)\n        this.props.appSetState({ progressBarValue: percentage });\n\n        // console.log(percentage);\n    };\n\n    clientUpload = (event)=>{\n        let formData = new FormData();\n        let uploadfiles = event.target.files;\n\n        if(uploadfiles.length===0) return;\n\n        this.props.appSetState({isPleaseWait:true});\n        let config = {\n            onUploadProgress: (Ev)=>this.clientUploadProgress(Ev),\n            headers: { 'Content-Type': 'multipart/form-data' },\n        };\n\n        // formData.append(\"q\", 'src-upload');\n        for (let i=0; i<uploadfiles.length; i++) {\n            formData.append(\"images[]\", uploadfiles[i]);\n        }\n\n        axios.post( tools.makeGetUri({'q':'src-upload', 'p':this.props.app.isSetupPassword}), formData, config )\n            .then(()=>{\n                this.checkSources();\n            })\n            .catch((error)=>{\n                console.log(error);\n            })\n            .finally(()=>{\n                if(event.target) event.target.files = null;\n                this.props.appSetState({isPleaseWait:false, progressBarValue:-1});\n            });\n    };\n\n    openLangsPanel=(key)=>{\n        if(key) {\n            setLang(key);\n        }\n        this.setState({isLangsOpen:!this.state.isLangsOpen});\n    };\n\n\n\n    render() {\n        let sources = (this.props.app.sources ? this.props.app.sources : []);\n        let langs = getLangs();\n        let langsList = this.state.isLangsOpen ? (\n            <ClickAwayListener onClickAway={()=>{this.openLangsPanel()}}>\n                <Paper className=\"app-main-change-langs scrollbar position-absolute\">\n                    <table className=\"table-langs\">\n                        {langs.map( (lang, index)=>\n                            <tbody key={index} onClick={()=>this.openLangsPanel(lang.key)}>\n                            <tr>\n                                <th scope=\"row\" className=\"text-left\"><Icon>language</Icon> {lang.caption}</th>\n                            </tr>\n                            </tbody>\n\n                            )}\n                    </table>\n                </Paper>\n            </ClickAwayListener>\n        ) : null;\n\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\n                <div className=\"app-main h-85\">\n                    <div className=\"app-main-selectors w-85 h-100 d-inline-block\">\n                        <div  className=\"app-main-selectors-source text-center w-50 h-100 p-2 d-inline-block\">\n                            <Paper className=\"scrollbar p-2 h-100 app-bg-e  position-relative\">\n                                {sources.map( (source, index)=>\n                                    <Card key={index}\n                                          className={'app-source-item d-inline-block m-2'+(this.props.app.currentSource===index ? ' text-white bg-primary' : '')+(source.enabled ? '' : ' app-source-disabled')+((source.emptyhide && !source.hasFiles) ? ' app-source-emptyhide' : '')}\n                                          onClick={() => this.props.onClickSource(index)}\n                                    >\n                                        <CardContent>\n                                            <div className=\"card-img\">\n                                                <img src={tools.makeGetUri()+source.icon} alt={source.name} className=\"app-source-icon\"/>\n                                            </div>\n                                            {source.enabled && source.name}\n\n                                        </CardContent>\n                                    </Card>\n                                )}\n\n                            </Paper>\n                        </div>\n                        <div className=\"app-main-selectors-format w-50 h-100 p-2 d-inline-block position-relative\">\n                            <Paper className=\"scrollbar p-2 h-100 app-bg-e  position-relative\">\n                                {this.props.app.formats.map( (format, index)=>format.enabled ?\n                                    <Card key={index}\n                                          className={'app-format-item m-2'+(this.props.app.currentFormat===index ? ' text-white bg-primary' : '')}\n                                          onClick={() => this.props.onClickFormat(index)}\n                                    >\n                                        <CardContent>\n                                            <div className=\"app-main-selectors-format-wrp\">\n                                                <div className=\"_w30\">{format.name}</div>\n                                                <div className=\"_w20\">\n                                                    {format.height}\"x {format.width}\"\n                                                </div>\n                                                <div className=\"_w20\">\n                                                    {Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}\n                                                </div>\n                                                <div className=\"_w15\">{t(format.surface)}</div>\n                                                <div className=\"_w15 text-right\">{tools.Round(format.cost)}</div>\n                                            </div>\n\n                                        </CardContent>\n                                    </Card>\n                                :\n                                    ''\n                                )}\n                            </Paper>\n                        </div>\n\n                    </div>\n\n                    <div className=\"app-main-rightwidget w-15 h-100 p-2 d-inline-block\">\n                        <Paper className=\"h-100 p-2 app-bg-e position-relative\">\n                            <div className=\"_fabwrapper\">\n                                <button\n                                    className={\"btn btn-big btn-primary\"}\n                                    disabled={this.props.app.currentSource===null || this.props.app.currentFormat===null}\n                                    onClick={() => this.props.onClickNextBtn()}\n                                    type=\"button\">\n                                    <Icon>arrow_forward</Icon> {t('Next')}\n                                </button>\n                            </div>\n\n                            <div className=\"_fabwrapper\">\n                                <button\n                                    className=\"btn btn-big btn-success mt-4\"\n                                    disabled={this.checkSourceTimerCount<this.checkSourceTimerMax}\n                                    onClick={() => this.checkSources(true)}\n                                    type=\"button\">\n                                    <Icon>refresh</Icon> {t('Refresh')}\n                                </button>\n                            </div>\n\n\n                            <div className=\"bottom-absolute w-100\">\n\n                                <div className=\"_fabwrapper\">\n                                    <div className=\"app-main-change-langs-wrapper position-relative\">\n                                        {langsList}\n                                        <button className=\"btn btn-big btn-light text-success\"\n                                                style={{minWidth:'10vh', width:'auto'}}\n                                                onClick={this.openLangsPanel}\n                                                disabled={false}\n                                                title={t('Language')}\n                                                type=\"button\" >\n                                            <Icon>language</Icon>\n                                            <div>\n                                                {t('langCaption')}\n                                            </div>\n                                        </button>\n\n                                    </div>\n                                </div>\n\n\n                                <div className=\"_fabwrapper\">\n                                    <button type=\"button\"\n                                            className={\"btn btn-big btn-success\"}\n                                            disabled={false}\n                                            onClick={()=>{this.props.appSetState({isSetup:1})}}>\n                                        <Icon>build</Icon>\n                                        <div>\n                                            {this.props.app.version}\n                                        </div>\n                                    </button>\n                                </div>\n\n                            </div>\n\n\n                        </Paper>\n                    </div>\n\n                </div>\n\n                <div className=\"app-bottomframe p-2 h-15 w-100\">\n                    <Paper className=\"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp position-relative\">\n\n                        {this.props.app.isUploadEnable && (\n                            <label htmlFor=\"file-input\">\n                                <input id=\"file-input\" ref={input=>this.inputUpload=input} type=\"file\" multiple onChange={(e)=>this.clientUpload(e)} />\n                                <Icon className=\"_icon text-white text-success\">info</Icon>\n                            </label>\n\n                        )}\n                        {!this.props.app.isUploadEnable && (\n                            <Icon onClick={()=>{this.props.appSetState({isSetup:2})}} className=\"_icon text-white\">info</Icon>\n                        )}\n\n                        <div className=\"_msg\">\n                            {t('Select CD, flash card or other source, then select format what you want, and press button')} '{t('Next')}'\n                        </div>\n\n                        {(this.props.app.progressBarValue>=0 && (\n                            <div className=\"app-bottom-progress h-100 p-2 w-100\">\n                                <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\n                            </div>\n                        ))}\n\n                    </Paper>\n                </div>\n\n            </div>\n\n\n        );\n    }\n}\n\n","import React, {PureComponent} from 'react';\nimport * as tools from \"../../tools\";\nimport axios from \"axios\";\nimport t from \"../i18n\";\n\nimport './index.css';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Icon from \"@material-ui/core/Icon\";\nimport Fab from '@material-ui/core/Fab';\nimport Paper from '@material-ui/core/Paper';\nimport LinearProgress from '@material-ui/core/LinearProgress';\n// import ImageThumb from \"../PageEditor/ImageThumb\";\n\nconst resetState = {\n    folders: [],\n    tree: [],\n    currentFolder: null,\n    is_loadind_images: true,\n    expandedImage: null,\n    images: [],\n    progressAjax: {},\n    previewMaxResize: null,\n    isAutoclearLoading: false,\n    isAutoclearLoaded: 0,\n};\n\nexport default class PageLoadImages extends React.Component {\n    constructor(props) {\n        super(props);\n        this.imagesContainer = null;\n        this.isAutoclearTimer = null;\n\n        this.state = resetState;\n    }\n\n\n    componentDidMount() {\n        // if(this.props.app.pages['loadImages']) {\n        //     this.setState( this.props.app.pages['loadImages'] );\n        // } else {\n        //     this.onClickDir(null);\n        // }\n        if(this.props.app.sources[this.props.app.currentSource].autoclear) {\n            this.setState({isAutoclearLoading:true}, ()=>{this.onClickDir(null);});\n        } else {\n            this.onClickDir(null);\n        }\n\n\n    }\n\n\n    scrollImages(direction) {\n        // console.log(this.imagesContainer);\n\n        if(this.imagesContainer) {\n            console.log('scrollTop', this.imagesContainer.scrollTop);\n            console.log('scrollHeight', this.imagesContainer.scrollHeight);\n            let rowH = this.imagesContainer.scrollHeight/Math.ceil((this.state.images.length/3) );\n            console.log('rowCount', rowH);\n            this.imagesContainer.scrollTop += rowH*direction;\n        }\n    }\n\n    onClickDir(index) {\n        let currentDir = (index && this.state.folders ? this.state.folders[index].dir : '' );\n        let uri = '';\n\n        if(this.state.isAutoclearLoading) {\n\n            uri = tools.makeGetUri({'q':'source', 'id': this.props.app.currentSource, dir: currentDir});\n            axios.get(uri).then(res => {\n                if(res.status===200) {\n                    if(res.data.error==='') {\n                        this.setState({ isAutoclearLoaded: res.data.data.length } );\n                    }\n                }\n            });\n\n            this.isAutoclearTimer = setTimeout( ()=>{this.onClickDir()}, 3000);\n\n        } else { // ------------------------------------------- full load folders and images\n\n            if(this.isAutoclearTimer) clearTimeout(this.isAutoclearTimer);\n\n            let _d = '';\n            let folders = [{\n                'list': this.props.app.currentSource,\n                'source': this.props.app.sources[this.props.app.currentSource],\n                'name': this.props.app.sources[this.props.app.currentSource].name,\n                'dir': _d,\n                'level': 0,\n            }];\n            this.setState({folders: folders, currentFolder: null });\n\n            uri = tools.makeGetUri({'q':'folders', 'id': this.props.app.currentSource, dir: currentDir });\n            axios.get(uri).then(res => {\n                if(res.status===200) {\n                    if(res.data.error==='') {\n                        var _L = 1;\n                        for (let i=0; i<res.data.tree.length; i++) {\n                            _d += (_d!=='' ? '/' : '')+res.data.tree[i];\n                            let _f = {\n                                'list': this.props.app.currentSource,\n                                'name': res.data.tree[i],\n                                'dir': _d,\n                                'level': _L,\n                            };\n                            if(_L<5) _L++;\n                            folders.push(_f);\n                        }\n\n                        for (let _f of res.data.data) {\n                            _f.level = _L;\n                            folders.push(_f);\n                        }\n                        this.setState({\n                            folders: folders,\n                            currentFolder: res.data.tree.length,\n                        });\n\n                        this.setState({images: [], is_loadind_images: true });\n\n                        let progress = 3;\n                        this.props.appSetState({ progressBarValue:progress });\n                        let uri = tools.makeGetUri({'q':'source', 'precache':true, 'id': this.props.app.currentSource, dir: currentDir});\n                        axios.get(uri, {\n                            onDownloadProgress: (progressEvent) => {\n                                let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n                                progress = progressEvent.lengthComputable ? percentCompleted : progress;\n                                // console.log(progress);\n                                this.props.appSetState({ progressBarValue: progress })\n                            }\n                        })\n                            .then((/*response*/) => {\n                                this.props.appSetState({ progressBarValue:-1 });\n\n                                uri = tools.makeGetUri({'q':'source', 'id': this.props.app.currentSource, dir: currentDir});\n                                axios.get(uri).then(res => {\n                                    if(res.status===200) {\n                                        if(res.data.error==='') {\n                                            this.setState({ images: res.data.data }, ()=>{this.imagesScroll()} );\n                                        }\n                                    }\n                                    this.setState({is_loadind_images: false});\n                                });\n\n\n                            }).catch(error => {\n                            if (error.response) {\n                                console.log(error.responderEnd);\n                                this.props.onMessage('testProgress error: '+error.responderEnd);\n                                progress = -1;\n                                this.props.appSetState({ progressBarValue:-1 })\n                            }\n                        });\n\n                    }\n                }\n            });\n\n        }\n\n\n    }\n\n\n    showExpandImg(index) {\n        this.setState({expandedImage: null} , ()=>{\n            this.setState({expandedImage: index}, ()=>{this.reopenThumb(index)})\n        })\n    }\n    reopenThumb(index) {\n        //image.name\n        let newIm = this.state.images.slice();\n        let reopen = newIm[index].name;\n        newIm[index].name = '';\n        this.setState({images: newIm}, ()=>{\n            newIm[index].name = reopen;\n            this.setState({images: newIm});\n        });\n\n    }\n\n    hideExpandImg() {\n        this.setState({expandedImage: null})\n    }\n    MarkImage(index){\n        let newIm = this.state.images.slice();\n        newIm[index].marked = !newIm[index].marked;\n        this.setState({images: newIm});\n    }\n\n    markAllImages(mode) {\n        let newIm = this.state.images;\n        for(let i=0; i<newIm.length; i++) {\n            newIm[i].marked = mode;\n        }\n        this.setState({images: newIm});\n    }\n\n\n    setpreviewMaxResize(value) {\n        this.setState({previewMaxResize:value});\n    }\n\n    nextPage = ()=> {\n\n        // args - this.state.images\n        const selectedimages = this.state.images.filter(function(x){return x.marked});\n        if(selectedimages.length===0) {\n            this.props.onMessage(t('To continue you should select at least one image'));\n            return;\n        }\n        const dirs = selectedimages.map( (image)=> { return image.dir;} );\n        const files = selectedimages.map( (image)=> { return image.name;} );\n\n        let uri = tools.makeGetUri();\n        const params = new URLSearchParams();\n        params.append('q', 'movetowork');\n        params.append('id', this.props.app.currentSource);\n        params.append('maxWidth', (this.state.previewMaxResize ? this.state.previewMaxResize : 300));\n\n        for(let _d of dirs ) params.append('dirs[]', _d);\n        for(let _f of files ) params.append('files[]', _f);\n\n\n            let progress = 3;\n            this.props.appSetState({ progressBarValue: progress, isPleaseWait:true });\n            axios.post(uri, params, {\n                onDownloadProgress: (progressEvent) => {\n                    let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\n                    progress = progressEvent.lengthComputable ? percentCompleted : progress;\n                    // console.log(progress);\n                    this.props.appSetState({ progressBarValue: progress })\n                }\n            })\n                .then((/*response*/) => {\n                    progress = -1;\n                    this.props.appSetState({ progressBarValue:-1 });\n\n                    let uri = tools.makeGetUri({'q':'workpath'});\n                    axios.get(uri).then(res => {\n                        if(res.status===200) {\n                            if(res.data.error==='') {\n                                let dpi =  this.props.app.formats[this.props.app.currentFormat].dpi ? this.props.app.formats[this.props.app.currentFormat].dpi : 300;\n                                const images = selectedimages.map( (image)=> {\n                                    let thumbname = res.data.data.thumbs+image.dir+ image.name.substr(0, image.name.lastIndexOf(\".\")) +\".jpg\";\n                                    return {\n                                        name: image.name,\n                                        extension: image.extension,\n                                        width: tools.dpi_dots2inch(image.width, dpi),\n                                        height: tools.dpi_dots2inch(image.height, dpi),\n                                        width_pixel: image.width,\n                                        height_pixel: image.height,\n                                        orientation : image.orientation,\n                                        thumb: thumbname.replace('?', '%3F'),\n                                        src: res.data.data.works+image.name,\n                                        format: this.props.app.formats[this.props.app.currentFormat],\n                                        count: 1,\n                                        editorState: {\n\n                                            maskTB: 0,\n                                            maskLR: 0,\n                                            imageZoom: 1.0,\n                                            imageZoomMax: 1.9,\n                                            imageZoomMin: 0.1,\n                                            imageRotate: 0,\n                                            colorR: 1.0,\n                                            colorG: 1.0,\n                                            colorB: 1.0,\n                                            brightness: 1,\n                                            contrast: 1,\n                                            saturate: 1,\n                                            sepia: false,\n\n                                            sliderPositionTB: 0,\n                                            sliderPositionLR: 0,\n\n                                            initedImagePosition: false,\n                                            initedMask: false,\n                                            ratio: 1.0,\n                                            imgWidth: image.width,\n                                            imgHeight: image.height,\n                                            currentTab: 0,\n\n                                        },\n\n\n                                };\n                                } );\n                                this.props.onClickNextBtn(images);\n\n                            }\n                        }\n                    });\n\n                    //console.log(images);\n                    // this.setState({appstate: 'editor', images: images});\n                }).catch(error => {\n                    if (error.response) {\n                        console.log('movetowork error', error.responderEnd);\n                        this.props.onMessage('movetowork error: '+error.responderEnd);\n                        progress = -1;\n                        this.props.appSetState({ progressBarValue:-1, isPleaseWait:false })\n                    }\n                });\n\n    };\n\n    imagesScroll() {\n        // console.log(this.imagesContainer.children);\n        let images = this.state.images.slice();\n        let changed = false;\n        if(this.imagesContainer && this.imagesContainer.children) {\n            let viewHeight = this.imagesContainer.clientHeight;\n            let len = this.imagesContainer.children.length;\n            for(let i=0; i<len; i++) {\n                if(images[i] && !images[i].is_appeared) {\n                    let rect = this.imagesContainer.children[i].getBoundingClientRect();\n                    let is_visible = !(rect.bottom < 0 || rect.top - viewHeight >= 0);\n                    if(is_visible) {\n                        images[i].is_appeared = true;\n                        changed = true;\n                    }\n                }\n            }\n        }\n        if(changed) {\n            this.setState({images:images});\n        }\n    }\n\n\n\n    render() {\n\n        const selectedimages = this.state.images.filter(function(x){return x.marked});\n        const cost = this.props.app.formats[this.props.app.currentFormat].cost;\n\n        return (\n\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\n                <div className=\"app-main h-90\">\n                    <div className=\"d-inline-block w-85 h-100\">\n                        <div className=\"app-main-selectors w-100 h-100 d-flex flex-row\">\n                            <div  className=\"app-main-selectors-folder h-100 p-2 flex-grow-1 flex-shrink-1\">\n                                <Paper className=\"scrollbar p-2 h-100 app-bg-e\">\n                                    {this.state.folders.map( (dir, index)=>\n                                        <Card key={index}\n                                              className={'m-1 app-dir-item level'+dir.level+' '+(this.state.currentFolder===index ? ' text-white bg-primary' : '')}\n                                              onClick={() => this.onClickDir(index) }\n                                        >\n                                            <CardContent>\n                                                {dir.source && (\n                                                    <img src={tools.makeGetUri()+dir.source.icon} alt={dir.source.name} className=\"app-dir-item-icon\"/>\n                                                )}\n                                                {dir.name}\n                                                {index===0 &&\n                                                <Icon className=\"float-right\" >refresh</Icon>\n                                                }\n                                            </CardContent>\n                                        </Card>\n                                    )}\n                                </Paper>\n                            </div>\n                            <div className=\"app-main-selectors-image h-100 p-2 flew-grow-0 flex-shrink-0\">\n                                <Paper className=\"h-100 position-relative app-bg-e\">\n                                    <div  ref={(node)=>{this.imagesContainer=node}}\n                                          onScroll={()=>this.imagesScroll()}\n                                          className=\"p-2 h-100 scrollbar\">\n                                            {this.state.images.map( (image, index)=>\n                                                <ImagePreview\n                                                    key={image.name}\n                                                    image={image}\n                                                    itemIndex={index}\n                                                    imagesContainer = {this.imagesContainer}\n                                                    onExpand={()=>this.showExpandImg(index)}\n                                                    onMark={()=>this.MarkImage(index)}\n                                                    setpreviewMaxResize={()=>this.setpreviewMaxResize.bind(this)}\n                                                    {...this.props}\n                                                />\n                                            )}\n\n                                    </div>\n\n                                    {(!this.state.is_loadind_images && this.state.images.length===0) && (\n                                        <div className='app-source-noimages h-100 text-primary' >\n                                            {t('No images')}\n                                        </div>\n                                    )}\n\n                                    {(this.state.is_loadind_images && !this.state.isAutoclearLoading) && (\n                                        <div className = \"list-images-loader spinner-border text-primary\" role = \"status\" >\n                                            <span className = \"sr-only\" > Loading...</span>\n                                        </div>\n\n                                    )}\n\n                                </Paper>\n                            </div>\n\n                        </div>\n\n                    </div>\n                    <div className=\"app-main-rightwidget w-15 h-100 p-2 d-inline-block\">\n                        <Paper className=\"h-100 p-2 app-bg-e position-relative\">\n                            <div className=\"_fabwrapper\">\n                                <button className={\"btn btn-big btn-primary\"}\n                                        onClick={() => this.nextPage()}\n                                        disabled={false}\n                                        title={t(\"Next\")}\n                                        type=\"button\" >\n                                    <Icon>arrow_forward</Icon> {t('Next')}\n                                </button>\n                            </div>\n\n                            <div className=\"_fabwrapper\">\n                                <button className={\"btn btn-big btn-primary\"}\n                                        onClick={() => {this.props.onClickPrevBtn()}}\n                                        disabled={false}\n                                        title={t(\"Previous\")}\n                                        type=\"button\" >\n                                    <Icon>arrow_back</Icon> {t(\"Previous\")}\n                                </button>\n                            </div>\n\n\n                            <div className=\"_fabwrapper mt-4\">\n                                <button className={\"btn btn-success\"}\n                                        onClick={()=>this.scrollImages(-1)}\n                                        disabled={false}\n                                        title={t(\"up\")}\n                                        type=\"button\" >\n                                    <Icon>expand_less</Icon>\n                                </button>\n                            </div>\n\n                            <div className=\"_fabwrapper\">\n                                <button className={\"btn btn-success mr-2\"}\n                                        onClick={() => this.markAllImages(true)}\n                                        disabled={false}\n                                        title={t(\"Select all\")}\n                                        type=\"button\" >\n                                    <Icon>filter</Icon>\n                                </button>\n\n                                <button className={\"btn btn-success\"}\n                                        onClick={() => this.markAllImages(false)}\n                                        disabled={false}\n                                        title={t(\"Select none\")}\n                                        type=\"button\" >\n                                    <Icon>filter_none</Icon>\n                                </button>\n                            </div>\n\n                            <div className=\"_fabwrapper\">\n                                <button className={\"btn btn-success\"}\n                                        onClick={()=>this.scrollImages(1)}\n                                        disabled={false}\n                                        title={t(\"down\")}\n                                        type=\"button\" >\n                                    <Icon>expand_more</Icon>\n                                </button>\n                            </div>\n\n\n                            <div className=\"app-main-rightwidget-tablewrp\">\n                                <table className=\"table\">\n                                    <tbody>\n                                    <tr>\n                                        <th scope=\"row\">{t('Files')}</th>\n                                        <th scope=\"row\">{this.state.images.length}</th>\n                                    </tr>\n                                    <tr>\n                                        <th scope=\"row\">{t('Selected')}</th>\n                                        <th scope=\"row\">{selectedimages.length}</th>\n                                    </tr>\n                                    <tr>\n                                        <th scope=\"row\">{t('Cost')}</th>\n                                        <th scope=\"row\">{tools.Round(selectedimages.length*cost)}</th>\n                                    </tr>\n                                    </tbody>\n                                </table>\n\n                            </div>\n\n                        </Paper>\n\n                    </div>\n\n                </div>\n\n                <div className=\"app-bottomframe w-100 h-10 p-2 position-relative\">\n                    <Paper className=\"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp\">\n                        <Icon className=\"_icon text-white\">info</Icon>\n                        <div className=\"_msg\">\n                            {t('Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture')}\n                        </div>\n                    </Paper>\n\n                    {(this.props.app.progressBarValue>=0 && (\n                    <div className=\"app-bottom-progress h-100 p-2 w-100\">\n                        <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\n                    </div>\n                    ))}\n                </div>\n\n                {this.state.isAutoclearLoading && (\n                    <div className=\"app-please-wait-wrp position-fixed\">\n\n                        <Paper className=\"app-page-loadimages-wait p-3\">\n                            <div className=\"app-source-icon-wrp\">\n                                <img src={tools.makeGetUri()+this.props.app.sources[this.props.app.currentSource].icon} alt={this.props.app.sources[this.props.app.currentSource].name} className=\"app-source-icon\"/>\n                            </div>\n                            {this.props.app.sources[this.props.app.currentSource].name}\n                            <div className=\"_loaded p-3\">\n                                {t('Loaded already')}: {this.state.isAutoclearLoaded}\n                            </div>\n\n                            <div className=\"_fabwrapper\">\n                                <button className={\"btn btn-big btn-success\"}\n                                        onClick={()=>{this.setState({isAutoclearLoading:false}, ()=>{this.onClickDir()}) }}\n                                        disabled={false}\n                                        title={t(\"OK\")}\n                                        type=\"button\" >\n                                    {t('Next')}\n                                </button>\n                            </div>\n\n                        </Paper>\n\n                    </div>\n                )}\n\n\n                <ModalExpand\n                    image={this.state.expandedImage!==null ? this.state.images[this.state.expandedImage] : null}\n                    itemCurrent={this.state.expandedImage}\n                    itemPrev={this.state.expandedImage>0 ? this.state.expandedImage-1: null}\n                    itemNext={this.state.expandedImage<(this.state.images.length-2) ? this.state.expandedImage+1 : null}\n                    onExpand={this.showExpandImg.bind(this)}\n                    onMark={this.MarkImage.bind(this)}\n                    onClose={this.hideExpandImg.bind(this)}\n                />\n            </div>\n        );\n    }\n}\n\nclass ImagePreview extends PureComponent {\n\n    render() {\n        const image = this.props.image;\n        // this.props.image.orientation\n        // 1 - no rotate\n        // 3 - 180deg\n        // 6 - 270deg\n        // 8 - 90deg\n        var rotate = \"\";\n        switch (this.props.image.orientation) {\n            case 3:\n                rotate = \" rotate180\";\n                break;\n            case 6:\n                rotate = \" rotate90\";\n                break;\n            case 8:\n                rotate = \" rotate270\";\n                break;\n            default:\n                break;\n        }\n\n        let previewMaxResize = 300;\n        if(this.props.previewMaxResize) {\n            previewMaxResize = this.props.previewMaxResize;\n        } else {\n            if(this.imgWrapper) {\n                previewMaxResize = this.imgWrapper.clientWidth;\n                this.props.setpreviewMaxResize(previewMaxResize);\n            }\n        }\n\n        let imgStyle = {backgroundImage: 'url('+tools.makeGetUri({'q':'img', 'id':image.list, dir:image.dir, 'src':image.name, 'max':previewMaxResize})+')'};\n\n        return (\n            <Card className='app-source-image-item d-inline-block m-1 position-relative' >\n                <CardContent className={\"p-0\"}\n                     onClick={()=>this.props.onMark()}\n                     onDoubleClick={()=>this.props.onExpand(this.props.itemIndex)}\n                >\n                    <div ref={(node)=>{this.imgWrapper=node}}\n                        className={\"app-source-image-item-img-wrapper p-1 \"+(image.marked ? ' text-white bg-primary': '')}>\n                        {image.is_appeared &&\n                        <div className={\"app-source-image-item-img border \"+rotate} style={imgStyle} />\n                        }\n                        {!image.is_appeared &&\n                        <div className=\"app-source-image-item-img border \" >\n                        </div>\n                        }\n\n                        <div className='app-source-image-item-toggle position-absolute'>\n                            <Fab className=\"bg-primary text-light\"\n                                onClick={(e)=> {e.stopPropagation(); this.props.onMark()}}\n                                aria-label=\"Check\" >\n                                <Icon>check</Icon>\n                            </Fab>\n                        </div>\n                        <div className='app-source-image-item-fullscreen position-absolute'>\n                            <Fab className=\"bg-success text-light\"\n                                onClick={()=>this.props.onExpand(this.props.itemIndex)}\n                                aria-label=\"Fullscreen\" >\n                                <Icon>zoom_in</Icon>\n                            </Fab>\n                        </div>\n\n\n                        <div className=\"app-selectimages-item-text text-center m-1\">\n                            {image.name}\n                        </div>\n\n                    </div>\n                </CardContent>\n            </Card>\n        )\n    }\n}\n\nclass ModalExpand extends PureComponent {\n\n    render() {\n        const image = this.props.image;\n\n        if (image===null) return null;\n\n        var rotate = \"\";\n        switch (image.orientation) {\n            case 3:\n                rotate = \" rotate180\";\n                break;\n            case 6:\n                rotate = \" rotate90\";\n                break;\n            case 8:\n                rotate = \" rotate270\";\n                break;\n            default:\n                break;\n        }\n\n        let imgsrc = tools.makeGetUri({'q':'img', 'id':image.list, dir:image.dir, 'src':image.name, 'max':-1});\n\n        return (\n            <div className=\"app-modal\" onClick={()=>this.props.onClose()}>\n                <div className=\"app-modal-main position-fixed\">\n                        <div className={\"rotate-wrp app-source-image-expanded rounded\"+rotate+(image.marked ? ' bg-primary': '')}>\n                            <img src={imgsrc} alt=\"zoomed\" onClick={(e)=> {e.stopPropagation(); this.props.onMark(this.props.itemCurrent)}} />\n                        </div>\n\n                </div>\n\n                <div\n                    onClick={(e)=>{if(this.props.itemPrev===null)return; e.stopPropagation(); this.props.onExpand(this.props.itemPrev)}}\n                    className='app-image-expanded-button _prev position-absolute'>\n                    <Fab disabled={this.props.itemPrev===null} aria-label=\"Previous\">\n                        <Icon>navigate_before</Icon>\n                    </Fab>\n                </div>\n\n                <div\n                    onClick={(e)=> {e.stopPropagation(); this.props.onMark(this.props.itemCurrent)}}\n                    className='app-image-expanded-button _check position-absolute'>\n                    <Fab\n                        aria-label=\"Check\" >\n                        <Icon className=\"text-success\">check</Icon>\n                    </Fab>\n                </div>\n\n                <div\n                    onClick={(e)=>{if(this.props.itemNext===null)return; e.stopPropagation(); this.props.onExpand(this.props.itemNext)}}\n                    className='app-image-expanded-button _next position-absolute'>\n                    <Fab disabled={this.props.itemNext===null}\n                         aria-label=\"Next\">\n                        <Icon>navigate_next</Icon>\n                    </Fab>\n                </div>\n\n                <div\n                    onClick={(e)=>{e.stopPropagation(); this.props.onClose()}}\n                    className='app-image-expanded-button _close position-absolute'>\n                    <Fab aria-label=\"Close\" >\n                        <Icon>close</Icon>\n                    </Fab>\n                </div>\n\n            </div>\n        );\n\n\n    }\n\n}\n","import React, {PureComponent} from \"react\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\n\nimport * as tools from \"../../tools\";\nimport Icon from \"@material-ui/core/Icon\";\nimport {THEME} from \"../../tools\";\n\n\nexport default class ImageThumb extends PureComponent {\n    constructor(props){   // Optional, declare a class field to improve readability\n        super(props);\n        this.nodeThumb = null;\n        this.scrollRef = null;\n\n        this.state = {\n            thumbWidth: '100px',\n        }\n    }\n\n    componentDidMount() {\n        if(this.nodeThumb) {\n            if(this.state.thumbWidth !== this.nodeThumb.clientHeight) {\n                this.setState({\n                    thumbWidth: this.nodeThumb.clientHeight, //this is not an error, need square\n                })\n            }\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if(this.scrollRef && this.props.selected) {\n            this.props.scrollIntoView(this.scrollRef);\n        }\n    }\n\n    render() {\n        const image = this.props.image;\n        // this.props.image.orientation\n        // 1 - no rotate\n        // 3 - 180deg\n        // 6 - 270deg\n        // 8 - 90deg\n        let rotate = \"\";\n        switch (image.orientation) {\n            case 3:\n                rotate = \" rotate180\";\n                break;\n            case 6:\n                rotate = \" rotate90\";\n                break;\n            case 8:\n                rotate = \" rotate270\";\n                break;\n            default:\n                break;\n        }\n        let boxStyles = {width: this.state.thumbWidth, height: this.state.thumbWidth}; //this is not an error, need square\n\n        let styles = {width: '100%', height: 'auto'};\n        if(image.height>image.width) {\n            styles = {width: 'auto', height: '100%'};\n        }\n\n\n        let _icon_enabled = 'inherit';\n        let _icon_disabled = 'disabled';\n        let clrZoom = _icon_disabled;\n        let clrFilters = _icon_disabled;\n        let clrColors = _icon_disabled;\n        if(image.editorState) {\n            if(image.editorState.initedImagePosition) clrZoom = _icon_enabled;\n            if(image.editorState.brightness!==1) clrFilters = _icon_enabled;\n            if(image.editorState.contrast!==1) clrFilters = _icon_enabled;\n            if(image.editorState.saturate!==1) clrFilters = _icon_enabled;\n            if(image.editorState.sepia) clrFilters = _icon_enabled;\n            if(image.editorState.colorR!==1) clrColors = _icon_enabled;\n            if(image.editorState.colorG!==1) clrColors = _icon_enabled;\n            if(image.editorState.colorB!==1) clrColors = _icon_enabled;\n        }\n\n\n        return (\n            <Card className={'app-editor-thumb-item h-100 d-inline-block m-1 position-relative '+(this.props.selected ? ' text-light bg-primary' : ' text-primary bg-light')} >\n                <CardContent  className={\"p-0 h-100 position-relative\"} onClick={this.props.onSelect} >\n                    <div ref={(node)=>this.scrollRef=node} className={\"app-editor-thumb-item-img-wrapper h-100 p-1\"}>\n                        <div ref={(node)=>this.nodeThumb=node} style={boxStyles} className={\"app-editor-thumb-item-box h-100 border \"+rotate} >\n                            <span className=\"app-editor-thumb-item-img-helper\"/>\n                            <img\n                                src={tools.makeGetUri()+encodeURI(image.thumb)}\n                                style={styles}\n                                alt=\"\" className={\"app-editor-thumb-item-image\"+(!image.count ? ' _zero' : '')}/>\n                        </div>\n                    </div>\n                    <div className={\"app-editor-thumb-item-img-countbubble\"}\n                        style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\n                        >\n                        <span>{image.count ? image.count : '-'}</span>\n                    </div>\n\n                    <div className={\"app-editor-thumb-item-img-controls h-100\"}>\n                        <div className=\"app-editor-thumb-item-img-controls-flexv pr-1 h-100\">\n\n                            <div>\n                                <Icon fontSize={'small'} color={clrZoom}>zoom_out_map</Icon>\n                            </div>\n                            <div>\n                                <Icon fontSize={'small'} color={clrFilters}>brightness_medium</Icon>\n                            </div>\n                            <div>\n                                <Icon fontSize={'small'} color={clrColors}>equalizer</Icon>\n                            </div>\n                            <div className={\"app-editor-thumb-item-img-index\"}>\n                                <span>{this.props.itemIndex+1}</span>\n                            </div>\n                        </div>\n\n\n                    </div>\n                    {!image.count && (\n                        <div className=\"app-editor-thumb-zeroprint\">x</div>\n                    )}\n                </CardContent>\n\n\n            </Card>\n        )\n    }\n}\n","import React from \"react\";\nimport * as tools from \"../../tools\";\nimport {calculateImageDimensions} from \"../../tools\";\n\nexport default class ImageEditorZoomCanvas extends React.Component {\n    constructor(props) {\n        super(props);\n        this.canvasImg = new Image();\n        this.canvasImg.crossOrigin = 'anonymous';\n        const _upd = this.updateCanvas.bind(this);\n        this.canvasImg.onload = function() {\n            _upd();\n        };\n        this.renderedImageIndex = null;\n\n        this.state = {\n            imgSrc: null,\n            dragImage: false,\n            dragX: 0,\n            dragY: 0,\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n\n        if(this.props.app.currentImage!==prevProps.app.currentImage) {\n            console.log('new image clicked');\n            this.setState({\n                imgSrc: null,\n            });\n            return;\n        }\n\n        this.props.appEditorChanged(this.myImgContainer.clientWidth, this.myImgContainer.clientHeight);\n\n        const image = this.props.app.images[this.props.app.currentImage];\n        if(!image.editorState.initedMask) {\n            this.props.appImageInitMask(this.props.app.currentImage);\n            return;\n        }\n\n        if(!image.editorState.initedImagePosition) {\n            this.props.alignInit(this.props.app.currentImage);\n            return;\n        }\n\n        let img_src = tools.makeGetUri()+encodeURI(image.src);\n        if(this.canvasImg.src!==img_src) {\n            const _upd = this.updateCanvas.bind(this);\n            this.canvasImg.onload = function() {\n                _upd();\n            };\n            this.canvasImg.src=img_src;\n            return;\n        }\n\n        // if(image.editorState.needUpdateCanvas) {\n            this.updateCanvas();\n        // }\n\n\n    }\n\n    updateCanvas() {\n\n        // console.log('Zoom updateCanvas');\n        if(!this.myCanvas || this.myCanvas.clientWidth===0 || this.myCanvas.clientHeight===0) return;\n\n        const ctx = this.myCanvas.getContext('2d');\n        let canvasX = this.myCanvas.clientWidth;\n        let canvasY = this.myCanvas.clientHeight;\n        // console.log('drawImage', this.canvasImg.src, canvasX, canvasY);\n\n        const editorState = this.props.app.images[this.props.app.currentImage].editorState;\n        try {\n            ctx.drawImage(this.canvasImg, 0, 0, canvasX, canvasY);\n            let pixelArray = ctx.getImageData(0,0, canvasX, canvasY);\n\n            if(editorState.brightness!==1 || editorState.contrast!==1 || editorState.colorR!==1 || editorState.colorG!==1 || editorState.colorB!==1 ) {\n                pixelArray = tools.ColorCorrection(pixelArray, editorState.brightness, editorState.contrast, editorState.colorR, editorState.colorG, editorState.colorB);\n            }\n            if(editorState.sepia) {\n                pixelArray = tools.ColorSepia(pixelArray, 1);\n            }\n            if(editorState.saturate!==1) {\n                pixelArray = tools.saturate(pixelArray, editorState.saturate);\n            }\n            ctx.putImageData(pixelArray, 0, 0);\n\n            if(this.props.app.isDebugShow) {\n                // draw source rect\n                const {sX, sY, sW, sH} = calculateImageDimensions(this.props.app, this.props.app.currentImage);\n                const r = editorState.ratio;\n                const z = editorState.imageZoom;\n                const w = 6;\n                ctx.lineWidth = w;\n                ctx.strokeStyle = \"yellow\";\n                // console.log(Math.round(sX*r*z), Math.round(sY*r*z), Math.round(sW*r*z), Math.round(sH*r*z));\n                ctx.strokeRect(Math.round(sX*r*z)+w, Math.round(sY*r*z)+w, Math.round(sW*r*z)-w*2, Math.round(sH*r*z)-w*2 );\n            }\n\n        } catch (e) {\n            console.log('drawImage failed');\n        }\n    }\n\n    onDragStart = (e) => {\n        e.preventDefault();\n        return false;\n    };\n\n    movingStart =() =>{\n        this.setState({\n            dragImage: true,\n            dragX: null,\n            dragY: null,\n        });\n\n    };\n    movingOn = (e) => {\n        if(this.state.dragImage) {\n            const dragX = this.state.dragX ? this.state.dragX : e.screenX;\n            const dragY = this.state.dragY ? this.state.dragY : e.screenY;\n            const shiftX = e.screenX - dragX;\n            const shiftY = e.screenY - dragY;\n            // console.log(shiftX, shiftY);\n            this.setState({\n                dragX: e.screenX,\n                dragY: e.screenY,\n            }, ()=> {\n                const sliderPositionLR = this.props.app.images[this.props.app.currentImage].editorState.sliderPositionLR + shiftX;\n                const sliderPositionTB = this.props.app.images[this.props.app.currentImage].editorState.sliderPositionTB + shiftY;\n                this.props.appImageChanged(this.props.app.currentImage, {sliderPositionLR: sliderPositionLR, sliderPositionTB: sliderPositionTB})\n            });\n\n        }\n    };\n    movingStop =() =>{\n        this.setState({\n            dragImage: false,\n            dragX: null,\n            dragY: null,\n        });\n\n    };\n\n    render() {\n        // console.log('ZoomCanvas render');\n        const newImage = this.renderedImageIndex !== this.props.app.currentImage;\n        this.renderedImageIndex = this.props.app.currentImage;\n\n        const image = this.props.app.images[this.props.app.currentImage];\n        if(newImage) {\n            let img_src = tools.makeGetUri()+encodeURI(image.src);\n            if(this.canvasImg.src!==img_src) {\n                this.canvasImg.src=img_src;\n            }\n        }\n\n\n        // console.log('render ImageEditorZoomCanvas ');\n        let maskTBStyle = {\n            height: image.editorState.maskTB,\n        };\n        let viewportStyles = {\n            height: this.props.app.editorHeight - image.editorState.maskTB*2,\n            width: this.props.app.editorWidth - image.editorState.maskLR*2,\n            top: image.editorState.maskTB,\n            left: image.editorState.maskLR,\n        };\n        let maskLRStyle = {\n            width: image.editorState.maskLR,\n        };\n\n        let canvasWidth = image.editorState.imgWidth;\n        let canvasHeight = image.editorState.imgHeight;\n        let canvasStyle = {\n            top: image.editorState.sliderPositionTB,\n            left: image.editorState.sliderPositionLR,\n            transform: 'rotate('+image.editorState.imageRotate+'deg)',\n        };\n\n        let rL, rR, rT, rB;\n        if(this.props.app.isDebugShow) {\n            const p = calculateImageDimensions(this.props.app, this.props.app.currentImage);\n            // console.log(p);\n            const ratio = image.editorState.ratio;\n            rL = Math.round(p.pX*ratio)+2;\n            rR = Math.round((p.pX+p.pW)*ratio)-2;\n            rT = Math.round(p.pY*ratio)+2;\n            rB = Math.round((p.pY+p.pH)*ratio)-2;\n\n            // console.log(rT, rR, rB, rL);\n            // console.log('-----------------');\n        }\n\n       return (\n           <div className=\"app-main-editor-Printable-Mask border-light fld3d\">\n               <div className=\"app-main-editor-Printable-mask _t\" style={{height:'1rem'}} />\n               <div className=\"app-main-editor-Printable-mask _l\" style={{width:'1rem'}} />\n               <div ref={(node)=>{this.myImgContainer=node}} className='app-main-editor-Printable' >\n\n                   <div className=\"app-main-editor-Printable-mask _t\" style={maskTBStyle} />\n                   <div className=\"app-main-editor-Printable-mask _l\" style={maskLRStyle} />\n\n                   <div onMouseMove={this.movingOn} onMouseUp={this.movingStop} className=\"app-main-editor-Printable-viewport\"\n                        style={viewportStyles}>\n                       <canvas\n                           className=\"app-main-editor-Printable-img\"\n                           ref={(node)=>{this.myCanvas=node}}\n                           width={ canvasWidth }\n                           height={ canvasHeight}\n                           style={ canvasStyle }\n                           draggable\n                           onDragStart={(e)=>this.onDragStart(e)}\n                           onMouseDown={this.movingStart}\n                           onMouseUp={this.movingStop}\n                       />\n\n                       {this.props.app.isDebugShow && (\n                           <div className=\"vRuler vRulerX\" style={{left: rL}} />\n                       )}\n                       {this.props.app.isDebugShow && (\n                           <div className=\"vRuler vRulerW\" style={{left: rR}} />\n                       )}\n                       {this.props.app.isDebugShow && (\n                           <div className=\"hRuler hRulerY\" style={{top: rT}} />\n                       )}\n                       {this.props.app.isDebugShow && (\n                           <div className=\"hRuler hRulerH\" style={{top: rB}} />\n                       )}\n\n                   </div>\n                   <div className=\"app-main-editor-Printable-mask _r\" style={maskLRStyle} />\n                   <div className=\"app-main-editor-Printable-mask _b\" style={maskTBStyle} />\n\n\n               </div>\n               <div className=\"app-main-editor-Printable-mask _r\" style={{width:'1rem'}} />\n               <div className=\"app-main-editor-Printable-mask _b\" style={{height:'1rem'}} />\n\n           </div>\n\n\n\n        );\n    }\n}\n\n","import React from \"react\";\nimport Slider from \"@material-ui/lab/Slider\";\nimport Icon from \"@material-ui/core/Icon\";\nimport ImageEditorZoomCanvas from \"./ImageEditorZoomCanvas\"\nimport * as tools from \"../../tools\";\nimport Fab from \"@material-ui/core/Fab\";\n\nexport default class ImageEditorZoom extends React.Component {\n    // constructor(props) {\n    //     super(props);\n    //     this.updateCanvasTimer = null;\n    //\n    //     this.state = {\n    //         needUpdateCanvas: false,\n    //     }\n    // }\n\n\n    sliderZoom = (event, value)=>{\n        const state = this.props.app;\n        const image = state.images[state.currentImage];\n\n        let imageZoom = value / 100;\n\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi)*imageZoom*image.editorState.ratio;\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi)*imageZoom*image.editorState.ratio;\n\n        let L = (image.editorState.imgWidth - imgWidth)/2;\n        let T = (image.editorState.imgHeight - imgHeight)/2;\n\n        // state.needUpdateCanvas = true;\n        // state.images[state.currentImage].editorState.imageZoom = imageZoom;\n        // state.images[state.currentImage].editorState.sliderPositionTB = image.sliderPositionTB + T;\n        // state.images[state.currentImage].editorState.sliderPositionLR = image.sliderPositionLR + L;\n        // state.images[state.currentImage].editorState.imgWidth = imgWidth;\n        // state.images[state.currentImage].editorState.imgHeight = imgHeight;\n        // this.props.saveAppState( state );\n\n        let newState = {\n            imageZoom: imageZoom,\n            sliderPositionTB: image.editorState.sliderPositionTB + T,\n            sliderPositionLR: image.editorState.sliderPositionLR + L,\n            imgWidth: imgWidth,\n            imgHeight: imgHeight,\n            needUpdateCanvas: true,\n        };\n\n        this.props.appImageChanged( this.props.app.currentImage, newState);\n\n    };\n\n    sliderChangeTB = (event, value)=>{this.props.appImageChanged( this.props.app.currentImage, { sliderPositionTB: value, }) };\n\n    sliderChangeLR = (event, value)=>{this.props.appImageChanged( this.props.app.currentImage, { sliderPositionLR: value, }) };\n\n    imageRotate = ()=> {\n        let imageRotate = 0;\n        switch (this.props.app.images[this.props.app.currentImage].editorState.imageRotate) {\n            case 90:\n                imageRotate = 180;\n                break;\n            case 180:\n                imageRotate = 270;\n                break;\n            case 270:\n                imageRotate = 0;\n                break;\n            default:\n                imageRotate = 90;\n                break;\n        }\n        this.props.appImageChanged( this.props.app.currentImage, { imageRotate: imageRotate });\n    };\n\n    render() {\n        // console.log('render ImageEditorZoom, imgWidth:', this.props.parentState.imgWidth);\n        const image = this.props.app.images[this.props.app.currentImage];\n\n        return (\n            <div className=\"h-100 d-flex flex-row\">\n                <div className=\"app-main-editor-visual-left h-90 flex-grow-0 flex-shrink-0\">\n                    <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\n                        <Fab color=\"primary\" className={'_fabmini ml-3'}\n                             onClick={()=>{this.sliderZoom(null, image.editorState.imageZoom*100+0.51)}}\n                             disabled={false}\n                             aria-label=\"Colors\">\n                            <Icon>zoom_in</Icon>\n                        </Fab>\n                    </div>\n                    <div className=\"vert-slider-wrapper h-85 position-relative d-inline-block\">\n\n                        <Slider className='app-slider-for-zoom'\n                                classes={{thumb: '_thumb'}}\n                                thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>zoom_in</Icon>}\n                                vertical\n                                max={image.editorState.imageZoomMax*100}\n                                min={image.editorState.imageZoomMin*100}\n                                value={image.editorState.imageZoom*100}\n                                onChange={this.sliderZoom} />\n                        {this.props.app.isDebugShow && (\n                        <div className={'_value'}><small>{image.editorState.imageZoom}</small></div>\n                        )}\n\n                    </div>\n                    <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\n                        <Fab color=\"primary\" className={'_fabmini ml-3'}\n                             onClick={()=>{this.sliderZoom(null, image.editorState.imageZoom*100-0.51)}}\n                             disabled={false}\n                             aria-label=\"Colors\">\n                            <Icon>zoom_out</Icon>\n                        </Fab>\n                    </div>\n                </div>\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\n                    <div className=\"h-90\">\n                        <ImageEditorZoomCanvas\n                            {...this.props}\n                        />\n                    </div>\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100  d-flex flex-row\">\n                        <div className=\"hori-slider-button-wrapper text-center flex-grow-0\">\n                            <Fab color=\"primary\" className=\"_fabmini mt-3\"\n                                 onClick={()=>{this.sliderChangeLR(null, image.editorState.sliderPositionLR-1)}}\n                                 disabled={false}\n                                 aria-label=\"Colors\">\n                                <Icon>navigate_before</Icon>\n                            </Fab>\n                        </div>\n                        <div className=\" flex-grow-1\">\n                            <div className=\"hori-slider-wrapper h-100 w-100 position-relative d-inline-flex\">\n                                <Slider className='app-slider-for-position'\n                                        classes={{trackAfter: '_trackAfter', thumb: '_thumb'}}\n                                        thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>image</Icon>}\n                                        max={(this.props.app.editorWidth-image.editorState.maskLR*2)*0.9}\n                                        value={image.editorState.sliderPositionLR}\n                                        min={(image.editorState.imgWidth)*-0.9}\n                                        onChange={this.sliderChangeLR}\n                                />\n\n                                {this.props.app.isDebugShow && (\n                                    <div className={'_value'}><small>({image.editorState.sliderPositionLR})</small></div>\n                                )}\n                            </div>\n\n                        </div>\n                        <div className=\"hori-slider-button-wrapper text-center flex-grow-0\" >\n                            <Fab color=\"primary\" className={'_fabmini mt-3'}\n                                 onClick={()=>{this.sliderChangeLR(null, image.editorState.sliderPositionLR+1)}}\n                                 disabled={false}\n                                 aria-label=\"Colors\">\n                                <Icon>navigate_next</Icon>\n                            </Fab>\n                        </div>\n                    </div>\n                </div>\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\n\n                    <div className=\"d-inline-flex flex-column h-100\">\n                        <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\n                            <Fab color=\"primary\" className={'_fabmini'}\n                                 onClick={()=>{this.sliderChangeTB(null, image.editorState.sliderPositionTB-1)}}\n                                 disabled={false}\n                                 aria-label=\"Colors\">\n                                <Icon>expand_less</Icon>\n                            </Fab>\n                        </div>\n                        <div className=\"vert-slider-wrapper h-85 position-relative d-inline-flex\">\n                            <Slider className='app-slider-for-position'\n                                    classes={{trackAfter: '_trackAfter', thumb: '_thumb'}}\n                                    thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>image</Icon>}\n                                    max={(image.editorState.imgHeight)*-0.9}\n                                    value={image.editorState.sliderPositionTB}\n                                    min={(this.props.app.editorHeight-image.editorState.maskTB*2)*0.9}\n                                    onChange={this.sliderChangeTB}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                                <div className={'_value'}><small>({image.editorState.sliderPositionTB})</small></div>\n                            )}\n                        </div>\n                        <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\n                            <Fab color=\"primary\" className={'_fabmini'}\n                                 onClick={()=>{this.sliderChangeTB(null, image.editorState.sliderPositionTB+1)}}\n                                 disabled={false}\n                                 aria-label=\"Colors\">\n                                <Icon>expand_more</Icon>\n                            </Fab>\n                        </div>\n\n                    </div>\n\n\n                    <div className=\"vert-buttons-wrapper h-100 d-inline-flex\">\n                        <div className=\"app-main-editor-visual-right-buttons\">\n                            <div className=\"zoom-positioning\">\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1  d-inline-block\"/>\n                                <div className=\"zoom-positioning-w2 zoom-positioning-h1 d-inline-block\">\n                                    <button type=\"button\"\n                                            className={\"btn btn-primary h-100\"}\n                                            onClick={()=>{this.props.alignTop()}}>\n                                        <Icon>vertical_align_top</Icon>\n                                    </button>\n                                </div>\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\n                            </div>\n                            <div className=\"zoom-positioning\">\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h2 d-inline-block\">\n                                    <button type=\"button\"\n                                            className={\"btn btn-primary h-100\"}\n                                            onClick={()=>{this.props.alignLeft()}}>\n                                        <Icon style={{transform:'rotate(270deg)'}}>vertical_align_top</Icon>\n                                    </button>\n                                </div>\n                                <div className=\"d-inline-block\">\n                                    <div className=\"zoom-positioning-w2 zoom-positioning-h1\">\n                                        <button type=\"button\"\n                                                className={\"btn btn-primary h-100\"}\n                                                onClick={()=>{this.props.alignLandscape(this.props.app.currentImage, image.format)}}>\n                                            <Icon>swap_horiz</Icon>\n                                        </button>\n                                    </div>\n                                    <div className=\"zoom-positioning-w2 zoom-positioning-h1\">\n                                        <button type=\"button\"\n                                                className={\"btn btn-primary h-100\"}\n                                                onClick={()=>{this.props.alignPortrait(this.props.app.currentImage, image.format)}}>\n                                            <Icon>swap_vert</Icon>\n                                        </button>\n                                    </div>\n                                </div>\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h2 d-inline-block\">\n                                    <button type=\"button\"\n                                            className={\"btn btn-primary h-100\"}\n                                            onClick={()=>{this.props.alignRight()}}>\n                                        <Icon style={{transform:'rotate(90deg)'}}>vertical_align_top</Icon>\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"zoom-positioning\">\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\n                                <div className=\"zoom-positioning-w2 zoom-positioning-h1 d-inline-block\">\n                                    <button type=\"button\"\n                                            className={\"btn btn-primary h-100\"}\n                                            onClick={()=>{this.props.alignBottom()}}>\n                                        <Icon style={{transform:'rotate(180deg)'}}>vertical_align_top</Icon>\n                                    </button>\n                                </div>\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\n                            </div>\n                            <div className=\"app-main-editor-visual-rotate-buttons mt-4 text-center\">\n                                <button type=\"button\"\n                                        className={\"btn  btn-big btn-primary\"}\n                                        onClick={this.imageRotate}>\n                                    <Icon>rotate_right</Icon>\n                                </button>\n                            </div>\n\n\n                        </div>\n\n                    </div>\n\n                </div>\n            </div>\n\n        )\n    }\n}\n","import React from \"react\";\nimport * as tools from \"../../tools\";\n\nexport default class ImageEditorColorCanvas extends React.Component {\n    constructor(props) {\n        super(props);\n        this.canvasImg = new Image();\n        this.canvasImg.crossOrigin = 'anonymous';\n        const _upd = this.updateCanvas.bind(this);\n        this.canvasImg.onload = function() {\n            _upd();\n        };\n\n\n\n        this.state = {\n            imgSrc: null,\n            fakeThins: true,\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n\n        // console.log('componentDidUpdate');\n\n        if(this.props.app.currentImage!==prevProps.app.currentImage) {\n            console.log('new image clicked');\n            this.setState({\n                imgSrc: null,\n            });\n            return;\n        }\n\n        this.props.appEditorChanged(this.myImgContainer.clientWidth, this.myImgContainer.clientHeight);\n\n        const image = this.props.app.images[this.props.app.currentImage];\n        if(!image.editorState.initedMask) {\n            this.props.appImageInitMask(this.props.app.currentImage);\n            return;\n        }\n\n        if(!image.editorState.initedImagePosition) {\n            this.props.alignInit(this.props.app.currentImage);\n            return;\n        }\n\n        let img_src = tools.makeGetUri()+encodeURI(image.src);\n        if(this.canvasImg.src!==img_src) {\n            const _upd = this.updateCanvas.bind(this);\n            this.canvasImg.onload = function() {\n                _upd();\n            };\n            this.canvasImg.src=img_src;\n            return;\n        }\n\n        // if(image.editorState.needUpdateCanvas) {\n        this.updateCanvas();\n        // }\n\n\n    }\n\n    updateCanvas() {\n\n        // console.log('Zoom updateCanvas');\n        if(!this.myCanvas || this.myCanvas.clientWidth===0 || this.myCanvas.clientHeight===0) return;\n\n        const ctx = this.myCanvas.getContext('2d');\n        let canvasX = this.myCanvas.clientWidth;\n        let canvasY = this.myCanvas.clientHeight;\n        // console.log('drawImage', this.canvasImg.src, canvasX, canvasY);\n\n        const editorState = this.props.app.images[this.props.app.currentImage].editorState;\n        try {\n            ctx.drawImage(this.canvasImg, 0, 0, canvasX, canvasY);\n            let pixelArray = ctx.getImageData(0,0, canvasX, canvasY);\n\n            if(editorState.brightness!==1 || editorState.contrast!==1 || editorState.colorR!==1 || editorState.colorG!==1 || editorState.colorB!==1 ) {\n                pixelArray = tools.ColorCorrection(pixelArray, editorState.brightness, editorState.contrast, editorState.colorR, editorState.colorG, editorState.colorB);\n            }\n            if(editorState.sepia) {\n                pixelArray = tools.ColorSepia(pixelArray, 1);\n            }\n            if(editorState.saturate!==1) {\n                pixelArray = tools.saturate(pixelArray, editorState.saturate);\n            }\n            ctx.putImageData(pixelArray, 0, 0);\n\n            // this.setState({\n            //     imgSrc: this.myCanvas.toDataURL('image/jpeg', 0.7),\n            // });\n            // this.props.appImageChanged( this.props.app.currentImage,{needUpdateCanvas: false})\n\n        } catch (e) {\n            console.log('drawImage failed');\n        }\n\n    }\n\n    render() {\n\n        // console.log('ColorCanvas render');\n        const newImage = this.renderedImageIndex !== this.props.app.currentImage;\n        this.renderedImageIndex = this.props.app.currentImage;\n\n        const image = this.props.app.images[this.props.app.currentImage];\n        if(newImage) {\n            let img_src = tools.makeGetUri()+encodeURI(image.src);\n            if(this.canvasImg.src!==img_src) {\n                this.canvasImg.src=img_src;\n            }\n        }\n\n\n        // console.log('render ImageEditorZoomCanvas ');\n        let maskTBStyle = {\n            height: image.editorState.maskTB,\n        };\n        let viewportStyles = {\n            height: this.props.app.editorHeight - image.editorState.maskTB*2,\n            width: this.props.app.editorWidth - image.editorState.maskLR*2,\n            top: image.editorState.maskTB,\n            left: image.editorState.maskLR,\n        };\n        let maskLRStyle = {\n            width: image.editorState.maskLR,\n        };\n\n        let canvasWidth = image.editorState.imgWidth;\n        let canvasHeight = image.editorState.imgHeight;\n        let canvasStyle = {\n            top: image.editorState.sliderPositionTB,\n            left: image.editorState.sliderPositionLR,\n            transform: 'rotate('+image.editorState.imageRotate+'deg)',\n        };\n\n        return (\n            <div className=\"app-main-editor-Printable-Mask border-light fld3d\">\n                <div className=\"app-main-editor-Printable-mask _t\" style={{height:'1rem'}} />\n                <div className=\"app-main-editor-Printable-mask _l\" style={{width:'1rem'}} />\n\n                <div ref={(node)=>{this.myImgContainer=node}} className='app-main-editor-Printable' >\n\n                    <div className=\"app-main-editor-Printable-mask _t\" style={maskTBStyle} />\n                    <div className=\"app-main-editor-Printable-mask _l\" style={maskLRStyle} />\n\n                    <div className=\"app-main-editor-Printable-viewport\"\n                         style={viewportStyles}>\n                        <canvas\n                            className=\"app-main-editor-Printable-img\"\n                            ref={(node)=>{this.myCanvas=node}}\n                            width={ canvasWidth }\n                            height={ canvasHeight}\n                            style={ canvasStyle }\n                        />\n\n\n\n                    </div>\n                    <div className=\"app-main-editor-Printable-mask _r\" style={maskLRStyle} />\n                    <div className=\"app-main-editor-Printable-mask _b\" style={maskTBStyle} />\n\n\n                </div>\n\n                <div className=\"app-main-editor-Printable-mask _r\" style={{width:'1rem'}} />\n                <div className=\"app-main-editor-Printable-mask _b\" style={{height:'1rem'}} />\n\n            </div>\n\n\n        );\n    }\n}\n\n","import React from \"react\";\nimport Icon from \"@material-ui/core/Icon\";\nimport Slider from \"@material-ui/lab/Slider\";\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Switch from '@material-ui/core/Switch';\nimport ImageEditorColorCanvas from \"./ImageEditorColorCanvas\";\n\n\nexport default class ImageEditorBrightness extends React.Component {\n\n    sliderChangeBrightness =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, brightness: value} );\n        // this.props.setStateFromChild({ brightness: value, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderChangeContrast =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, contrast: value} );\n        // this.props.setStateFromChild({ contrast: value, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderChangeSaturate =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, saturate: value} );\n        // this.props.setStateFromChild({ saturate: value, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderResetBrightness =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, brightness: 1} );\n        // this.props.setStateFromChild({ brightness: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderResetContrast =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, contrast: 1} );\n        // this.props.setStateFromChild({ contrast: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderResetSaturate =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, saturate: 1} );\n        // this.props.setStateFromChild({ saturate: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderChangeSepia = () => {\n        this.props.appImageChanged(this.props.app.currentImage, {\n            sepia: !this.props.app.images[this.props.app.currentImage].editorState.sepia,\n            colorR: 1,\n            colorG: 1,\n            colorB: 1,\n            needUpdateCanvas: true,\n        } );\n        // this.props.setStateFromChild({\n        //     sepia: !this.props.parentState.sepia,\n        //     colorR: 1,\n        //     colorG: 1,\n        //     colorB: 1,\n        //     needUpdateCanvas: true,\n        // }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n\n\n    render() {\n\n        const image = this.props.app.images[this.props.app.currentImage];\n\n        return (\n            <div className=\"h-100 d-flex flex-row\">\n                <div className=\"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0\">\n                </div>\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\n                    <div className=\"h-90\">\n                        <ImageEditorColorCanvas\n                            {...this.props}\n                        />\n                    </div>\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100\">\n\n                    </div>\n                </div>\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\n                    <div className=\"h-75\">\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetBrightness}>brightness_medium</Icon>\n                            <Slider className='app-slider-for-filter'\n                                    max={2}\n                                    value={image.editorState.brightness}\n                                    min={0}\n                                    onChange={this.sliderChangeBrightness}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.brightness})</small></div>\n                            )}\n                        </div>\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetContrast}>tonality</Icon>\n                            <Slider className='app-slider-for-filter'\n                                    max={2}\n                                    value={image.editorState.contrast}\n                                    min={0}\n                                    onChange={this.sliderChangeContrast}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.contrast})</small></div>\n                            )}\n                        </div>\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetSaturate}>color_lens</Icon>\n                            <Slider className='app-slider-for-filter'\n                                    max={2}\n                                    value={image.editorState.saturate}\n                                    min={0}\n                                    onChange={this.sliderChangeSaturate}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.saturate})</small></div>\n                            )}\n                        </div>\n\n\n                    </div>\n                    <div className=\"h-25\">\n                        <div className=\"hori-slider-wrapper w-100 position-relative d-inline-flex\">\n                            <FormControlLabel\n                                control={\n                                    <Switch\n                                        checked={image.editorState.sepia}\n                                        onChange={this.sliderChangeSepia}\n                                        value=\"true\"\n                                        color=\"primary\"\n                                    />\n                                }\n                                label=\"Sepia\"\n                            />\n                        </div>\n\n                    </div>\n\n\n                </div>\n            </div>\n\n        )\n\n    }\n}\n\n","import React from \"react\";\nimport {THEME} from \"../../tools\";\nimport Slider from \"@material-ui/lab/Slider\";\nimport ImageEditorColorCanvas from \"./ImageEditorColorCanvas\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Switch from \"@material-ui/core/Switch\";\n\nexport default class ImageEditorBrightness extends React.Component {\n\n    sliderChangeColorR =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorR: value} );\n\n        // this.props.setStateFromChild({ colorR: value, needUpdateCanvas: true }, ()=>{\n        //         this.props.setStateFromChild({needUpdateCanvas: false});\n        //     })\n    };\n    sliderChangeColorG =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorG: value} );\n        // this.props.setStateFromChild({ colorG: value, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderChangeColorB =  (event, value)=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorB: value} );\n        // this.props.setStateFromChild({ colorB: value, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n\n    sliderResetColorR =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorR: 1} );\n        // this.props.setStateFromChild({ colorR: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderResetColorG =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorG: 1} );\n        // this.props.setStateFromChild({ colorG: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderResetColorB =  ()=>{\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorB: 1} );\n        // this.props.setStateFromChild({ colorB: 1, needUpdateCanvas: true }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n    sliderChangeSepia = () => {\n        this.props.appImageChanged(this.props.app.currentImage, {\n            sepia: !this.props.app.images[this.props.app.currentImage].editorState.sepia,\n            colorR: 1,\n            colorG: 1,\n            colorB: 1,\n            needUpdateCanvas: true,\n        });\n        // this.props.setStateFromChild({\n        //     sepia: !this.props.parentState.sepia,\n        //     colorR: 1,\n        //     colorG: 1,\n        //     colorB: 1,\n        //     needUpdateCanvas: true,\n        // }, ()=>{\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\n        // })\n    };\n\n\n\n    render() {\n\n        const image = this.props.app.images[this.props.app.currentImage];\n\n        return (\n            <div className=\"h-100 d-flex flex-row\">\n                <div className=\"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0\">\n                </div>\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\n                    <div className=\"h-90\">\n                        <ImageEditorColorCanvas\n                            {...this.props}\n                        />\n                    </div>\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100\">\n\n                    </div>\n                </div>\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\n                    <div className=\"h-75\">\n\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <div className=\"_reset app-slider-icon\"\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\n                                 onClick={this.sliderResetColorR}>R</div>\n                            <Slider className='app-slider-for-filter'\n                                    classes={{track: '_trackR', thumb: '_thumbR'}}\n                                    step={0.05}\n                                    max={2}\n                                    value={image.editorState.colorR}\n                                    min={0}\n                                    onChange={this.sliderChangeColorR}\n                                    disabled={image.editorState.sepia}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.colorR})</small></div>\n                            )}\n                        </div>\n\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <div className=\"_reset app-slider-icon\"\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\n                                 onClick={this.sliderResetColorG}>G</div>\n                            <Slider className='app-slider-for-filter'\n                                    classes={{track: '_trackG', thumb: '_thumbG'}}\n                                    step={0.05}\n                                    max={2}\n                                    value={image.editorState.colorG}\n                                    min={0}\n                                    onChange={this.sliderChangeColorG}\n                                    disabled={image.editorState.sepia}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.colorG})</small></div>\n                            )}\n                        </div>\n\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\n                            <div className=\"_reset app-slider-icon\"\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\n                                 onClick={this.sliderResetColorB}>B</div>\n                            <Slider className='app-slider-for-filter'\n                                    classes={{track: '_trackB', thumb: '_thumbB'}}\n                                    step={0.05}\n                                    max={2}\n                                    value={image.editorState.colorB}\n                                    min={0}\n                                    onChange={this.sliderChangeColorB}\n                                    disabled={image.editorState.sepia}\n                                    vertical\n                            />\n                            {this.props.app.isDebugShow && (\n                            <div className={'_value'}><small>({image.editorState.colorB})</small></div>\n                            )}\n                        </div>\n                    </div>\n                    <div className=\"h-25\">\n                        <div className=\"hori-slider-wrapper w-100 position-relative d-inline-flex\">\n                            <FormControlLabel\n                                control={\n                                    <Switch\n                                        checked={image.editorState.sepia}\n                                        onChange={this.sliderChangeSepia}\n                                        value=\"true\"\n                                        color=\"primary\"\n                                    />\n                                }\n                                label=\"Sepia\"\n                            />\n                        </div>\n\n                    </div>\n\n\n                </div>\n            </div>\n\n        )\n\n    }\n}\n\n","import React from \"react\";\nimport * as tools from \"../../tools\";\nimport Icon from \"@material-ui/core/Icon\";\nimport Fab from '@material-ui/core/Fab';\nimport ImageEditorZoom from \"./ImageEditorZoom\";\nimport ImageEditorBrightness from \"./ImageEditorBrightness\";\nimport ImageEditorColor from \"./ImageEditorColor\";\nimport Paper from \"@material-ui/core/Paper\";\n\nexport default class ImageEditor extends React.Component {\n    // constructor(props) {\n    //     super(props);\n    //     this.editorControlsStyle = null;\n    //     // this.need_init = true;\n    //\n    //     this.\n    // }\n    state = {\n        editorControlsStyle: null,\n        showTabButton: true,\n    };\n\n    componentDidMount(){\n        // console.log('componentDidMount');\n        // let editorControls_h = this.editorWrapper.clientHeight - this.editorTabs.clientHeight;\n        //\n        // this.editorControlsStyle = {height: editorControls_h};\n        // this.forceUpdate();\n        // console.log('componentDidMount, height:', this.editorWrapper.clientHeight - this.editorTabs.clientHeight);\n        this.setState({\n            editorControlsStyle: {height: this.editorWrapper.clientHeight - this.editorTabs.clientHeight}\n        });\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if(!this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\n            this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas:true, currentTab:0} );\n        }\n    }\n\n    tabChange = (value) => {\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas:true, currentTab:value} );\n    };\n\n    // setStateFromChild=(newState, callback)=> {\n    //     // console.log(newState);\n    //     this.setState(newState, ()=>{\n    //         if(typeof(callback)==='function') callback();\n    //     });\n    // };\n\n\n    alignTop = ()=> {\n        let image = this.props.app.images[this.props.app.currentImage];\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\n        let sliderPositionTB = 0;\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n            sliderPositionTB = (image.editorState.imgWidth-image.editorState.imgHeight)/2;\n        }\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionTB:sliderPositionTB} );\n    };\n\n    alignRight = ()=> {\n        let image = this.props.app.images[this.props.app.currentImage];\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\n\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi)*image.editorState.imageZoom*image.editorState.ratio;\n        let sliderPositionLR = this.props.app.editorWidth - image.editorState.maskLR*2 - imgWidth;\n\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n            sliderPositionLR += (image.editorState.imgWidth-image.editorState.imgHeight)/2;\n        }\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionLR: sliderPositionLR} );\n\n    };\n\n    alignBottom = ()=> {\n        let image = this.props.app.images[this.props.app.currentImage];\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi)*image.editorState.imageZoom*image.editorState.ratio;\n        let sliderPositionTB =  this.props.app.editorHeight - image.editorState.maskTB*2 - imgHeight;\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n            sliderPositionTB -= (image.editorState.imgWidth-image.editorState.imgHeight)/2;\n        }\n\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionTB:sliderPositionTB} );\n    };\n\n    alignLeft = ()=> {\n        let image = this.props.app.images[this.props.app.currentImage];\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\n        let sliderPositionLR = 0;\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\n            sliderPositionLR -= (image.editorState.imgWidth-image.editorState.imgHeight)/2;\n        }\n\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionLR:sliderPositionLR} );\n    };\n\n    render() {\n\n        const image = this.props.app.images[this.props.app.currentImage];\n        let currentTab = image.editorState.currentTab;\n        if(currentTab<0 || currentTab>2) currentTab = 0;\n\n        return (\n            <div className=\"h-100\" ref={(node)=>{this.editorWrapper=node}}>\n                <div ref={(node)=>{this.editorTabs=node}} className=\"app-main-editor-visual-container-tabs\">\n\n                </div>\n                <Paper style={this.state.editorControlsStyle} className=\"app-main-editor-visual-container-controls app-bg-e position-relative\">\n                    {currentTab===0 &&(\n                        <ImageEditorZoom\n                            {...this.props}\n                            alignTop = {this.alignTop.bind(this)}\n                            alignRight = {this.alignRight.bind(this)}\n                            alignBottom = {this.alignBottom.bind(this)}\n                            alignLeft = {this.alignLeft.bind(this)}\n                        />\n                    )}\n                    {currentTab===1 &&(\n                        <ImageEditorBrightness\n                            {...this.props}\n                        />\n                    )}\n                    {currentTab===2 &&(\n                        <ImageEditorColor\n                            {...this.props}\n                        />\n                    )}\n\n                    <div onClick={ ()=>{this.setState({showTabButton: !this.state.showTabButton})} }\n                        className=\"app-btn-pie app-main-editor-tabs-pie bg-primary text-light \">\n                        <Icon>settings_brightness</Icon>\n                    </div>\n\n                    {this.state.showTabButton &&(\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\n                             style={{right: '1em', bottom: '8em'}}\n                             onClick={()=>{this.tabChange(2)}}\n                             disabled={false}\n                             aria-label=\"Colors\">\n                            <Icon>tune</Icon>\n                        </Fab>\n\n                    )}\n\n                    {this.state.showTabButton &&(\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\n                             style={{right: '5.5em', bottom: '5.5em' }}\n                             onClick={()=>{this.tabChange(1)}}\n                             disabled={false}\n                             aria-label=\"Brightness\"\n                             type=\"button\" >\n                            <Icon>brightness_medium</Icon>\n                        </Fab>\n                    )}\n\n                    {this.state.showTabButton &&(\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\n                             style={{right: '8em', bottom: '1em' }}\n                             onClick={()=>{this.tabChange(0)}}\n                             disabled={false}\n                             aria-label=\"Zoom\">\n                            <Icon>transform</Icon>\n                        </Fab>\n                    )}\n\n                    {this.state.showTabButton &&(\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\n                             style={{right: '1em', bottom: '18em' }}\n                             onClick={()=>{this.props.changeCountImage(this.props.app.currentImage, image.count+1)}}\n                             disabled={image.count>98}\n                             aria-label=\"Increase\">\n                            <Icon>add</Icon>\n                        </Fab>\n                    )}\n\n                    {this.state.showTabButton &&(\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\n                             style={{right: '1em', bottom: '13em' }}\n                             onClick={()=>{this.props.changeCountImage(this.props.app.currentImage, image.count-1)}}\n                             disabled={image.count<0}\n                             aria-label=\"Decrease\">\n                            <Icon>remove</Icon>\n                        </Fab>\n                    )}\n\n                </Paper>\n\n\n\n\n\n\n            </div>\n\n        )\n    }\n}\n\n","import React from 'react';\n\nimport './index.css';\n\nimport t from \"../i18n\";\nimport * as tools from \"../../tools\";\n\n\nimport ImageThumb from \"./ImageThumb\"\nimport ImageEditor from \"./ImageEditor\"\n\nimport Paper from \"@material-ui/core/Paper\";\nimport Icon from \"@material-ui/core/Icon\";\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Fab from \"@material-ui/core/Fab\";\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\n\n\nexport default class PageEditor extends React.Component {\n    constructor(props) {\n        super(props);\n        this.undo = {\n            history:[],\n            current:null,\n            skipChanges: true,\n        };\n\n\n        this.state = {\n            confirmBack: false,\n            imagesCount: 0,\n            imagesSum: 0,\n        };\n    }\n\n    componentDidMount() {\n        // if(this.props.app.currentImage===null)\n            this.selectImage(0);\n        this.countSumm();\n    };\n\n    countSumm() {\n        let imagesCount = 0;\n        let imagesSum = 0;\n        let len=this.props.app.images.length;\n        for(let i=0; i<len; i++) {\n            imagesCount += this.props.app.images[i].count;\n            imagesSum += this.props.app.images[i].count * this.props.app.images[i].format.cost;\n        }\n        this.setState({imagesCount:imagesCount, imagesSum:imagesSum})\n    }\n\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\n        if(this.props.app.images[this.props.app.currentImage].editorState.initedImagePosition && this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\n            let wasChanged = true;\n            if(this.undo.history.length>0) {\n                let lastUndo = this.undo.history[this.undo.history.length-1];\n                wasChanged = !(tools.deepCompare(lastUndo, this.props.app.images[this.props.app.currentImage].editorState));\n            }\n            // console.log('skipChanges:', this.undo.skipChanges, 'history.length', this.undo.history.length);\n            if(!this.undo.skipChanges || this.undo.history.length===0) {\n                // console.log('wasChanged:', wasChanged);\n                if(wasChanged) {\n                    if(this.undo.current!==null) {\n                        this.undo.history = this.undo.history.slice(0, this.undo.current-1);\n                        // console.log('this.undo.history.slice', 0, this.undo.current);\n                        // console.log('slice undo', this.undo);\n                    }\n                    this.undo.history.push( Object.assign({}, this.props.app.images[this.props.app.currentImage].editorState ) );\n                    let maxHistoryLength = 99;\n                    if(this.undo.history.length>maxHistoryLength) {\n                        let start = this.undo.history.length-maxHistoryLength;\n                        this.undo.history = this.undo.history.slice(start, start+maxHistoryLength);\n                    }\n                    this.undo.current =null;\n                    // console.log('add undo', this.undo);\n                }\n            }\n            this.undo.skipChanges = false;\n        }\n\n        return true;\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n\n        // if(!this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\n\n\n        // if(!this.props.app.images[0].editorState.initedMask) {\n        //     this.selectImage(0);\n        //     return;\n        // }\n        this.props.savePages();\n\n\n    }\n\n    checkUndo = () => {\n        return !(this.undo.history.length===1 || this.undo.current===0);\n    };\n    clickUndo = () => {\n        if(!this.checkUndo) return false;\n        let currentUndo = this.undo.history.length-2;\n        if(this.undo.current>0) currentUndo = this.undo.current-1;\n        this.props.appImageChanged( this.props.app.currentImage, this.undo.history[currentUndo] );\n\n        this.undo.current = currentUndo;\n        this.undo.skipChanges = true;\n\n        // console.log('clickUndo', currentUndo);\n        // console.log('undo:', this.undo);\n\n    };\n\n    checkRedo = () => {\n        return !(this.undo.current===null || this.undo.current===this.undo.history.length-1);\n    };\n    clickRedo = () => {\n        if(!this.checkRedo) return false;\n        let currentUndo = this.undo.current+1;\n        this.props.appImageChanged( this.props.app.currentImage, this.undo.history[currentUndo] );\n\n        this.undo.current = currentUndo;\n        this.undo.skipChanges = true;\n\n        // console.log('clickRedo', currentUndo);\n        // console.log('undo:', this.undo);\n\n    };\n\n    selectImage = (index) => {\n        // console.log('selected '+index, this.props.app.currentImage);\n        if(index!==this.props.app.currentImage) {\n            this.undo = {\n                history:[],\n                current:null,\n                skipChanges: true,\n            };\n        }\n\n        this.props.appSetState({\n            currentImage : index,\n        });\n    };\n\n    changeCurrentImage = (step) => {\n        const newCurrent = this.props.app.currentImage+step;\n        if(newCurrent>=0 && newCurrent<this.props.app.images.length) {\n            this.selectImage(newCurrent);\n        }\n    };\n\n    changeCountImage = (index, count) => {\n        if(count>-1) {\n            let images = this.props.app.images;\n            images[index].count = count;\n            let state = {images : images};\n            if(count===0) {\n                this.changeCurrentImage(1);\n            }\n            this.props.appSetState(state, ()=>{this.countSumm()})\n        } else {\n            this.changeCurrentImage(1);\n            if(this.props.app.currentImage<this.props.app.images.length-1) {\n                this.props.appSetState({currentImage : this.props.app.currentImage+1});\n            }\n        }\n\n    };\n\n\n    scrollIntoViewIfNeed = (domNode) => {\n        domNode.scrollIntoViewIfNeeded();\n    };\n\n    backPressed() {\n        this.setState({confirmBack: true});\n\n    }\n    backConfirmed(back) {\n        if(back) {\n            this.props.onClickPrevBtn();\n        }\n        this.setState({confirmBack: false});\n    }\n\n    openFormatsPanel = () => {\n        this.setState({isFormatsOpen:!this.state.isFormatsOpen});\n    };\n\n    formatChange(index) {\n        let format = this.props.app.formats[index];\n        let currentImage = this.props.app.currentImage;\n        let images = this.props.app.images; //[this.props.app.currentImage];\n        images[currentImage].format = format;\n        images[currentImage].editorState.initedMask = false;\n        images[currentImage].editorState.initedImagePosition = false;\n\n        this.props.appSetState({images: images}, ()=>{\n            this.props.appImageInitMask(currentImage, true, ()=>{\n                this.props.alignInit(currentImage, ()=>{this.countSumm()});\n            });\n        });\n\n        // appSetState\n        this.setState({isFormatsOpen:false});\n    }\n\n    repeatColors =() => {\n        let colors = this.getColorsToRepeat();\n        if(colors)\n            this.props.appImageChanged( this.props.app.currentImage, colors );\n    };\n\n    getColorsToRepeat = () => {\n        if(this.props.app.currentImage===null || this.props.app.currentImage===0) return false;\n        let editorState = this.props.app.images[this.props.app.currentImage-1].editorState;\n        let current =  this.props.app.images[this.props.app.currentImage].editorState;\n        let hasChange = false;\n        if(editorState.brightness!==current.brightness) hasChange = true;\n        if(editorState.contrast!==current.contrast) hasChange = true;\n        if(editorState.saturate!==current.saturate) hasChange = true;\n        if(editorState.colorR!==current.colorR) hasChange = true;\n        if(editorState.colorG!==current.colorG) hasChange = true;\n        if(editorState.colorB!==current.colorB) hasChange = true;\n\n        if(!hasChange) return false;\n        return {\n            brightness: editorState.brightness,\n            contrast: editorState.contrast,\n            saturate: editorState.saturate,\n            colorR: editorState.colorR,\n            colorG: editorState.colorG,\n            colorB: editorState.colorB,\n        }\n    };\n\n    render() {\n\n        let format = this.props.app.images[this.props.app.currentImage] ? this.props.app.images[this.props.app.currentImage].format : {};\n\n        let formatsList = this.state.isFormatsOpen ? (\n            <ClickAwayListener onClickAway={()=>{this.openFormatsPanel()}}>\n                <Paper className=\"app-main-change-formats scrollbar position-absolute\">\n                    <table className=\"table-formats\">\n                        {this.props.app.formats.map( (format, index)=>format.enabled ?\n                            <tbody key={index} onClick={()=>this.formatChange(index)}>\n                            <tr>\n                                <th scope=\"row\">{format.name}</th>\n                                <th scope=\"row\">{format.height}\"x {format.width}\"</th>\n                                <th scope=\"row\">{Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}</th>\n                                <th scope=\"row\">{t(format.surface)}</th>\n                                <th scope=\"row\">{tools.Round(format.cost)}</th>\n                            </tr>\n                            </tbody>\n\n                            : '' )}\n                    </table>\n                </Paper>\n            </ClickAwayListener>\n        ) : null;\n\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\n                <div style={{display:'none', visibility:'hidden'}}>\n                    <canvas ref={(node)=>{this.processCanvasNode=node}} />\n                </div>\n                <div className=\"app-main h-75\">\n                    <div className=\"app-main-selectors w-100 h-100\">\n\n                        <div className=\"app-main-editor-wrapper h-100 p-2 d-inline-block\">\n                            <div className=\" h-100 position-relative\">\n                                {this.props.app.currentImage!==null && (\n                                    <ImageEditor\n                                        changeCountImage={this.changeCountImage.bind(this)}\n                                        processCanvas={this.processCanvasNode}\n                                        onMessage={this.props.onMessage}\n                                        {...this.props}\n                                    />\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"app-main-rightwidget h-100 p-2 d-inline-block\">\n                            <Paper className=\"h-100 p-2 app-bg-e position-relative\">\n                                <div className=\"_fabwrapper\">\n                                    <button className={\"btn btn-big btn-primary\"}\n                                            onClick={() => this.props.onClickNextBtn()}\n                                            disabled={false}\n                                            title={t('Next')}\n                                            type=\"button\" >\n                                        <Icon>arrow_forward</Icon> {t('Next')}\n                                    </button>\n                                </div>\n\n                                <div className=\"_fabwrapper\">\n                                    <button className={\"btn btn-big btn-primary\"}\n                                            onClick={this.backPressed.bind(this)}\n                                            disabled={false}\n                                            title={t('Previous')}\n                                            type=\"button\" >\n                                        <Icon>arrow_back</Icon> {t('Previous')}\n                                    </button>\n                                </div>\n\n                                <div className=\"_fabwrapper\">\n                                    <button className=\"btn btn-light mr-2\"\n                                            onClick={this.repeatColors.bind(this)}\n                                            disabled={!this.getColorsToRepeat()}\n                                            title={t('repeat color settings')}\n                                            type=\"button\" >\n                                        <Icon>compare</Icon>\n                                    </button>\n\n                                    <button className=\"btn btn-light mr-2\"\n                                            onClick={this.clickUndo.bind(this)}\n                                            disabled={!this.checkUndo()}\n                                            title={t('Undo')}\n                                            type=\"button\" >\n                                        <Icon>undo</Icon>\n                                    </button>\n\n                                    <button className=\"btn btn-light mr-2\"\n                                            onClick={this.clickRedo.bind(this)}\n                                            disabled={!this.checkRedo()}\n                                            title={t('Redo')}\n                                            type=\"button\" >\n                                        <Icon>redo</Icon>\n                                    </button>\n                                </div>\n\n                                <div className=\"app-main-rightwidget-tablewrp\">\n\n                                        {formatsList}\n\n                                    <Fab color=\"primary\" className=\"app-main-change-formats-button position-absolute text-primary bg-light\"\n                                         style={{right: '0', bottom: '100%' }}\n                                         onClick={()=>{this.openFormatsPanel()}}\n                                         aria-label=\"Colors\">\n                                        <Icon>menu</Icon>\n                                    </Fab>\n\n                                    <table className=\"table\">\n                                        <tbody>\n\n                                        <tr>\n                                            <th scope=\"row\" colSpan={2}>\n                                                {t('Format')} {format.name}\n                                            </th>\n                                        </tr>\n                                        <tr>\n                                            <th scope=\"row\" colSpan={2}>\n                                                {format.height}\"x {format.width}\" {Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}\n                                            </th>\n                                        </tr>\n\n                                        <tr>\n                                            <th scope=\"row\">{t('Files')}</th>\n                                            <th scope=\"row\">{this.props.app.images.length} / {this.state.imagesCount}</th>\n                                        </tr>\n                                        <tr>\n                                            <th scope=\"row\">{t('Cost')}</th>\n                                            <th scope=\"row\">{tools.Round(this.state.imagesSum)}</th>\n                                        </tr>\n                                        </tbody>\n                                    </table>\n\n                                </div>\n\n                            </Paper>\n\n                        </div>\n\n                    </div>\n\n                </div>\n\n                <Paper className=\"app-bottomframe h-25 p-2 position-relative app-bg-e\">\n                    <div className=\"app-bottom-thumblist-button\">\n                        <button type=\"button\"\n                                className={\"btn btn-primary\"}\n                                disabled={this.props.app.currentImage===0}\n                                onClick={()=>{this.changeCurrentImage(-1)}}>\n                            <Icon>navigate_before</Icon>\n                        </button>\n                    </div>\n                    <div className=\"scrollbar _horizontal h-100 w-100\">\n\n                        <div id='listImages' className=\"app-bottom-thumblist h-100 p-2\">\n                            {this.props.app.images.map( (image, index)=>\n                                <ImageThumb\n                                    key={index}\n                                    image={image}\n                                    itemIndex={index}\n                                    selected={this.props.app.currentImage===index}\n                                    onSelect={()=>this.selectImage(index)}\n                                    scrollIntoView={this.scrollIntoViewIfNeed}\n                                    {...this.props}\n                                />\n                            )}\n\n                        </div>\n\n                    </div>\n\n                    <div className=\"app-bottom-thumblist-button\">\n                        <button type=\"button\"\n                                className={\"btn btn-primary\"}\n                                disabled={this.props.app.currentImage===this.props.app.images.length-1}\n                                onClick={()=>{this.changeCurrentImage(1)}}>\n                            <Icon>navigate_next</Icon>\n                        </button>\n                    </div>\n                </Paper>\n\n                <Dialog\n                    open={this.state.confirmBack}\n                    onClose={()=>this.backConfirmed(false)}\n                    aria-labelledby=\"alert-dialog-title\"\n                    aria-describedby=\"alert-dialog-description\"\n                >\n                    <DialogTitle id=\"alert-dialog-title\">{t(\"Warning\")}</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText id=\"alert-dialog-description\">\n                            {t('Current state of editor images will be lost.')} {t('Are you sure?')}\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <button onClick={()=>this.backConfirmed(true)} className={\"btn btn-big btn-light\"} autoFocus>\n                            {t('OK')}\n                        </button>\n                        <button onClick={()=>this.backConfirmed(false)} className={\"btn btn-big btn-primary\"}>\n                            {t('Cancel')}\n                        </button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n\n        )\n    }\n}\n\n\n\n\n\n","import React from 'react';\nimport * as tools from \"../../tools\";\nimport axios from \"axios\";\n\nimport './index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\nimport {makeGetUri} from \"../../tools\";\nimport Switch from \"@material-ui/core/Switch\";\nimport Fab from \"@material-ui/core/Fab\";\nimport t from \"../i18n\";\n\n\nexport default class PageSetupFormats extends React.Component {\n\n    state = {\n        editedFormats: null,\n    };\n\n    componentDidMount() {\n        let formats = this.props.app.formats.slice();\n        for(let i=0; i<formats.len; i++) {\n            formats[i].cost = tools.Round(formats[i].cost)\n        }\n        this.setState( {editedFormats: formats} );\n\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n    }\n\n    formatNew = ()=>{\n        let formats = this.state.editedFormats.slice();\n        if(formats.length>0) {\n            formats.push( Object.assign({}, formats[formats.length-1]) );\n        } else {\n            formats.push( {} );\n        }\n        const last = formats.length-1;\n        formats[last].name = 'new format';\n        formats[last].enabled = false;\n\n        this.setState({editedFormats: formats});\n\n    };\n\n    formatRemove = (index) => {\n        let formats = this.state.editedFormats;\n        formats.splice(index,1);\n        this.setState({editedFormats: formats});\n\n    };\n    formatChange = (index, id, ev) => {\n        let formats = this.state.editedFormats;\n        let changed = true;\n        switch (id) {\n            case 'enabled':\n            case 'portrait':\n                formats[index][id] = !formats[index][id];\n                break;\n\n            case 'name':\n            case 'height':\n            case 'width':\n            case 'surface':\n                formats[index][id] = ev.target.value;\n                break;\n\n            case 'dpi':\n                formats[index][id] = tools.Round(ev.target.value,0);\n                break;\n\n            case 'cost':\n                const x = ev.target.value.replace(/,/g,'.');\n                formats[index][id] = x;\n                break;\n\n            default:\n                changed = false;\n\n        }\n        if(changed)\n            this.setState({editedFormats: formats});\n    };\n\n    formatSave() {\n        let formats = this.state.editedFormats.slice();\n        console.log(formats);\n        for(let i=0; i<formats.length; i++) {\n            // console.log(i, formats[i]);\n\n            formats[i].dpi = Math.max(150, Math.min(tools.Round(formats[i].dpi,0), 1500));\n            formats[i].cost = tools.Round(formats[i].cost,2);\n        }\n        let uri = makeGetUri();\n        const params = new URLSearchParams();\n        params.append('q', 'setupFormatSave');\n        params.append('formats', JSON.stringify(formats));\n        params.append('p', this.props.app.isSetupPassword);\n        axios.post(uri, params ).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.props.appSetState({formats: formats}, ()=>{\n                        this.props.onMessage( t('successful saved') );\n                    });\n\n                } else {\n                    this.props.onMessage('error :'+res.data.error);\n                }\n            } else {\n                console.log('axios.post status ', res.status);\n            }\n        });\n    }\n\n    formatMove(index,shift) {\n        let newIndex = index+shift;\n\n        console.log(newIndex);\n        if(newIndex<0 || newIndex>this.state.editedFormats.length-1 ) {\n            return false;\n        }\n        let formats = this.state.editedFormats.slice();\n        let tmp = formats[index];\n        formats[index] = formats[newIndex];\n        formats[newIndex] = tmp;\n        this.setState({editedFormats: formats});\n\n    }\n\n    render() {\n\n        let formats = (this.state.editedFormats ? this.state.editedFormats : []);\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\n                <div className=\"app-setup  h-100\">\n\n\n\n                    <div className=\"app-setup-main h-100\">\n                        <Paper className=\"app-setup-formats scrollbar p-2 h-100\">\n                            <div className=\"app-setup-formats-header\">\n                                <div className=\"_wrp _wrp_enabled\"><small>On</small></div>\n                                <div className=\"_wrp _wrp_name\"><small>{t('Name')}</small></div>\n                                <div className=\"_wrp _wrp_dpi\"><small>DPI</small></div>\n                                <div className=\"_wrp _wrp_height\"><small>{t('Height')}</small></div>\n                                <div className=\"_wrp _wrp_width\"><small>{t('Width')}</small></div>\n                                <div className=\"_wrp _wrp_surface\"><small>{t('Surface')}</small></div>\n                                <div className=\"_wrp _wrp_cost\"><small>{t('Cost')}</small></div>\n                                <div className=\"_wrp _wrp_portrait\"><small>{t('Portrait')}</small></div>\n                                <div className=\"_wrp _wrp_movecontrol\"> </div>\n                            </div>\n\n                            {formats.map((format, index)=>\n                                <div key={index} className={\"app-setup-format-item\"+(format.enabled ? '' : ' _disabled' )}>\n                                    <div className=\"_wrp _wrp_enabled\">\n                                        <Switch\n                                            checked={format.enabled}\n                                            onChange={(ev) => this.formatChange(index,'enabled', ev)}\n                                            value={'enabled'}\n                                            color=\"primary\"\n                                        />\n\n                                    </div>\n                                    <div className=\"_wrp _wrp_name\">\n                                        <input type=\"text\" value={format.name} onChange={(ev) => this.formatChange(index,'name', ev)}/>\n                                    </div>\n                                    <div className=\"_wrp _wrp_dpi\">\n                                        <input type=\"text\" value={format.dpi} onChange={(ev) => this.formatChange(index,'dpi', ev)}/>\n                                    </div>\n                                    <div className=\"_wrp _wrp_height\">\n                                        <select value={format.height} data-hint={format.height} onChange={(ev) => this.formatChange(index,'height', ev)}>\n                                            {[2.5, 3.5, 4, 4.5, 5, 6, 8, 10, 11, 12].map((h, i)=>\n                                                <option key={i} value={h}>{h}\" ({Math.round(h*25.4)})</option>\n                                            )}\n                                        </select>\n\n                                    </div>\n                                    <div className=\"_wrp _wrp_width\">\n                                        <select value={format.width} onChange={(ev) => this.formatChange(index,'width', ev)}>\n                                            {[3.5, 5, 6, 7, 8, 10, 12, 14, 15, 16, 17, 18].map((h, i)=>\n                                                <option key={i} value={h}>{h}\" ({Math.round(h*25.4)})</option>\n                                            )}\n                                        </select>\n                                    </div>\n                                    <div className=\"_wrp _wrp_surface\">\n                                        <select value={format.surface} onChange={(ev) => this.formatChange(index,'surface', ev)}>\n                                            {['glance', 'matte'].map((h, i)=>\n                                                <option key={i} value={h}>{t(h)}</option>\n                                            )}\n                                        </select>\n                                    </div>\n                                    <div className=\"_wrp _wrp_cost\">\n                                        <input type=\"text\" value={format.cost} onChange={(ev) => this.formatChange(index,'cost', ev)}/>\n                                    </div>\n                                    <div className=\"_wrp _wrp_portrait\">\n                                        <Switch\n                                            checked={format.portrait}\n                                            onChange={(ev) => this.formatChange(index,'portrait', ev)}\n                                            value={'portrait'}\n                                            color=\"primary\"\n                                        />\n                                    </div>\n\n                                    {format.enabled && (\n                                        <div className=\"_wrp _wrp_movecontrol\">\n                                            <div>\n                                                <Icon className=\"text-primary\"\n                                                      onClick={()=>{this.formatMove(index,-1)}}\n                                                >arrow_upward</Icon>\n                                            </div>\n                                            <div>\n                                                <Icon className=\"text-primary\"\n                                                      onClick={()=>{this.formatMove(index,1)}}\n                                                >arrow_downward</Icon>\n                                            </div>\n                                        </div>\n                                    )}\n                                    {!format.enabled && (\n                                        <div className=\"_wrp _wrp_movecontrol\">\n                                            <Fab className={\"app-setup-format-item-remove\"}\n                                                 onClick={() => this.formatRemove(index)}\n                                                 color=\"secondary\" aria-label=\"Remove\"\n                                                 size=\"small\">\n                                                <Icon>delete</Icon>\n                                            </Fab>\n                                        </div>\n\n                                    )}\n\n\n\n\n                                    <hr/>\n                                </div>\n                            )\n                            }\n                            <div className=\"app-setup-format-new\">\n                                <button className={\"btn btn-primary\"}\n                                        onClick={this.formatNew}\n                                        disabled={false}\n                                        title=\"newFormat\"\n                                        type=\"button\" >\n                                    <Icon>add</Icon>\n                                </button>\n                                <span className=\"float-right\">\n                                    <button className={\"btn btn-success \"}\n                                            onClick={this.formatSave.bind(this)}\n                                            disabled={false}\n                                            title=\"Save\"\n                                            type=\"button\" >\n                                        <Icon>save</Icon>\n                                    </button>\n\n                                </span>\n                            </div>\n\n                        </Paper>\n                    </div>\n\n\n                </div>\n            </div>\n        )\n    }\n}\n\n","import React from 'react';\nimport axios from \"axios\";\nimport * as tools from \"../../tools\";\n\n\nimport './index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\nimport t from \"../i18n\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\n\n\nexport default class PageSetupArchive extends React.Component {\n\n    state = {\n        arhives: [],\n        currentArchive: null,\n        isLoading: false,\n        archiveFiles: [],\n        currentArchiveFile: null,\n        isMultipleSelectOrders: false,\n        isDeleteConfirmation: 0,\n    };\n\n\n    componentDidMount() {\n        this.loadList();\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n    }\n\n    loadList() {\n        if(this.state.isLoading) return;\n\n        let uri = tools.makeGetUri({'q':'loadArchives', 'p': this.props.app.isSetupPassword});\n        this.setState({arhives:[], currentArchive:null, archiveFiles:[], isLoading:true});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        let arhives = res.data.data.map((d)=>{return {folder:d, selected:false}});\n                        this.setState({arhives: arhives});\n                    }\n                }\n            }\n            this.setState({isLoading: false});\n        });\n\n    }\n\n    tryDeleteArchive() {\n        let archCount = 0;\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\n        if (isMultipleSelectOrders) {\n            let as = this.state.arhives.filter((a)=>{return a.selected});\n            console.log(as);\n            archCount = as.length;\n        }\n        if(archCount>0)\n            this.setState({isDeleteConfirmation: archCount});\n    }\n    deleteArchive() {\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\n        if (isMultipleSelectOrders) {\n            let len = this.state.arhives.length;\n            for( let i=0; i<len; i++) {\n                if(this.state.arhives[i].selected)\n                    this._remove(this.state.arhives[i].folder);\n            }\n        }\n\n        this.setState({isDeleteConfirmation:0, isMultipleSelectOrders:false, currentArchive:null, archiveFiles:[]});\n    }\n    _remove(folder) {\n        let uri = tools.makeGetUri({'q':'removeArchive', folder: folder, 'p': this.props.app.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.loadList();\n                }\n            }\n        });\n    }\n\n    toggleMultiple() {\n        const isMultipleSelectOrders = !this.state.isMultipleSelectOrders;\n        if (!isMultipleSelectOrders) {\n            let arhives = this.state.arhives.slice();\n            let len = arhives.length;\n            for( let i=0; i<len; i++) {\n                arhives[i].selected = false;\n            }\n            this.setState({arhives: arhives, isMultipleSelectOrders: isMultipleSelectOrders});\n        } else {\n            this.setState({isMultipleSelectOrders: isMultipleSelectOrders});\n        }\n    }\n\n    selectArchive(index) {\n        if(this.state.isMultipleSelectOrders) {\n            let arhives = this.state.arhives.slice();\n            arhives[index].selected = !arhives[index].selected;\n            this.setState({arhives: arhives, currentArchive: index});\n        } else {\n            this.setState({currentArchive: index});\n        }\n        if(index===this.state.currentArchive) return;\n\n        let uri = tools.makeGetUri({'q':'loadArchive', folder: this.state.arhives[index].folder, 'p': this.props.app.isSetupPassword});\n        this.setState({archiveFiles: [], isLoading: true});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        this.setState({archiveFiles: res.data.data});\n                    }\n                }\n            }\n            this.setState({isLoading: false, currentArchiveFile: null});\n        });\n    }\n\n    selectFile(index) {\n        this.setState({currentArchiveFile: index});\n    }\n\n    render() {\n        let archiveCount = 0;\n        let archiveTotal = 0;\n        let archiveDate = '';\n        let len = this.state.archiveFiles.length;\n        for(let i=0; i<len; i++) {\n            archiveCount += this.state.archiveFiles[i].count;\n            archiveTotal += this.state.archiveFiles[i].format.cost * this.state.archiveFiles[i].count;\n            archiveDate = this.state.archiveFiles[i].date+' '+this.state.archiveFiles[i].time;\n        }\n\n        let archiveFile = null;\n        if(this.state.currentArchiveFile>=0 && this.state.archiveFiles[this.state.currentArchiveFile]) {\n            archiveFile = this.state.archiveFiles[this.state.currentArchiveFile];\n            // console.log(archiveFile);\n        }\n\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\n        let selectedArchiveCount = 0;\n        if (isMultipleSelectOrders) {\n            let as = this.state.arhives.filter((a)=>{return a.selected});\n            console.log(as);\n            selectedArchiveCount = as.length;\n        }\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\n                <div className=\"app-setup  h-100\">\n\n\n\n                    <div className=\"app-setup-main h-100\">\n                        <Paper className=\"app-setup-arhives p-2 h-100 w-100 d-flex flex-column\">\n                            <div className=\"_listswrp flex-grow-1 h-75\">\n                                <div className=\"h-100 d-flex flex-row\">\n                                    <div className=\"app-setup-archives-list scrollbar flex-grow-0 border position-relative\">\n                                        {(this.state.isLoading) && (\n                                            <div className = \"spinner-border text-primary position-absolute\" role = \"status\" >\n                                                <span className = \"sr-only\" > Loading...</span>\n                                            </div>\n                                        )}\n\n                                        {this.state.arhives.map((a, i)=>\n                                        <div key={i} className={\"_item\"+(i===this.state.currentArchive ? ' bg-primary text-light' : ' bg-light')}\n                                             onClick={()=>{this.selectArchive(i)}}\n                                        >\n\n                                            {isMultipleSelectOrders && (\n                                                <Icon fontSize={\"inherit\"} className=\"text-success\">{a.selected ? 'check_circle' : 'radio_button_unchecked'}</Icon>\n                                            )}\n                                            {a.folder}\n\n                                        </div>\n                                        ) }\n                                    </div>\n                                    <div className=\"app-setup-archive-files scrollbar flex-grow-0 border position-relative\">\n                                        {(this.state.isLoading) && (\n                                            <div className = \"spinner-border text-primary position-absolute\" role = \"status\" >\n                                                <span className = \"sr-only\" > Loading...</span>\n                                            </div>\n                                        )}\n                                        {this.state.archiveFiles.map((f, i)=>\n                                            <div key={i} className={\"_item\"+(i===this.state.currentArchiveFile ? ' bg-primary text-light' : ' bg-light')}\n                                                 onClick={()=>{this.selectFile(i)}}\n                                            >\n                                                {f.name}\n\n                                            </div>\n                                        ) }\n                                    </div>\n                                    <div className=\"app-setup-archive-fileview flex-grow-1 border h-100\">\n                                        <div className=\"d-flex flex-column h-100\">\n                                            <div className=\"_view-img border bg-light flex-grow-1\"\n                                                 style={{backgroundImage: (archiveFile ? \"url('\"+tools.makeGetUri()+archiveFile.file+\"')\" : '')}}\n                                            > </div>\n                                            <div className=\"_infobottom flex-grow-0\">\n                                                <table className=\"table\">\n                                                    <thead>\n                                                    <tr>\n                                                        <th scope=\"col\" colSpan=\"2\">{t('Format')}</th>\n                                                        <th scope=\"col\">{t('Amount')}</th>\n                                                        <th scope=\"col\">{t('Date')}</th>\n                                                        <th scope=\"col\">{t('Prints')}</th>\n                                                        <th scope=\"col\">{t('Total')}</th>\n                                                    </tr>\n                                                    </thead>\n                                                    <tbody>\n                                                        <tr>\n                                                            <td>{archiveFile ? archiveFile.format.name+' '+archiveFile.format.width+'\"x'+archiveFile.format.height+'\"' : ''}</td>\n                                                            <td>{archiveFile ? Math.round(archiveFile.format.height*25.4)+'x'+Math.round(archiveFile.format.width*25.4)+' , '+t(archiveFile.format.surface) : '' }</td>\n                                                            <td>{archiveFile ? archiveFile.count : ''}</td>\n                                                            <td>{archiveFile ? archiveFile.date+' '+archiveFile.time : archiveDate}</td>\n                                                            <td>{archiveCount}</td>\n                                                            <td>{tools.Round(archiveTotal)}</td>\n                                                        </tr>\n                                                    </tbody>\n                                                </table>\n\n\n                                            </div>\n                                        </div>\n\n                                    </div>\n                                </div>\n                            </div>\n                            <div className=\"_btnswrp flex-grow-0\">\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className={\"btn btn-success btn \"}\n                                            onClick={()=>{this.loadList()}}\n                                            title=\"sample\"\n                                            type=\"button\" >\n                                        <Icon>refresh</Icon>\n                                    </button>\n\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className={\"btn\"+(isMultipleSelectOrders ? ' btn-outline-success':' btn-outline-secondary')}\n                                            onClick={()=>{this.toggleMultiple()}}\n                                            title=\"multiple\"\n                                            type=\"button\" >\n                                        <Icon>filter_none</Icon>\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className={\"btn btn-success btn \"}\n                                            onClick={()=>{this.tryDeleteArchive()}}\n                                            disabled={selectedArchiveCount===0}\n                                            title=\"Delete\"\n                                            type=\"button\" >\n                                        <Icon>delete_forever</Icon>\n                                    </button>\n\n                                </div>\n\n\n                            </div>\n                        </Paper>\n                    </div>\n\n\n                </div>\n\n\n                <Dialog\n                    open={this.state.isDeleteConfirmation>0}\n                    onClose={()=>this.setState({isDeleteConfirmation:0})}\n                    aria-labelledby=\"alert-dialog-title\"\n                    aria-describedby=\"alert-dialog-description\"\n                >\n                    <DialogTitle id=\"alert-dialog-title\">{t(\"Warning\")}</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText id=\"alert-dialog-description\">\n                            {t('You are selected archives to remove:')} <span className=\"text-center text-dark\" style={{fontSize:'1.4em'}}>{this.state.isDeleteConfirmation>0 ? this.state.isDeleteConfirmation : ''}</span>\n                            <br/>\n                            {t('Are you sure?')}\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <button onClick={()=>this.deleteArchive()} className={\"btn btn-big btn-light\"}>\n                            {t('OK')}\n                        </button>\n                        <button onClick={()=>this.setState({isDeleteConfirmation:0})} className={\"btn btn-big btn-primary\"} autoFocus>\n                            {t('Cancel')}\n                        </button>\n                    </DialogActions>\n                </Dialog>\n\n            </div>\n        )\n    }\n}\n\n","import React from 'react';\nimport * as tools from \"../../tools\";\nimport axios from \"axios\";\n\nimport './index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\nimport {makeGetUri} from \"../../tools\";\nimport Switch from \"@material-ui/core/Switch\";\nimport Fab from \"@material-ui/core/Fab\";\nimport t from \"../i18n\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\n\n\nexport default class PageSetupSources extends React.Component {\n\n    state = {\n        editedSources: this.props.app.sources.slice(),\n        listIcons: [],\n        listScripts: [],\n        scriptTxt: false,\n\n    };\n\n    componentDidMount() {\n        if(!this.state.editedSources) {\n            this.setState({\n                editedSources: this.props.app.sources.slice()\n            });\n        }\n\n        let uri = tools.makeGetUri({'q':'setupSourcesListIcons', 'p': this.props.app.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        this.setState({listIcons: res.data.data});\n                    }\n                }\n            }\n        });\n\n        uri = tools.makeGetUri({'q':'setupSourcesListScripts', 'p': this.props.app.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        this.setState({listScripts: res.data.data});\n                    }\n                }\n            }\n        });\n    }\n\n    viewScript(name) {\n        let scriptTxt = false;\n        let len = this.state.listScripts.length;\n        for(let i=0; i<len; i++) {\n            console.log(this.state.listScripts[i].name, name);\n            if(this.state.listScripts[i].name === name) {\n                console.log('gotcha');\n                scriptTxt = this.state.listScripts[i].script;\n                break;\n            }\n        }\n        this.setState({scriptTxt: scriptTxt});\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n    }\n\n    sourceNew = ()=>{\n        let sources = this.state.editedSources.slice();\n        sources.push( Object.assign({}, sources[0]) );\n        const last = sources.length-1;\n        sources[last].name = 'new source';\n        sources[last].enabled = false;\n\n        this.setState({editedSources: sources});\n\n    };\n\n    sourceRemove = (index) => {\n        let sources = this.state.editedSources;\n        sources.splice(index,1);\n        this.setState({editedSources: sources});\n\n    };\n    sourceChange = (index, id, ev) => {\n        let sources = this.state.editedSources;\n        let changed = true;\n        switch (id) {\n            case 'enabled':\n            case 'emptyhide':\n            case 'autoclear':\n                sources[index][id] = !sources[index][id];\n                break;\n\n            case 'name':\n            case 'path':\n            case 'icon':\n            case 'scripton':\n            case 'scriptoff':\n                sources[index][id] = ev.target.value;\n                break;\n\n            default:\n                changed = false;\n\n        }\n        if(changed)\n            this.setState({editedSources: sources});\n    };\n\n    sourcesSave() {\n        let sources = this.state.editedSources;\n        // for(let i=0; i<sources.length; i++) {\n        //     console.log(i, sources[i]);\n        // }\n        let uri = makeGetUri();\n        const params = new URLSearchParams();\n        params.append('q', 'setupSourcesSave');\n        params.append('sources', JSON.stringify(sources));\n        params.append('p', this.props.app.isSetupPassword);\n        axios.post(uri, params ).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.props.appSetState({sources: sources}, ()=>{\n                        this.props.onMessage( t('successful saved') );\n                    });\n\n                } else {\n                    this.props.onMessage('error :'+res.data.error);\n                }\n            } else {\n                console.log('axios.post status ', res.status);\n            }\n        });\n    }\n\n    sourceMove(index,shift) {\n        let newIndex = index+shift;\n\n        console.log(newIndex);\n        if(newIndex<0 || newIndex>this.state.editedSources.length-1 ) {\n            return false;\n        }\n        let sources = this.state.editedSources.slice();\n        let tmp = sources[index];\n        sources[index] = sources[newIndex];\n        sources[newIndex] = tmp;\n        this.setState({editedSources: sources});\n\n    }\n\n    render() {\n\n        let sources = (this.state.editedSources ? this.state.editedSources : []);\n        let listIcons = this.state.listIcons;\n        let listScripts = this.state.listScripts;\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\n                <div className=\"app-setup  h-100\">\n\n\n\n                    <div className=\"app-setup-main h-100\">\n                        <Paper className=\"app-setup-sources scrollbar p-2 h-100\">\n                            <div className=\"app-setup-sources-header\">\n                                <div className=\"_wrp _wrp_enabled\"><small>On</small></div>\n                                <div className=\"_wrp _wrp_name\"><small>{t('Name')}</small></div>\n                                <div className=\"_wrp _wrp_icondisplay\"> </div>\n                                <div className=\"_wrp _wrp_path\"><small>{t('Path')}</small></div>\n                                <div className=\"_wrp _wrp_scripton\"><small>{t('Script ON / OFF')}</small></div>\n                                <div className=\"_wrp _wrp_emptyhide\"><small>{t('Emptyhide')}</small></div>\n                                <div className=\"_wrp _wrp_autoclear\"><small>{t('Autoclear')}</small></div>\n                                <div className=\"_wrp _wrp_movecontrol\"> </div>\n                            </div>\n\n                            {sources.map((source, index)=>\n                                <div key={index} className={\"app-setup-source-item\"+(source.enabled ? '' : ' _disabled' )}>\n                                    <div className=\"_wrp _wrp_enabled\">\n                                        <Switch\n                                            checked={source.enabled}\n                                            onChange={(ev) => this.sourceChange(index,'enabled', ev)}\n                                            value={'enabled'}\n                                            color=\"primary\"\n                                        />\n\n                                    </div>\n                                    <div className=\"_wrp _wrp_name\">\n                                        <div>\n                                            <input type=\"text\" value={source.name} onChange={(ev) => this.sourceChange(index,'name', ev)} className=\"w-100\"/>\n                                        </div>\n                                        <div>\n                                            <select value={source.icon} data-value={source.icon} onChange={(ev) => this.sourceChange(index,'icon', ev)}  className=\"w-100\">\n                                                {listIcons.map((h, i)=>\n                                                    <option key={i} value={h}>{h.replace(/^.*[\\\\\\/]/, '')}</option>\n                                                )}\n                                            </select>\n\n                                        </div>\n                                    </div>\n                                    <div className=\"_wrp _wrp_icondisplay\"\n                                         style={{backgroundImage: (source.icon ? 'url('+tools.makeGetUri()+source.icon+')' : '')}}\n                                    > </div>\n                                    <div className=\"_wrp _wrp_path\">\n                                        <input type=\"text\" value={source.path} onChange={(ev) => this.sourceChange(index,'path', ev)} className=\"w-100\"/>\n                                    </div>\n                                    <div className=\"_wrp _wrp_scripton\">\n                                        <div>\n                                            <select value={source.scripton} onChange={(ev) => this.sourceChange(index,'scripton', ev)}>\n                                                <option key={'d'} value=''>{t('---')}</option>\n                                                {listScripts.map((h, i)=>\n                                                    <option key={i} value={h.name}>{h.name}</option>\n                                                )}\n                                            </select>\n                                            <Icon onClick={()=>{this.viewScript(source.scripton)}} className=\"text-success\" >description</Icon>\n                                        </div>\n                                        <div>\n                                            <select value={source.scriptoff} onChange={(ev) => this.sourceChange(index,'scriptoff', ev)}>\n                                                <option key={'d'} value=''>{t('---')}</option>\n                                                {listScripts.map((h, i)=>\n                                                    <option key={i} value={h.name}>{h.name}</option>\n                                                )}\n                                            </select>\n                                            <Icon onClick={()=>{this.viewScript(source.scriptoff)}} className=\"text-warning\" >description</Icon>\n\n                                        </div>\n                                    </div>\n\n                                    <div className=\"_wrp _wrp_emptyhide\">\n                                        <Switch\n                                            checked={source.emptyhide}\n                                            onChange={(ev) => this.sourceChange(index,'emptyhide', ev)}\n                                            value={'emptyhide'}\n                                            color=\"primary\"\n                                        />\n                                    </div>\n                                    <div className=\"_wrp _wrp_autoclear\">\n                                        <Switch\n                                            checked={source.autoclear}\n                                            onChange={(ev) => this.sourceChange(index,'autoclear', ev)}\n                                            value={'autoclear'}\n                                            color=\"primary\"\n                                        />\n                                    </div>\n                                    {source.enabled && (\n                                        <div className=\"_wrp _wrp_movecontrol\">\n                                            <div>\n                                                <Icon className=\"text-primary\"\n                                                      onClick={()=>{this.sourceMove(index,-1)}}\n                                                >arrow_upward</Icon>\n                                            </div>\n                                            <div>\n                                                <Icon className=\"text-primary\"\n                                                      onClick={()=>{this.sourceMove(index,1)}}\n                                                >arrow_downward</Icon>\n                                            </div>\n                                        </div>\n                                    )}\n\n                                    {!source.enabled && (\n                                        <div className=\"_wrp _wrp_movecontrol\">\n                                            <Fab className={\"app-setup-format-item-remove\"}\n                                                 onClick={() => this.sourceRemove(index)}\n                                                 color=\"secondary\" aria-label=\"Remove\"\n                                                 size=\"small\">\n                                                <Icon>delete</Icon>\n                                            </Fab>\n                                        </div>\n                                    )}\n\n                                    <hr/>\n                                </div>\n                            )\n                            }\n                            <div className=\"app-setup-format-new\">\n                                <button className={\"btn btn-primary\"}\n                                        onClick={this.sourceNew}\n                                        disabled={false}\n                                        title=\"newFormat\"\n                                        type=\"button\" >\n                                    <Icon>add</Icon>\n                                </button>\n                                <span className=\"float-right\">\n                                    <button className={\"btn btn-success \"}\n                                            onClick={this.sourcesSave.bind(this)}\n                                            disabled={false}\n                                            title=\"Save\"\n                                            type=\"button\" >\n                                        <Icon>save</Icon>\n                                    </button>\n\n                                </span>\n                            </div>\n\n                        </Paper>\n                    </div>\n\n\n                </div>\n\n                <Dialog\n                    open={this.state.scriptTxt}\n                    onClose={()=>this.setState({scriptTxt: null})}\n                    aria-labelledby=\"alert-dialog-title\"\n                    aria-describedby=\"alert-dialog-description\"\n                    maxWidth={false}\n                >\n                    <DialogContent>\n                        <DialogContentText id=\"alert-dialog-description\" className=\"app-setup-view-code-wrapper\">\n                        <textarea className=\"app-setup-view-code\" readOnly>\n                            {this.state.scriptTxt}\n                        </textarea>\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <button onClick={()=>this.setState({scriptTxt: null})} className={\"btn btn-primary\"}>\n                            {t('Close')}\n                        </button>\n                    </DialogActions>\n                </Dialog>\n            </div>\n        )\n    }\n}\n\n","import React from 'react';\nimport * as tools from \"../../tools\";\nimport axios from \"axios\";\n\nimport './index.css';\nimport Paper from '@material-ui/core/Paper';\nimport {makeGetUri} from \"../../tools\";\nimport t from \"../i18n\";\nimport Switch from \"@material-ui/core/Switch\";\n\n\nexport default class PageSetupParameters extends React.Component {\n\n    state = {\n        inputNP: '',\n        inputNP2: '',\n        setup: this.props.app.setup,\n        removeOlder: !(this.props.app.setup.removeArchiveOlder<14 || this.props.app.setup.removeArchiveOlder>5000),\n    };\n\n    savePass() {\n        if(this.state.inputNP!==this.state.inputNP2) {\n            this.props.onMessage(t('New password and his confirm does not match'));\n            this.setState({inputNP:'', inputNP2:''});\n            return;\n        }\n        let uri = tools.makeGetUri({'q':'setupPasswordSave', 'value': this.state.inputNP, 'p':this.props.app.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.props.onMessage(t('New password saved'));\n                    this.setState({inputNP:'', inputNP2:''})\n                    if(this.props.needConfigure) {\n                        document.location.reload();\n                    }\n                } else {\n                    this.props.onMessage(t('error')+res.data.error);\n                    console.log(res.data.error);\n                }\n            }\n        });\n    }\n\n    saveParameters() {\n        let uri = makeGetUri();\n        const params = new URLSearchParams();\n        params.append('q', 'setupParametersSave');\n        let setup = Object.assign(this.state.setup);\n        if(setup.removeArchiveOlder<14 || setup.removeArchiveOlder>5000) {\n            setup.removeArchiveOlder = 0;\n            this.setState( {setup: setup, removeOlder: false} );\n        }\n        params.append('setup', JSON.stringify(setup));\n        params.append('p', this.props.app.isSetupPassword);\n        axios.post(uri, params ).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.props.onMessage(t('Parameters saved'));\n                } else {\n                    this.props.onMessage(t('error')+res.data.error);\n                    console.log(res.data.error);\n                }\n            } else {\n                console.log('axios.post status ', res.status);\n            }\n        });\n\n    }\n\n\n\n\n    inputTyped = (ev , key) => {\n        let state = {};\n        state[key] = ev.target.value;\n        this.setState(state);\n    };\n\n    removeOlderToggle() {\n        this.setState( {removeOlder: !this.state.removeOlder} );\n    }\n\n    setupChange(key, ev) {\n        let setup = Object.assign(this.state.setup);\n        let changed = true;\n        switch (key) {\n\n            case 'processMode':\n            case 'batchSaveMode':\n            case 'copiesMode':\n            case 'printNaming':\n            case 'copiesNaming':\n            case 'removeArchiveOlder':\n\n                setup[key] = ev.target.value;\n                break;\n\n\n            default:\n                changed = false;\n\n        }\n        if(changed)\n            this.setState( {setup: setup} );\n\n    }\n\n    render() {\n\n        let namingOption = [\n            '_4x6_102x152_glance',\n            '_102x152_glance',\n            '_4x6_glance',\n            '_102x152',\n            '_4x6',\n            '_4x6_102x152',\n        ];\n\n        return (\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\n                <div className=\"app-setup  h-100\">\n\n\n\n                    <div className=\"app-setup-main h-100\">\n                        <Paper className=\"app-setup-formats scrollbar p-4 mr-2\">\n                            <div className=\"m-2\">\n                                {this.props.needConfigure &&\n                                <div className=\"text-center text-danger\">\n                                    <strong>{t('You should setup new password!')}</strong>\n                                </div>\n                                }\n                                <form>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"np\">{t('New password')}</label>\n                                        <input id=\"np\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.state.inputNP} onChange={(e)=>this.inputTyped(e,'inputNP')} autoFocus/>\n                                    </div>\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"np2\">{t('Retype password')}</label>\n                                        <input id=\"np2\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.state.inputNP2} onChange={(e)=>this.inputTyped(e,'inputNP2')} />\n                                    </div>\n\n                                    <div className=\"p-2 text-right\">\n                                        <button className={\"btn btn-primary\"}\n                                                onClick={this.savePass.bind(this)}\n                                                disabled={false}\n                                                title=\"save\"\n                                                type=\"button\" >\n                                            {t('Save')}\n                                        </button>\n\n                                    </div>\n                                </form>\n\n                            </div>\n\n                        </Paper>\n                        <Paper className=\"app-setup-formats scrollbar p-4 mr-2\">\n                            <div className=\"m-2\">\n                                <form>\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"processmode\">{t('Process mode')}</label>\n                                        <select  id=\"processmode\" value={this.state.setup.processMode} onChange={(ev) => this.setupChange('processMode', ev)} className={\"form-control\"}>\n                                            <option key={'frontend'} value='frontend'>DOESN'T WORK{t('frontend')}</option>\n                                            <option key={'backend'} value='backend'>{t('backend')} ({t('Recomended')})</option>\n                                        </select>\n                                    </div>\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"batch\">{t('Print mode')}</label>\n                                        <select  id=\"batch\" value={this.state.setup.batchSaveMode} onChange={(ev) => this.setupChange('batchSaveMode', ev)} className={\"form-control\"}>\n                                            <option value='0'>DOESN'T WORK {t('Wait for each file')}</option>\n                                            <option value='1'>{t('Fast batch on backend')} ({t('Recomended')})</option>\n                                        </select>\n                                    </div>\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"copiesMode\">{t('Print copies')}</label>\n                                        <select  id=\"copiesMode\" value={this.state.setup.copiesMode} onChange={(ev) => this.setupChange('copiesMode', ev)} className={\"form-control\"}>\n                                            <option value='1'>{t('Make copy for each file')}</option>\n                                            <option value='0'>{t('Add count to name of file')} ({t('Recomended')})</option>\n                                        </select>\n                                    </div>\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"printNaming\">{t('Print naming')}</label>\n                                        <select  id=\"printNaming\" value={this.state.setup.printNaming} onChange={(ev) => this.setupChange('printNaming', ev)} className={\"form-control\"}>\n                                            {namingOption.map((t,n)=>\n                                                <option key={n} value={n}>{t}</option>\n                                            )}\n                                        </select>\n                                    </div>\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"copiesNaming\">{t('Copies naming')}</label>\n                                        <select  id=\"copiesNaming\" value={this.state.setup.copiesNaming} onChange={(ev) => this.setupChange('copiesNaming', ev)} className={\"form-control\"}>\n                                            <option value='0'>999_copy2{namingOption[this.state.setup.printNaming]}</option>\n                                            <option value='1'>999{namingOption[this.state.setup.printNaming]}_copy2</option>\n                                            <option value='2'>999{namingOption[this.state.setup.printNaming]}_c2</option>\n                                            <option value='3'>999_c2{namingOption[this.state.setup.printNaming]}</option>\n                                        </select>\n                                    </div>\n\n\n                                    <div className=\"form-group\">\n                                        <label htmlFor=\"removeArchiveOlder\">{t('Remove archives, older than days')}</label>\n                                        <Switch\n                                            checked={this.state.removeOlder}\n                                            onChange={(ev) => this.removeOlderToggle()}\n                                            value={'enabled'}\n                                            color=\"primary\"\n                                        />\n                                        <input type=\"text\" value={this.state.setup.removeArchiveOlder} onChange={(ev) => this.setupChange('removeArchiveOlder', ev)}/>\n\n                                    </div>\n\n\n                                    <div className=\"p-2 text-right\">\n                                        <button className={\"btn btn-primary\"}\n                                                onClick={this.saveParameters.bind(this)}\n                                                disabled={false}\n                                                title=\"save\"\n                                                type=\"button\" >\n                                            {t('Save')}\n                                        </button>\n\n                                    </div>\n                                </form>\n\n                            </div>\n                        </Paper>\n                    </div>\n\n\n                </div>\n            </div>\n        )\n    }\n}\n\n","import React from 'react';\n\nimport './index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\nimport t from \"../i18n\";\nimport PageSetupFormats from './PageSetupFormats'\nimport PageSetupArchive from './PageSetupArchive'\nimport PageSetupSources from './PageSetupSources'\nimport PageSetupParameters from './PageSetupParameters'\n\nexport default class PageSetup extends React.Component {\n\n    state = {\n        currentTab: 'archive',\n    };\n\n    componentDidMount() {\n        if(this.props.needConfigure) {\n            this.setState({currentTab: 'parameters'});\n        }\n    }\n\n    openTab = (tab) => {\n        if(tab!== this.state.currentTab)\n            this.setState({currentTab: tab})\n    };\n\n    render() {\n\n        let tab = null;\n        switch (this.state.currentTab) {\n            case 'formats':\n                tab = <PageSetupFormats key={this.state.currentTab} {...this.props}/>;\n                break;\n\n            case 'sources':\n                tab = <PageSetupSources key={this.state.currentTab} {...this.props}/>;\n                break;\n\n            case 'parameters':\n                tab = <PageSetupParameters key={this.state.currentTab} {...this.props}/>;\n                break;\n\n            default:\n                tab = <PageSetupArchive key={this.state.currentTab} {...this.props}/>;\n                break;\n        }\n\n        return (\n            <div className=\"app-page app-bg-e0 app-setup w-100 h-100\">\n                <div className=\"app-setup-wrapper h-100\">\n                    <div className=\"app-setup-main h-85 w-100\">\n                        <div className=\"app-setup-main-tabcontrol w-15 h-100 d-inline-block p-2\">\n                            <Paper className=\"_tab-control w-100 h-100 p-2\">\n                                <div className=\"_menuwrapper\">\n                                    <button className={\"btn \"+(this.state.currentTab==='formats' ? 'btn-primary' : 'btn-outline-primary')}\n                                            onClick={()=>{this.openTab('formats')}}\n                                            type=\"button\" > {t('Formats')}\n                                    </button>\n                                </div>\n                                <div className=\"_menuwrapper\">\n                                    <button className={\"btn \"+(this.state.currentTab==='sources' ? 'btn-primary' : 'btn-outline-primary')}\n                                            onClick={()=>{this.openTab('sources')}}\n                                            type=\"button\" > {t('Sources')}\n                                    </button>\n                                </div>\n                                <div className=\"_menuwrapper\">\n                                    <button className={\"btn \"+(this.state.currentTab==='archive' ? 'btn-primary' : 'btn-outline-primary')}\n                                            onClick={()=>{this.openTab('archive')}}\n                                            type=\"button\" > {t('Archive')}\n                                    </button>\n                                </div>\n                                <div className=\"_menuwrapper\">\n                                    <button className={\"btn \"+(this.state.currentTab==='parameters' ? 'btn-primary' : 'btn-outline-primary')}\n                                            onClick={()=>{this.openTab('parameters')}}\n                                            type=\"button\" > {t('Parameters')}\n                                    </button>\n                                </div>\n                                <hr/>\n                                <div>\n                                    <small>\n                                        <p>{t('You should use Chrome-browser as client with parameters:')}</p>\n                                        <p className=\"text-info\">chrome {window.location.href} --kiosk --disable-extensions --disable-notifications --disable-sync --disable-translate=1</p>\n                                    </small>\n                                </div>\n\n                            </Paper>\n                        </div>\n                        <div className=\"app-setup-main-tab w-85 h-100 d-inline-block p-2\">\n                            {tab}\n                        </div>\n                    </div>\n                    <div className=\"app-setup-bottom h-15 p-2\">\n                            <Paper className=\"app-setup-bottom-buttons text-center h-100 p-2\">\n                                <Paper className=\"float-left h-100 p-2\">\n                                    {this.props.app.appWidth}x{this.props.app.appHeight}\n                                    <div>\n                                        <button className={\"btn btn-light\"}\n                                                onClick={()=>{if(window.confirm(t('Refresh application')+'?')) document.location.reload();}}\n                                                disabled={false}\n                                                title=\"Refresh\"\n                                                type=\"button\" >\n                                            <Icon>update</Icon> {this.props.app.version}\n                                        </button>\n\n                                    </div>\n                                </Paper>\n                                {!this.props.needConfigure &&\n                                    <div className=\"m-2 d-inline-block\">\n                                        <button className={\"btn btn-primary btn-big\"}\n                                                onClick={()=>{this.props.Logout()}}\n                                                disabled={false}\n                                                title=\"Logout\"\n                                                type=\"button\" >\n                                            <Icon>close</Icon>\n                                        </button>\n                                    </div>\n                                }\n\n                            </Paper>\n\n                    </div>\n                </div>\n            </div>\n            )\n    }\n}\n\n","import React from 'react';\nimport * as tools from \"../../tools\";\nimport axios from \"axios\";\nimport t from \"../i18n\";\n\nimport './index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport {makeGetUri} from \"../../tools\";\nimport {calculateImageDimensions} from \"../../tools\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\n\nexport default class PagePrint extends React.Component {\n    state = {\n        orderFolder: null,\n        orderNum: null,\n        savingImages: false,\n        orderPrinted: false,\n    };\n\n    savePartialProgress(start, processed, party, imageslen) {\n        processed /= 2; // increment twice (init + process)\n        let progress = Math.ceil((start+processed)/imageslen*100);\n        let job_done = start+processed >= imageslen;\n        if(job_done) {\n            progress = -1;\n            if(this.props.app.setup.batchSaveMode==='1') {\n                let uri = makeGetUri({'q':'orderFilesProcessBatch', 'folder': this.state.orderFolder});\n                axios.get(uri).then(res => {\n                    if(res.status===200) {\n                        if(res.data.error!=='') {\n                            this.props.onMessage(t('orderFilesProcessBatch error:')+res.data.error);\n                        }\n                    } else {\n                        this.props.onMessage(t('orderFilesProcessBatch error status, let see log'));\n                        console.log(t('orderFilesProcessBatch error status'), res.status);\n                    }\n                });\n            }\n\n            // job done\n        } else {\n            if(processed >= party) {\n                // partial end\n                setTimeout(()=>{ this.saveImage(start+processed); },500);\n                // console.log('partial end', start, processed); job_done = true;\n            }\n        }\n        if(this.props.app.progressBarValue !== progress) {\n            let isPleaseWait = (progress>-1 && progress<99);\n            this.props.appSetState({progressBarValue:progress, isPleaseWait:isPleaseWait, savingImages:!job_done });\n        }\n        if(job_done)\n            this.setState({orderPrinted: true} );\n    }\n\n    checkBeforeSaveImage() {\n        let total = 0;\n        for(let i=0; i<this.props.app.images.length; i++) {\n            total += this.props.app.images[i].count;\n        }\n        if(total) {\n            this.saveImage(0);\n        } else {\n            this.props.onClickNextBtn();\n        }\n    }\n    saveImage = (first) => {\n        let party = 10;\n        let imageslen = this.props.app.images.length;\n        if(first+party>imageslen) {\n            party = imageslen - first;\n        }\n\n        let processed = 0;\n        let orderFolder = '';// '../';\n        if(this.state.orderFolder) {\n            orderFolder = this.state.orderFolder;\n        }\n        this.savePartialProgress(first, processed, party, imageslen);\n        let uri = makeGetUri({'q':'orderGetFolder', 'folder': orderFolder});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        orderFolder = res.data.data;\n                        this.setState({orderFolder: orderFolder, orderNum: res.data.orderNum});\n\n                        let partImages = this.props.app.images.slice(first, first+party);\n                        partImages.forEach( (image, index)=>{\n                            let i = first+index;\n                            processed++; // count init\n                            this.savePartialProgress(first, processed, party, imageslen);\n\n                            // console.log('Process image from:', first, 'index:', index, 'key', i );\n\n                            this.autoInitImage(i, ()=>{\n\n                                let image = this.props.app.images[i];\n                                if(image.count) {\n                                    if(this.props.app.setup.processMode === 'frontend') {\n                                        tools.processImage(this.processCanvasNode, this.props.app, i, (DataURL)=>{\n\n                                            let uri = tools.makeGetUri();\n                                            const params = new URLSearchParams();\n                                            params.append('q', 'orderFileWrite');\n                                            params.append('folder', orderFolder);\n                                            params.append('image', JSON.stringify(image));\n                                            params.append('name', (i+1)+'.'+image.extension);\n                                            params.append('count', image.count);\n                                            params.append('copy', this.props.app.setup.copiesMode ? this.props.app.setup.copiesMode : 1);\n                                            params.append('data', DataURL);\n\n                                            axios.post(uri, params ).then(res => {\n                                                if(res.status===200) {\n                                                    if(res.data.error!=='') {\n                                                        this.props.onMessage('error '+res.data.error);\n                                                    }\n                                                    processed++;\n                                                    // console.log('processed', processed);\n                                                    this.savePartialProgress(first, processed, party, imageslen);\n                                                }\n                                            });\n                                        });\n\n                                    } else { // this.props.app.setup.processMode === backend\n                                        const p = calculateImageDimensions(this.props.app, i);\n\n                                        let uri = tools.makeGetUri();\n                                        const params = new URLSearchParams();\n                                        params.append('q', 'orderFileToProcess');\n                                        if(this.props.app.setup.batchSaveMode==='1') params.append('batch', '1');\n                                        params.append('folder', orderFolder);\n                                        params.append('name', (i+1)+'.'+image.extension);\n                                        params.append('image', JSON.stringify(image));\n                                        params.append('dimensions', JSON.stringify(p));\n                                        params.append('count', image.count);\n                                        params.append('copy', this.props.app.setup.copiesMode ? this.props.app.setup.copiesMode : 1);\n\n                                        axios.post(uri, params ).then(res => {\n                                            if(res.status===200) {\n                                                if(res.data.error!=='') {\n                                                    this.props.onMessage(t('error')+':'+res.data.error);\n                                                }\n                                                processed++;\n                                                // console.log('processed', processed);\n                                                this.savePartialProgress(first, processed, party, imageslen);\n                                            }\n                                        });\n                                    }\n\n                                } else {\n                                    processed++;\n                                    this.savePartialProgress(first, processed, party, imageslen);\n                                }\n                            });\n                        }, this );\n\n                        // for(let i=first; i<first+party; i++) {\n                        //\n                        //     // console.log('image init ', first+i);\n                        //     processed++; // count init\n                        //     this.savePartialProgress(first, processed, party, imageslen);\n                        //\n                        // }//for\n\n                    }\n                } else {\n                    this.props.onMessage(t('error')+':'+res.data.error);\n                }\n            } else {\n                this.props.onMessage(t('error status, let see log'));\n                console.log('error status', res.status);\n            }\n        });\n    };\n\n    autoInitImage = (i, fn_callback) => {\n        let image = this.props.app.images[i];\n\n        this.props.appImageInitMask(i, false, ()=>{\n\n            // console.log(' autoInitImage appImageInitMask', i );\n\n            if(!image.editorState.initedImagePosition) {\n                // console.log('init image '+i);\n                this.props.alignInit(i, fn_callback);\n            } else {\n                if( typeof(fn_callback) === 'function') { fn_callback(); }\n            }\n\n        });\n\n    };\n\n\n\n    render() {\n\n        const formats = this.props.app.formats;\n        const images = this.props.app.images;\n        let temporary = [];\n        let _flen = formats.length;\n        for(let i=0; i<_flen; i++) {\n            const ims = images.filter((image)=>{\n                for (let key in image.format) {\n                    if (formats[i][key] === undefined || formats[i][key] !== image.format[key])\n                        return false;\n                }\n                return true;\n            });\n            temporary.push(ims);\n        }\n        // console.log(temporary);\n\n        let summary = []; //temporary.filter((t,i)=>t.length>0);\n        _flen = temporary.length;\n        let totalSum = 0;\n        for(let i=0; i<_flen; i++) {\n            const tmp = temporary[i];\n            if(tmp.length>0) {\n                let cnt = 0;\n                for(let j=0; j<tmp.length; j++) {\n                    cnt += tmp[j].count;\n                }\n                if(cnt>0) {\n                    summary.push({ format: formats[i], count: cnt, });\n                    totalSum += formats[i].cost * cnt;\n                }\n            }\n        }\n        // console.log(summary);\n\n        return (\n\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\n                <div className=\"app-print h-90 p-2\">\n                    <Paper className=\"h-100 w-100 p-2 app-bg-e text-center\">\n                        <Paper className=\"app-print-costs-paper scrollbar p-2 m-2\">\n                            <table className=\"table\">\n                                <thead>\n                                <tr>\n                                    <th scope=\"col\" colSpan=\"2\">{t('Format')}</th>\n                                    <th scope=\"col\">{t('Amount')}</th>\n                                    <th scope=\"col\">{t('Total')}: {totalSum}</th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                {summary.map((sum, i)=>\n                                    <tr key={i}>\n                                        <td>{sum.format.name} {sum.format.width}\" x{sum.format.height}\"</td>\n                                        <td>{Math.round(sum.format.height*25.4)}x{Math.round(sum.format.width*25.4)} , {t(sum.format.surface)}</td>\n                                        <td>{sum.count}</td>\n                                        <td>{tools.Round(sum.format.cost * sum.count)}</td>\n                                    </tr>\n                                ) }\n                                </tbody>\n                            </table>\n\n                        </Paper>\n                        <div className=\"app-print-costs-buttons text-center\">\n                            <button className={\"btn btn-big btn-primary m-2\"}\n                                    onClick={() => {this.props.onClickPrevBtn()}}\n                                    disabled={false}\n                                    title={t('Previous')}\n                                    type=\"button\" >\n                                <Icon>arrow_back</Icon> {t('Previous')}\n                            </button>\n\n                            <button type=\"button\"\n                                    className={\"btn btn-big btn-success m-2\"}\n                                    disabled={this.state.savingImages}\n                                    onClick={()=>{this.checkBeforeSaveImage()}}>\n                                <Icon>print</Icon> {t('Print')}\n                            </button>\n\n                        </div>\n                    </Paper>\n\n\n                </div>\n\n                <div className=\"app-bottomframe w-100 h-10 p-2 position-relative\">\n                    <Paper className=\"h-100 w-100 p-2 app-bg-e\">\n                        {(this.props.app.progressBarValue>=0 && (\n                            <div className=\"app-bottom-progress h-100 p-2 w-100\">\n                                <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\n                            </div>\n                        ))}\n                    </Paper>\n                </div>\n\n                <Dialog\n                    open={this.state.orderPrinted}\n                    onClose={this.props.onClickNextBtn}\n                    aria-labelledby=\"alert-dialog-title\"\n                    aria-describedby=\"alert-dialog-description\"\n                >\n                    <DialogTitle id=\"alert-dialog-title\">{t('Successful printed')}</DialogTitle>\n                    <DialogContent>\n                        <DialogContentText id=\"alert-dialog-description\">\n                            {t(\"The number of your order is\")}\n                            <span className=\"text-center text-dark\" style={{fontSize:'1.4em', display:'block'}}>{this.state.orderNum}</span>\n                            {t('Dont forget to remove your source.')}\n                            <br/><br/>\n                            {t('Thank you!')}\n                        </DialogContentText>\n                    </DialogContent>\n                    <DialogActions>\n                        <button onClick={this.props.onClickNextBtn} className={\"btn btn-big  btn-primary\"} autoFocus>\n                            OK\n                        </button>\n                    </DialogActions>\n                </Dialog>\n\n            </div>\n        );\n    }\n}\n\n","import React from 'react';\nimport '../index.css';\nimport Icon from \"@material-ui/core/Icon\";\nimport Paper from '@material-ui/core/Paper';\n\nexport default class SetupPin extends React.Component {\n    state = {\n        pwd : '',\n    };\n\n    passTyped = (ev) => {\n        this.setState({pwd: ev.target.value});\n        this.props.appSetState({isSetupPassword: ev.target.value});\n    };\n\n    numbClick(numb) {\n        let pwd = this.state.pwd+''+numb;\n        this.setState({pwd: pwd});\n        this.props.appSetState({isSetupPassword: pwd });\n    };\n\n\n    render() {\n        if (!this.props.app.isSetup || this.props.app.isSetupLogged) return null;\n\n        return (\n            <div className=\"app-page-login p-2 w-100 h-100\">\n                <div className=\"app-login-wrapper-bkg app-bg-e0 app-page-start p-2 w-100 h-100\"> </div>\n\n                <div className=\"app-main app-login-wrapper w-100\">\n                    <Paper className=\"app-login p-2\">\n                        <form onSubmit={(ev)=>{this.setState({pwd: ''}); this.props.Login(ev)}}>\n                            <div className=\"form-group\">\n                                <label htmlFor=\"p\">Pin</label>\n                                <input id=\"p\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.state.pwd} onChange={this.passTyped} autoFocus/>\n                            </div>\n                            <div className=\"numbrow\">\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"7\")}\n                                            type=\"button\" > 7\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"8\")}\n                                            type=\"button\" > 8\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"9\")}\n                                            type=\"button\" > 9\n                                    </button>\n                                </div>\n                            </div>\n\n                            <div className=\"numbrow\">\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"4\")}\n                                            type=\"button\" > 4\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"5\")}\n                                            type=\"button\" > 5\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"6\")}\n                                            type=\"button\" > 6\n                                    </button>\n                                </div>\n                            </div>\n\n                            <div className=\"numbrow\">\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"1\")}\n                                            type=\"button\" > 1\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"2\")}\n                                            type=\"button\" > 2\n                                    </button>\n                                </div>\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"3\")}\n                                            type=\"button\" > 3\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"numbrow\">\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className={\"btn btn-success\"}\n                                            disabled={false}\n                                            title=\"Login\"\n                                            type=\"submit\" >\n                                        <Icon>vpn_key</Icon>\n                                    </button>\n                                </div>\n\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className=\"btn btn-3d\"\n                                            disabled={false}\n                                            onClick={()=>this.numbClick(\"0\")}\n                                            type=\"button\" > 0\n                                    </button>\n                                </div>\n\n                                <div className=\"m-2 d-inline-block\">\n                                    <button className={\"btn \"}\n                                            onClick={()=>{this.setState({pwd: ''});this.props.Logout()}}\n                                            disabled={false}\n                                            title=\"Logout\"\n                                            type=\"button\" >\n                                        <Icon>close</Icon>\n                                    </button>\n                                </div>\n\n                            </div>\n\n                        </form>\n                    </Paper>\n\n                </div>\n\n            </div>\n\n        )\n    }\n}\n\n","import React from 'react';\nimport './splash-screen.css';\nimport t from \"./i18n\";\nimport {getLangs} from \"./i18n\";\nimport {setLang} from \"./i18n\";\nimport '../index.css';\nimport Icon from \"@material-ui/core/Icon\";\n\n\nexport default class LoaderSplashScreen extends React.Component {\n    state = {\n        caseInfinityLoop: false,\n    };\n\n    componentDidMount() {\n        this.tm = setTimeout( ()=>{ this.setState({caseInfinityLoop:true}) }, 179000);\n    }\n    componentWillUnmount() {\n        if(this.tm) clearTimeout(this.tm);\n    }\n\n    langOnLoad(key) {\n        setLang(key);\n        this.setState({caseInfinityLoop:false});\n    }\n\n    render() {\n\n        let langs = getLangs();\n\n        return (\n            <div className=\"splash-screen app-bg-e\">\n                {this.props.serverError || this.state.caseInfinityLoop ?\n                    <div className='text-center'>\n                        <div className=\"splash-screen-text-wrapper error bg-danger text-light pr-5 pl-5\">\n                            {t('Server error:')}\n                            <br/><br/>\n                            {this.props.serverError}\n                        </div>\n                        <div className=\"p-4\">\n                            <button className={\"btn btn-primary btn-big btn-3d\"}\n                                    onClick={()=>{ document.location.reload();}}\n                                    disabled={false}\n                                    title=\"Refresh\"\n                                    type=\"button\" >\n                                <Icon>update</Icon> {t('Restart')}\n                            </button>\n                        </div>\n\n                    </div>\n                    :\n                    <div className=\"splash-screen-text-wrapper\">\n                        {t('Wait a moment while app loading')}\n                        <div className=\"loading-dot\">.</div>\n                    </div>\n                }\n\n                <div className=\"splash-screen-lang-buttons\">\n                    {langs.map( (lang, index)=>\n                        <div key={index} className=\"m-3 d-inline-block\">\n                            <button className=\"btn btn-success btn-3d p-3\"\n                                    onClick={()=>this.langOnLoad(lang.key)}\n                                    disabled={false}\n                                    title=\"Language\"\n                                    type=\"button\" >\n                                <Icon>language</Icon>{lang.caption}\n                            </button>\n\n                        </div>\n                    )}\n\n                </div>\n\n\n            </div>\n        )\n\n    }\n}\n\n","import React from 'react';\nimport './App.css';\nimport {version} from './version.json';\n\nimport {makeGetUri, THEME} from './tools.js';\nimport axios from \"axios\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport PageStart from './Components/PageStart';\nimport PageLoadImages from './Components/PageLoadImages';\nimport PageEditor from './Components/PageEditor';\nimport PageSetup from './Components/PageSetup';\nimport PagePrint from './Components/PagePrint';\nimport SetupPin from './Components/SetupPin.js';\n\nimport LoaderSplashScreen from './Components/LoaderSplashScreen';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport { MuiThemeProvider } from '@material-ui/core/styles';\nimport './assets/iconfont/material-icons.css';\nimport './assets/iconfont/test.css';\n\nimport * as tools from \"./tools\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport t from \"./Components/i18n\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\n\n\n// CANCELED: запрос на відновлення роботи\n\n// DONE: repeat apply contrast & brightness & color from previous photo (and undo)\n\n// TODO: поворот вікна едітора - портрет/ландскейп\n// DONE: при створенні нового формата порожнє поле DPI\n// TODO: printMode 'backend - Wait for each file' broken\n// TODO: перевірити роботу printMode frontent\n// TODO: перегляд виконаної роботи після друку\n\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.updateSavePageTimer = null;\n        this.appWrapperNode = null;\n        this.needConfigure = false;\n    }\n    state = {\n        appstate: 'start',\n        pages: {},\n        sources: [],\n        currentSource: null,\n        formats: [],\n        currentFormat: null,\n        images: [],\n        is_loading_init: false,\n\n        editorHeight: 0,\n        editorWidth: 0,\n\n        // needUpdateCanvas: false,\n\n        snackMessage: null,\n        setup: {\n            batchSaveMode: false\n        },\n\n        isAppStarting: true,\n        isSetup: false,\n        isSetupLogged: false,\n        isSetupPassword: '',\n        isUploadEnable: false,\n        isPleaseWait: false,\n        progressBarValue: -1,\n\n        isDebugShow: false,\n\n        appWidth: null,\n        appHeight: null,\n\n        serverError: null,\n        version: version\n    };\n\n\n    appSetState = (stateToSave, fn_callback)=> {\n        let state = this.state;\n        for (let prop in stateToSave) {\n            state[prop] = stateToSave[prop];\n        }\n        this.setState(state,\n            ()=>{\n                if( typeof(fn_callback) === 'function') fn_callback();\n            });\n    };\n\n    appImageChanged = (index, editorState, fn_callback) => {\n        let image = this.state.images[index];\n        for (let prop in editorState) {\n            image.editorState[prop] = editorState[prop];\n        }\n        let images = this.state.images;\n        images[index] = image;\n        this.setState({\n            images: images,\n        }, ()=>{\n            if( typeof(fn_callback) === 'function') fn_callback();\n        })\n    };\n\n\n    appEditorChanged = (clientWidth,clientHeight) => {\n        // console.log(\"appEditorChanged: \"+this.state.editorWidth+\" === \"+clientWidth+\" && \"+this.state.editorHeight+\" === \"+clientHeight)\n\n        if(this.state.editorWidth === clientWidth && this.state.editorHeight === clientHeight) {\n            return;\n        }\n\n        let images = this.state.images;\n        let len = images.length;\n        for(let i=0; i<len; i++ ) {\n            images[i].editorState.initedMask = false;\n        }\n        this.setState({\n            editorWidth: clientWidth,\n            editorHeight: clientHeight,\n            images: images,\n        }, ()=>{\n            if(this.state.currentImage>=0) {\n                console.log('try reinit');\n                this.appImageInitMask(this.state.currentImage, true);\n            }\n        })\n    };\n\n    appImageInitMask(index, force, fn_callback) {\n\n        let image = this.state.images[index];\n        if(image.editorState.initedMask && !force) {\n            if( typeof(fn_callback) === 'function') fn_callback();\n            return;\n        }\n\n        // console.log(p.stateEditorWidth, p.editorWidth, p.stateEditorHeight, p.editorHeight);\n        let formatRatio = (image.format.height && image.format.width ? image.format.height / image.format.width : 1);\n        // console.log('this ratio : '+ratio);\n        let maskTB = 0;\n        let maskLR = 0;\n\n        let editorRatio = this.state.editorHeight / this.state.editorWidth;\n        // console.log('editorWidth:'+this.state.editorWidth, ' editorHeight:'+this.state.editorHeight);\n        if(formatRatio>editorRatio) {\n            maskLR = (this.state.editorWidth-image.format.width/image.format.height*this.state.editorHeight)/2;\n        } else {\n            maskTB = (this.state.editorHeight-image.format.height/image.format.width*this.state.editorWidth)/2;\n        }\n\n        let newState = {\n            maskTB: maskTB,\n            maskLR: maskLR,\n            ratio: (this.state.editorHeight-maskTB*2)/tools.dpi_inch2dots(image.format.height, image.format.dpi),\n            initedMask: true,\n        };\n        // console.log(newState);\n        // if(!ret) {\n            this.appImageChanged(index, newState, ()=>{\n                if( typeof(fn_callback) === 'function') fn_callback();\n            });\n        // }\n\n        // return newState;\n\n    }\n\n    alignInit = (index, fn_callback)=> {\n        let image = this.state.images[index];\n        let format = image.format;\n        let initrotate = false;\n        let format_lanscape = (format.width-format.height)>1;\n        let image_landscape = (image.width-image.height)>1;\n\n        // console.log('format_lanscape:', format.width,'>', format.height, '=', format_lanscape);\n\n        if(format_lanscape !== image_landscape) {\n            initrotate = true;\n                        // console.log('initrotate', initrotate);\n        }\n\n        if(initrotate) {\n            if(format_lanscape) {\n                this.alignPortrait(index, fn_callback,true, initrotate);\n            } else {\n                this.alignLandscape(index, fn_callback, true, initrotate);\n            }\n        } else {\n            if(format_lanscape) {\n                this.alignLandscape(index, fn_callback, true);\n            } else {\n                this.alignPortrait(index, fn_callback, true);\n            }\n        }\n    };\n\n    alignLandscape = (index, fn_callback, init, initrotate)=> {\n        let image = this.state.images[index];\n                                // console.log('alignLandscape landscape', image.editorState.ratio);\n        let sliderPositionLR = 0;\n        let imageZoom = image.format.width/image.width;\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\n        let viewportY = this.state.editorHeight - image.editorState.maskTB*2;\n        let sliderPositionTB = (viewportY - imgHeight)/2;\n        let isWhiteFields = viewportY > imgHeight;\n                                // console.log('alignLandscape', 'isWhiteFields', isWhiteFields,)\n\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270 || initrotate) {\n            imageZoom = image.format.width/image.height;\n            imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\n            imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\n            sliderPositionTB = (imgWidth-imgHeight)/2 + (viewportY-imgWidth)/2 ;\n            sliderPositionLR = (imgHeight-imgWidth)/2;\n            isWhiteFields = viewportY > imgWidth;\n                                // console.log('alignLandscape', 'isWhiteFields', isWhiteFields,)\n        }\n\n        if(init && isWhiteFields) {\n            this.alignPortrait(index, fn_callback, false, initrotate);\n            return;\n        }\n\n        let editorState = {\n            imageZoom : imageZoom,\n            imageZoomMax: imageZoom*5,\n            imageZoomMin: imageZoom*0.5,\n            sliderPositionTB: sliderPositionTB,\n            sliderPositionLR: sliderPositionLR,\n            imgWidth: imgWidth,\n            imgHeight: imgHeight,\n            initedImagePosition: !(imgWidth===0 && imgHeight===0),\n            needUpdateCanvas: imageZoom>image.editorState.imageZoom,\n        };\n        if(initrotate) editorState['imageRotate']=90;\n\n        this.appImageChanged(index, editorState, fn_callback);\n\n    };\n    alignPortrait = (index, fn_callback, init, initrotate)=> {\n        let image = this.state.images[index];\n                                // console.log('alignPortrait', image.editorState.ratio);\n        let sliderPositionTB = 0;\n        let imageZoom = image.format.height/image.height;\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\n        let viewportX = this.state.editorWidth - image.editorState.maskLR*2;\n        let sliderPositionLR = (viewportX - imgWidth)/2;\n        let isWhiteFields = viewportX > imgWidth;\n                                // console.log('alignPortrait', 'isWhiteFields', isWhiteFields,)\n\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270 || initrotate) {\n            imageZoom = image.format.height/image.width;\n            imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\n            imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\n            sliderPositionLR = (imgHeight-imgWidth)/2 + (viewportX-imgHeight)/2 ;\n            sliderPositionTB = (imgWidth-imgHeight)/2;\n            isWhiteFields = viewportX > imgHeight;\n                                // console.log('alignPortrait', 'isWhiteFields', isWhiteFields,)\n        }\n\n        if(init && isWhiteFields) {\n            this.alignLandscape(index, fn_callback, false, initrotate);\n            return;\n        }\n\n        let editorState = {\n            imageZoom: imageZoom,\n            imageZoomMax: imageZoom*5,\n            imageZoomMin: imageZoom*0.5,\n            sliderPositionTB: sliderPositionTB,\n            sliderPositionLR: sliderPositionLR,\n            imgWidth: imgWidth,\n            imgHeight: imgHeight,\n            initedImagePosition: !(imgWidth===0 && imgHeight===0),\n            needUpdateCanvas: imageZoom>image.editorState.imageZoom,\n        };\n        if(initrotate) editorState['imageRotate']=90;\n\n        this.appImageChanged(index, editorState, fn_callback);\n\n    };\n\n    updateDimensions() {\n        if(this.appWrapperNode) {\n            let appWidth = this.appWrapperNode.clientWidth;\n            let appHeight = this.appWrapperNode.clientHeight;\n            if(this.appWrapperNode.clientWidth > this.appWrapperNode.clientHeight) {\n                // console.log(appWidth,appHeight);\n                this.setState({appWidth: appWidth, appHeight: appHeight});\n            }\n        }\n    }\n\n    checkLoadedState = (state)=> {\n        state.isUploadEnable = false;\n        delete state.version;\n        delete state.appWidth;\n        delete state.appHeight;\n        state.isAppStarting = false;\n        return state;\n    };\n\n    componentWillUnmount() {\n        window.removeEventListener(\"resize\", this.updateDimensions);\n    }\n    componentDidMount() {\n        window.addEventListener(\"resize\", this.updateDimensions);\n\n        // this.updateDimensions();\n\n        let uri = makeGetUri({'q':'init'});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        let state = this.checkLoadedState(res.data.data);\n                        for (let prop in res.data.setup) {\n                            state.setup[prop] = res.data.setup[prop];\n                        }\n                        this.setState(state, ()=>{\n                            this.updateDimensions();\n                            // ---------------------------------------------------\n                            axios.get(makeGetUri({'q':'configure'})).then(res => {\n                                if(res.status===200) {\n                                    if(res.data.error) {\n                                        this.needConfigure = true;\n                                        this.setState({appstate: 'setup'});\n                                    }\n                                }\n                            });\n                            // ---------------------------------------------------\n                        });\n                    }\n                } else {\n                    this.setState({serverError:res.data.error});\n                }\n            } else {\n                this.setState({serverError:'Error: server fail'});\n            }\n        }).catch((error)=>{\n            console.log(error);\n            this.setState({serverError:error.message});\n        });\n    }\n\n    resetApp() {\n        let uri = makeGetUri({'q':'init', 'reset':'reset'});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if(res.data.data) {\n                        let state = this.checkLoadedState(res.data.data);\n                        for (let prop in res.data.setup) {\n                            state.setup[prop] = res.data.setup[prop];\n                        }\n                        this.setState(state, ()=>{ this.updateDimensions(); this.savePages(); });\n                    }\n                }\n            }\n        });\n\n    }\n\n\n\n    onMessage = (msg) => {\n      if(msg) {\n          this.setState({\n              snackMessage: msg\n          })\n      }\n    };\n    onMessageHide = () => {\n        this.setState({\n            snackMessage: null\n        })\n    };\n\n    uploadEnable =(ev)=> {\n        ev.preventDefault();\n\n        let uri = tools.makeGetUri({'q':'login', 'pass': this.state.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.setState({isUploadEnable:true, isSetup:false});\n                } else {\n                    console.log(res.data.error);\n                    this.Logout();\n                }\n            }\n        });\n\n    };\n\n    Login = (ev) => {\n        ev.preventDefault();\n        // ev.stopPropagation();\n        let uri = tools.makeGetUri({'q':'login', 'pass': this.state.isSetupPassword});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    this.setState({isSetupLogged: true,})\n                } else {\n                    console.log(res.data.error);\n                    this.Logout();\n                }\n            }\n        });\n        return false;\n    };\n\n    Logout = () => {\n        this.setState({isSetup : false, isSetupLogged: false, isSetupPassword: '' }, ()=>{this.savePages();});\n\n    };\n\n\n\n    savePages(pageid, pagestate, OKmessage) {\n      let newAppState = this.state;\n\n        if(this.updateSavePageTimer) clearTimeout(this.updateSavePageTimer);\n        this.updateSavePageTimer = setTimeout(()=>{\n            let uri = makeGetUri();\n            const params = new URLSearchParams();\n            params.append('q', 'saveClientState');\n            params.append('state', JSON.stringify(newAppState));\n            axios.post(uri, params ).then(res => {\n                if(res.status===200) {\n                    if(res.data.error==='') {\n                        if(OKmessage) this.onMessage(OKmessage);\n                        // console.log('state saved, '+this.state.appstate);\n                    }\n                }\n            });\n        }, 1700);\n    }\n\n\n    sourceClick(id) {\n      //console.log(id);\n        const source = this.state.sources[id];\n        if(!source.enabled) return;\n\n        if(!source.emptyhide || (source.emptyhide && source.hasFiles))\n            this.setState({currentSource: id})\n    }\n\n    formatClick(id) {\n        //console.log(id);\n        this.setState({currentFormat: id})\n    }\n\n    removeTmp( fn_callback ){\n        let uri = makeGetUri({'q':'removetmp'});\n        axios.get(uri).then(res => {\n            if(res.status===200) {\n                if(res.data.error==='') {\n                    if( typeof(fn_callback) === 'function') fn_callback();\n                }\n            }\n        });\n    }\n\n    scriptSource = (source, s_key) => {\n        // let s_key = 'scripton';\n        if(source[s_key] && source[s_key]!=='') {\n            let uri = makeGetUri({'q':'scriptSource', 'scripts':source[s_key]});\n            axios.get(uri);\n        }\n    };\n\n    autoclearSource = (source_id) => {\n        if(this.state.sources[source_id].autoclear) {\n            let uri = makeGetUri({'q':'autoclearSource','id':source_id} );\n            axios.get(uri);\n        }\n    };\n\n    ClickNextBtn(args) {\n      switch (this.state.appstate) {\n          case 'start':\n              this.scriptSource(this.state.sources[this.state.currentSource], 'scripton');\n              this.removeTmp(()=>{ this.setState({appstate: 'loadImages'}) });\n              break; // ---------------------------------------------------------------------------------\n\n          case 'loadImages':\n              this.scriptSource(this.state.sources[this.state.currentSource], 'scriptoff');\n              this.setState({appstate:'editor', images:args, currentImage:null, isPleaseWait:false });\n              break; // ---------------------------------------------------------------------------------\n\n          case 'editor':\n              this.setState({appstate:'print' }, ()=>{this.savePages()});\n              break; // ---------------------------------------------------------------------------------\n\n          case 'print':\n              this.autoclearSource(this.state.currentSource);\n              this.resetApp();\n              break; // ---------------------------------------------------------------------------------\n\n          default:\n              alert('no action');\n              break;\n      }\n    }\n\n    ClickPrevBtn() {\n        switch (this.state.appstate) {\n            case 'loadImages':\n                this.autoclearSource(this.state.currentSource);\n                this.resetApp();\n                break; // ---------------------------------------------------------------------------------\n\n            case 'editor':\n                this.scriptSource(this.state.sources[this.state.currentSource], 'scripton');\n                this.setState({appstate: 'loadImages'});\n                break; // ---------------------------------------------------------------------------------\n\n            case 'print':\n                this.setState({appstate: 'editor'});\n                break; // ---------------------------------------------------------------------------------\n\n            default:\n                alert('no action');\n\n        }\n    }\n\n    render() {\n\n        let wrongOrientation = (!this.state.serverError && this.appWrapperNode && this.appWrapperNode.clientHeight > this.appWrapperNode.clientWidth) ? true: false;\n\n        let toRenderd = <div> </div>;\n        let appstate = this.state.appstate;\n        if(this.state.isSetupLogged) {\n            appstate = 'setup';\n        }\n\n        if(this.state.isAppStarting || wrongOrientation) {\n            toRenderd = <LoaderSplashScreen serverError={this.state.serverError} />;\n        } else {\n            switch (appstate) {\n                case 'setup':\n                    toRenderd =  (\n                        <PageSetup\n                            app={this.state}\n                            onMessage={this.onMessage}\n                            appSetState = {this.appSetState.bind(this)}\n                            Logout = {this.Logout.bind(this)}\n                            savePages={this.savePages.bind(this)}\n                            needConfigure={this.needConfigure}\n                />\n                    );\n                    break;\n                case 'start':\n                    toRenderd =  (\n                        <PageStart\n                            app={this.state}\n                            onMessage={this.onMessage}\n                            onClickSource={(id) => this.sourceClick(id)}\n                            onClickFormat={(id) => this.formatClick(id)}\n                            onClickNextBtn={() => this.ClickNextBtn()}\n                            savePages={this.savePages.bind(this)}\n                            appSetState = {this.appSetState.bind(this)}\n                        />\n                    );\n                    break;\n\n                case 'loadImages':\n                    toRenderd =  (\n                        <PageLoadImages\n                            app={this.state}\n                            onMessage={this.onMessage}\n                            onClickNextBtn={(this.ClickNextBtn.bind(this))}\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\n                            savePages={this.savePages.bind(this)}\n                            appSetState = {this.appSetState.bind(this)}\n                        />\n                    );\n                    break;\n\n                case 'editor':\n                    toRenderd =  (\n                        <PageEditor\n                            app={this.state}\n                            onMessage={this.onMessage}\n                            onClickNextBtn={() => this.ClickNextBtn()}\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\n                            savePages={this.savePages.bind(this)}\n\n                            appSetState = {this.appSetState.bind(this)}\n                            appImageInitMask = {this.appImageInitMask.bind(this)}\n                            appEditorChanged = {this.appEditorChanged.bind(this)}\n                            appImageChanged = {this.appImageChanged.bind(this)}\n                            alignInit = {this.alignInit.bind(this)}\n                            alignLandscape = {this.alignLandscape.bind(this)}\n                            alignPortrait = {this.alignPortrait.bind(this)}\n\n\n\n                        />\n                    );\n                    break;\n\n                case 'print':\n                    toRenderd =  (\n                        <PagePrint\n                            app={this.state}\n                            onMessage={this.onMessage}\n                            onClickNextBtn={(this.ClickNextBtn.bind(this))}\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\n                            savePages={this.savePages.bind(this)}\n                            appSetState = {this.appSetState.bind(this)}\n                            alignInit = {this.alignInit.bind(this)}\n                            alignLandscape = {this.alignLandscape.bind(this)}\n                            alignPortrait = {this.alignPortrait.bind(this)}\n                            appImageInitMask = {this.appImageInitMask.bind(this)}\n                        />\n                    );\n                    break;\n\n                default:\n                    toRenderd = (\n                        <div className=\"App\">\n                            Learn React\n                        </div>\n                    );\n            }\n\n        }\n\n\n        let appWidth = this.state.appWidth ? this.state.appWidth : '100%';\n        let appHeight = this.state.appHeight ? this.state.appHeight : '100%';\n        return (\n            <div ref={(node)=>{this.appWrapperNode=node}}\n                style={{width:appWidth, height:appHeight}}\n                className={\"app-wrapper\"}>\n                <CssBaseline />\n                <MuiThemeProvider theme={THEME}>\n                    <SetupPin app={this.state}\n                              appSetState = {this.appSetState.bind(this)}\n                              Login = { this.state.isSetup === 1 ? this.Login.bind(this) :\n                                        this.state.isSetup === 2 ? this.uploadEnable.bind(this) :\n                                        this.Login.bind(this)\n                              }\n                              Logout = {this.Logout.bind(this)}\n                    />\n                    {toRenderd}\n                    <Snackbar\n                        anchorOrigin={{ vertical: 'bottom', horizontal: 'left', }}\n                        autoHideDuration={6000}\n                        open={(this.state.snackMessage!==null)}\n                        onClose={this.onMessageHide}\n                        ContentProps={{\n                            'aria-describedby': 'message-id',\n                        }}\n                        message={<span id=\"message-id\">{this.state.snackMessage}</span>}\n                        action={[\n                            <IconButton\n                                key=\"close\"\n                                aria-label=\"Close\"\n                                color=\"inherit\"\n                                className={'classes.close'}\n                                onClick={this.onMessageHide}\n                            >\n                                <CloseIcon />\n                            </IconButton>\n                        ]}\n                    />\n\n                    {this.state.isPleaseWait && (\n                        <div className=\"app-please-wait-wrp position-fixed\">\n                            <div onClick={()=>{this.setState({isPleaseWait:false})}} className = \"app-please-wait spinner-border text-primary\" role = \"status\" >\n                                <span className = \"sr-only\" > Loading...</span>\n                            </div>\n                        </div>\n                    )}\n\n                    <Dialog\n                        open={wrongOrientation}\n                        onClose={()=>{this.updateDimensions()}}\n                        aria-labelledby=\"alert-dialog-title\"\n                        aria-describedby=\"alert-dialog-description\"\n                    >\n                        <DialogTitle id=\"alert-dialog-title\">{t('Wrong orientation')}</DialogTitle>\n                        <DialogContent>\n                            <DialogContentText id=\"alert-dialog-description\">\n                                {t(\"Please, turn your device to lanscape\")}\n                            </DialogContentText>\n                        </DialogContent>\n                        <DialogActions>\n                            <button onClick={()=>{this.updateDimensions()}} className={\"btn btn-big  btn-primary\"} autoFocus>\n                                OK\n                            </button>\n                        </DialogActions>\n                    </Dialog>\n\n\n                </MuiThemeProvider>\n\n            </div>\n        )\n\n    }\n\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import 'bootstrap/dist/css/bootstrap.css';\nimport './index.css';\n\nimport App from './App';\n\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}