(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e){e.exports={a:"1.2.15"}},109:function(e,t,a){e.exports=a(273)},114:function(e,t,a){},193:function(e,t,a){},200:function(e,t,a){},216:function(e,t,a){},252:function(e,t,a){},253:function(e,t,a){},254:function(e,t,a){},255:function(e,t,a){},273:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(28),s=a.n(i),o=(a(57),a(5)),l=a(6),c=a(8),p=a(7),m=a(9),d=(a(114),a(104)),u=a(46),h=function(){var e=document.location.search.substr(1),t={};return e.split("&").forEach(function(e){var a=e.split("=");t[a[0]]=decodeURIComponent(a[1])}),t}(),g=void 0!==h.url?h.url:"http://localhost:3000/"===window.location.href?"http://localhost:89/":"/server/",v=Object(u.createMuiTheme)({palette:{primary:{main:"#007bff"}}});function f(e){var t=[];for(var a in e)e.hasOwnProperty(a)&&t.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));var r=t.join("&");return r=g+(""!==r?"?"+r:"")}function b(e,t,a,r,n,i){for(var s=128*(1-a),o=0;o<e.data.length;o+=4)e.data[o]*=r*t,e.data[o+1]*=n*t,e.data[o+2]*=i*t,e.data[o]=e.data[o]*a+s,e.data[o+1]=e.data[o+1]*a+s,e.data[o+2]=e.data[o+2]*a+s;return e}function E(e,t){for(var a,r,n,i=0;i<e.data.length;i+=4)a=(.213+.787*t)*e.data[i]+(.715-.715*t)*e.data[i+1]+(.072-.072*t)*e.data[i+2],r=(.213-.213*t)*e.data[i]+(.715+.285*t)*e.data[i+1]+(.072-.072*t)*e.data[i+2],n=(.213-.213*t)*e.data[i]+(.715-.715*t)*e.data[i+1]+(.072+.928*t)*e.data[i+2],e.data[i]=a,e.data[i+1]=r,e.data[i+2]=n;return e}function S(e){for(var t,a,r,n=0;n<e.data.length;n+=4)t=.393*e.data[n]+.769*e.data[n+1]+.189*e.data[n+2],a=.349*e.data[n]+.686*e.data[n+1]+.168*e.data[n+2],r=.272*e.data[n]+.534*e.data[n+1]+.131*e.data[n+2],e.data[n]=t,e.data[n+1]=a,e.data[n+2]=r;return e}function N(e,t){var a=e.images[t],r=a.editorState.imageZoom*a.editorState.ratio,n=e.editorWidth-2*a.editorState.maskLR,i=e.editorHeight-2*a.editorState.maskTB,s=-1*a.editorState.sliderPositionLR,o=-1*a.editorState.sliderPositionTB,l=a.editorState.imgWidth,c=a.editorState.imgHeight;if(0===a.editorState.imageRotate||180===a.editorState.imageRotate)s>0?l-=s:s<0&&(s=0),l+a.editorState.sliderPositionLR+s>n&&(l=n-a.editorState.sliderPositionLR-s),l<0&&(l=0),o>0?(c-=o,o>a.editorState.imgHeight&&(o=a.editorState.imgHeight)):o<0&&(o=0),c+a.editorState.sliderPositionTB+o>i&&(c=i-a.editorState.sliderPositionTB-o),c<0&&(c=0);else{var p=a.editorState.sliderPositionLR+a.editorState.imgWidth/2,m=a.editorState.sliderPositionTB+a.editorState.imgHeight/2-a.editorState.imgWidth/2;s=0,m+l>i&&(l=i-m),m<0&&(l-=s=-1*m),m>i&&(l=0);var d=p-a.editorState.imgHeight/2;o=0,d+c>n&&(c-=o=d+c-n),d<0&&(c+=d),d>n&&(c=0)}180!==a.editorState.imageRotate&&270!==a.editorState.imageRotate||(s=a.editorState.imgWidth-l-s,o=a.editorState.imgHeight-c-o);var u=l,h=c;s/=r,o/=r,l/=r,c/=r;var g=a.editorState.sliderPositionLR,v=a.editorState.sliderPositionTB;g<0&&(g=0),v<0&&(v=0),g/=a.editorState.ratio,v/=a.editorState.ratio,u/=a.editorState.ratio,h/=a.editorState.ratio;var f=a.editorState.sliderPositionLR,b=a.editorState.sliderPositionTB,E=a.editorState.imgWidth,S=a.editorState.imgHeight;return 90!==a.editorState.imageRotate&&270!==a.editorState.imageRotate||(f=f+E/2-S/2,b=b+S/2-E/2,E=a.editorState.imgHeight,S=a.editorState.imgWidth),E+f>n&&(E=n-f),f<0&&(E+=f,f=0),E<0&&(E=0),S+b>i&&(S=i-b),b<0&&(S+=b,b=0),S<0&&(S=0),{sX:s,sY:o,sW:l,sH:c,cX:g,cY:v,cW:u,cH:h,pX:f/=a.editorState.ratio,pY:b/=a.editorState.ratio,pW:E/=a.editorState.ratio,pH:S/=a.editorState.ratio}}function k(e,t){return void 0!==t&&t||(t=300),e/t}function y(e,t){return void 0!==t&&t||(t=300),e*t}function w(e,t){return void 0===e&&(e=0),e=String(e).replace(/,/g,"."),e=parseFloat(e),isNaN(e)&&(e=0),void 0===t?e.toFixed(2):e.toFixed(parseInt(t))}var C=a(11),I=a.n(C);a(192);function x(e){O[e]&&(window.LANG=e)}function _(){var e=[];for(var t in O)e.push({key:t,caption:O[t].langCaption});return e}function P(e){var t="ua";return window.LANG&&(t=window.LANG),void 0===O[t][e]&&""!==O[t][e]?e:O[t][e]}var O={en:{langCaption:"English"},ua:{langCaption:"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430","Wait a moment while app loading":"\u0417\u0430\u0447\u0435\u043a\u0430\u0439\u0442\u0435 \u0442\u0440\u0456\u0448\u043a\u0438, \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0443\u0454\u0442\u044c\u0441\u044f",Cancel:"\u0412\u0456\u0434\u043c\u0456\u043d\u0430",Warning:"\u0423\u0432\u0430\u0433\u0430",Next:"\u0414\u0430\u043b\u0456",Previous:"\u041d\u0430\u0437\u0430\u0434",Print:"\u0414\u0440\u0443\u043a",Save:"\u0417\u0431\u0435\u0440\u0435\u0433\u0442\u0438","Loaded already":"\u041e\u0442\u0440\u0438\u043c\u0430\u043d\u043e \u0444\u0430\u0439\u043b\u0456\u0432",Name:"\u041d\u0430\u0437\u0432\u0430",Height:"\u0412\u0438\u0441\u043e\u0442\u0430",Width:"\u0428\u0438\u0440\u0438\u043d\u0430",Surface:"\u041f\u043e\u0432\u0435\u0440\u0445\u043d\u044f",glance:"\u0433\u043b\u044f\u043d\u0435\u0446\u044c",matte:"\u043c\u0430\u0442\u043e\u0432\u0438\u0439",Files:"\u0424\u0430\u0439\u043b\u0438",Selected:"\u0412\u0438\u0431\u0440\u0430\u043d\u043e",Cost:"\u0412\u0430\u0440\u0442\u0456\u0441\u0442\u044c","Are you sure?":"\u0412\u0438 \u0443\u043f\u0435\u0432\u043d\u0435\u043d\u0456?",error:"\u043f\u043e\u043c\u0438\u043b\u043a\u0430 ","error status, let see log":"\u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u043e\u043c\u0438\u043b\u043a\u0438 \u0432\u0438\u0432\u0435\u0434\u0435\u043d\u043e \u0432 \u043a\u043e\u043d\u0441\u043e\u043b\u044c","Select CD, flash card or other source, then select format what you want, and press button":"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c CD \u0447\u0438 \u0444\u043b\u0435\u0448\u043a\u0443 \u0447\u0438 \u0456\u043d\u0448\u0438\u0439 \u043d\u043e\u0441\u0456\u0439 \u0456\u0437 \u0412\u0430\u0448\u0438\u043c\u0438 \u0437\u043d\u0456\u043c\u043a\u0430\u043c\u0438. \u041f\u043e\u0442\u0456\u043c \u0432\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u0431\u0430\u0436\u0430\u043d\u0438\u0439 \u0444\u043e\u0440\u043c\u0430\u0442. \u0414\u043b\u044f \u043f\u0440\u043e\u0434\u043e\u0432\u0436\u0435\u043d\u043d\u044f \u043d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c","Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture":"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044c \u043f\u0430\u043f\u043a\u0443, \u0442\u0430 \u0432\u0456\u0434\u043c\u0456\u0447\u0430\u0439\u0442\u0435 \u043f\u043e\u0442\u0440\u0456\u0431\u043d\u0456 \u0444\u043e\u0442\u043e. \u0429\u043e\u0431 \u0437\u0431\u0456\u043b\u044c\u0448\u0438\u0442\u0438 \u0444\u043e\u0442\u043e, \u043d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c \u043d\u0430 \u0439\u043e\u0433\u043e \u043d\u0430\u0437\u0432\u0443","To continue you should select at least one image":"\u0429\u043e\u0431 \u043f\u0440\u043e\u0434\u043e\u0432\u0436\u0438\u0442\u0438 \u043f\u043e\u0442\u0440\u0456\u0431\u043d\u043e \u0432\u0438\u0431\u0440\u0430\u0442\u0438 \u0445\u043e\u0447\u0430 \u0431 \u043e\u0434\u043d\u0435 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f ","Select all":"\u0412\u0438\u0431\u0440\u0430\u0442\u0438 \u0432\u0441\u0456","Select none":"\u041d\u0435 \u0432\u0438\u0431\u0438\u0440\u0430\u0442\u0438 \u043d\u0456\u0447\u043e\u0433\u043e","No images":"\u0417\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u044c \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d\u043e","Current state of editor images will be lost.":"\u0417\u0440\u043e\u0431\u043b\u0435\u043d\u0456 \u043f\u0440\u0430\u0432\u043a\u0438 \u0431\u0443\u0434\u0443\u0442\u044c \u0432\u0442\u0440\u0430\u0447\u0435\u043d\u0456 \u043f\u0440\u0438 \u043f\u043e\u0432\u0435\u0440\u043d\u0435\u043d\u043d\u0456.",Format:"\u0424\u043e\u0440\u043c\u0430\u0442",Amount:"\u041a-\u0441\u0442\u044c",Total:"\u0412\u0441\u044c\u043e\u0433\u043e","Successful printed":"\u0423\u0441\u043f\u0456\u0448\u043d\u043e \u043d\u0430\u0434\u0440\u0443\u043a\u043e\u0432\u0430\u043d\u043e","The number of your order is":"\u041d\u043e\u043c\u0435\u0440 \u0432\u0430\u0448\u043e\u0433\u043e \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f","Dont forget to remove your source.":"\u041d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0437\u0430\u0431\u0440\u0430\u0442\u0438 \u0412\u0430\u0448 \u043d\u043e\u0441\u0456\u0439.","Thank you!":"\u0414\u044f\u043a\u0443\u0454\u043c\u043e!"}},M=(a(193),a(2)),R=a.n(M),T=a(35),L=a.n(T),B=a(36),j=a.n(B),F=a(10),W=a.n(F),D=a(42),A=a.n(D),U=a(47),H=a.n(U),z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).clientUploadProgress=function(e){var t=Math.floor(100*e.loaded/e.total);a.props.appSetState({progressBarValue:t})},a.clientUpload=function(e){var t=new FormData,r=e.target.files;if(0!==r.length){a.props.appSetState({isPleaseWait:!0});for(var n={onUploadProgress:function(e){return a.clientUploadProgress(e)},headers:{"Content-Type":"multipart/form-data"}},i=0;i<r.length;i++)t.append("images[]",r[i]);I.a.post(f({q:"src-upload",p:a.props.app.isSetupPassword}),t,n).then(function(){a.checkSources()}).catch(function(e){console.log(e)}).finally(function(){e.target&&(e.target.files=null),a.props.appSetState({isPleaseWait:!1,progressBarValue:-1})})}},a.openLangsPanel=function(e){e&&x(e),a.setState({isLangsOpen:!a.state.isLangsOpen})},a.checkSourceTimer=null,a.checkSourceTimerMax=7200,a.checkSourceTimerCount=a.checkSourceTimerMax,a.state={isLangsOpen:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.checkSourceTimer&&clearTimeout(this.checkSourceTimer)}},{key:"componentDidMount",value:function(){for(var e=this,t=this.props.app.sources.slice(),a=t.length,r=0;r<a;r++)t[r].hasFiles=!1;this.props.appSetState({sources:t},function(){e.checkSources(!0)})}},{key:"componentDidUpdate",value:function(e,t,a){e.app.isUploadEnable!==this.props.app.isUploadEnable&&this.props.app.isUploadEnable&&this.inputUpload&&this.inputUpload.click()}},{key:"checkSources",value:function(e){var t=this;if(this.props.app.sources){var a=this.props.app.sources.slice(),r=a.length;e&&(this.checkSourceTimerCount=0);for(var n=function(e){if(a[e].enabled&&a[e].emptyhide){var r=f({q:"checkEmptySource",id:e});I.a.get(r).then(function(r){200===r.status&&""===r.data.error&&(a[e].hasFiles=r.data.data,t.props.appSetState({sources:a}))})}},i=0;i<r;i++)n(i);this.checkSourceTimerCount<this.checkSourceTimerMax&&(this.checkSourceTimer=setTimeout(this.checkSources.bind(this),9e3)),this.checkSourceTimerCount++}}},{key:"render",value:function(){var e=this,t=this.props.app.sources?this.props.app.sources:[],a=_(),r=this.state.isLangsOpen?n.a.createElement(H.a,{onClickAway:function(){e.openLangsPanel()}},n.a.createElement(W.a,{className:"app-main-change-langs scrollbar position-absolute"},n.a.createElement("table",{className:"table-langs"},a.map(function(t,a){return n.a.createElement("tbody",{key:a,onClick:function(){return e.openLangsPanel(t.key)}},n.a.createElement("tr",null,n.a.createElement("th",{scope:"row",className:"text-left"},n.a.createElement(R.a,null,"language")," ",t.caption)))})))):null;return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-start w-100 h-100"},n.a.createElement("div",{className:"app-main h-85"},n.a.createElement("div",{className:"app-main-selectors w-85 h-100 d-inline-block"},n.a.createElement("div",{className:"app-main-selectors-source text-center w-50 h-100 p-2 d-inline-block"},n.a.createElement(W.a,{className:"scrollbar p-2 h-100 app-bg-e  position-relative"},t.map(function(t,a){return n.a.createElement(L.a,{key:a,className:"app-source-item d-inline-block m-2"+(e.props.app.currentSource===a?" text-white bg-primary":"")+(t.enabled?"":" app-source-disabled")+(t.emptyhide&&!t.hasFiles?" app-source-emptyhide":""),onClick:function(){return e.props.onClickSource(a)}},n.a.createElement(j.a,null,n.a.createElement("div",{className:"card-img"},n.a.createElement("img",{src:f()+t.icon,alt:t.name,className:"app-source-icon"})),t.enabled&&t.name))}))),n.a.createElement("div",{className:"app-main-selectors-format w-50 h-100 p-2 d-inline-block position-relative"},n.a.createElement(W.a,{className:"scrollbar p-2 h-100 app-bg-e  position-relative"},this.props.app.formats.map(function(t,a){return t.enabled?n.a.createElement(L.a,{key:a,className:"app-format-item m-2"+(e.props.app.currentFormat===a?" text-white bg-primary":""),onClick:function(){return e.props.onClickFormat(a)}},n.a.createElement(j.a,null,n.a.createElement("div",{className:"app-main-selectors-format-wrp"},n.a.createElement("div",{className:"_w30"},t.name),n.a.createElement("div",{className:"_w20"},t.height,'"x ',t.width,'"'),n.a.createElement("div",{className:"_w20"},Math.round(25.4*t.height),"x",Math.round(25.4*t.width)),n.a.createElement("div",{className:"_w15"},P(t.surface)),n.a.createElement("div",{className:"_w15 text-right"},w(t.cost))))):""})))),n.a.createElement("div",{className:"app-main-rightwidget w-15 h-100 p-2 d-inline-block"},n.a.createElement(W.a,{className:"h-100 p-2 app-bg-e position-relative"},n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-primary",disabled:null===this.props.app.currentSource||null===this.props.app.currentFormat,onClick:function(){return e.props.onClickNextBtn()},type:"button"},n.a.createElement(R.a,null,"arrow_forward")," ",P("Next"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-success mt-4",disabled:this.checkSourceTimerCount<this.checkSourceTimerMax,onClick:function(){return e.checkSources(!0)},type:"button"},n.a.createElement(R.a,null,"refresh")," ",P("Refresh"))),n.a.createElement("div",{className:"bottom-absolute w-100"},n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("div",{className:"app-main-change-langs-wrapper position-relative"},r,n.a.createElement("button",{className:"btn btn-big btn-light text-success",style:{minWidth:"10vh",width:"auto"},onClick:this.openLangsPanel,disabled:!1,title:P("Language"),type:"button"},n.a.createElement(R.a,null,"language"),n.a.createElement("div",null,P("langCaption"))))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{type:"button",className:"btn btn-big btn-success",disabled:!1,onClick:function(){e.props.appSetState({isSetup:1})}},n.a.createElement(R.a,null,"build"),n.a.createElement("div",null,this.props.app.version))))))),n.a.createElement("div",{className:"app-bottomframe p-2 h-15 w-100"},n.a.createElement(W.a,{className:"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp position-relative"},this.props.app.isUploadEnable&&n.a.createElement("label",{htmlFor:"file-input"},n.a.createElement("input",{id:"file-input",ref:function(t){return e.inputUpload=t},type:"file",multiple:!0,onChange:function(t){return e.clientUpload(t)}}),n.a.createElement(R.a,{className:"_icon text-white text-success"},"info")),!this.props.app.isUploadEnable&&n.a.createElement(R.a,{onClick:function(){e.props.appSetState({isSetup:2})},className:"_icon text-white"},"info"),n.a.createElement("div",{className:"_msg"},P("Select CD, flash card or other source, then select format what you want, and press button")," '",P("Next"),"'"),this.props.app.progressBarValue>=0&&n.a.createElement("div",{className:"app-bottom-progress h-100 p-2 w-100"},n.a.createElement(A.a,{variant:"determinate",value:this.props.app.progressBarValue})))))}}]),t}(n.a.Component),q=(a(200),a(15)),G=a.n(q),Z={folders:[],tree:[],currentFolder:null,is_loadind_images:!0,expandedImage:null,images:[],progressAjax:{},previewMaxResize:null,isAutoclearLoading:!1,isAutoclearLoaded:0},V=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).nextPage=function(){var e=a.state.images.filter(function(e){return e.marked});if(0!==e.length){var t=e.map(function(e){return e.dir}),r=e.map(function(e){return e.name}),n=f(),i=new URLSearchParams;i.append("q","movetowork"),i.append("id",a.props.app.currentSource),i.append("maxWidth",a.state.previewMaxResize?a.state.previewMaxResize:300);var s=!0,o=!1,l=void 0;try{for(var c,p=t[Symbol.iterator]();!(s=(c=p.next()).done);s=!0){var m=c.value;i.append("dirs[]",m)}}catch(S){o=!0,l=S}finally{try{s||null==p.return||p.return()}finally{if(o)throw l}}var d=!0,u=!1,h=void 0;try{for(var g,v=r[Symbol.iterator]();!(d=(g=v.next()).done);d=!0){var b=g.value;i.append("files[]",b)}}catch(S){u=!0,h=S}finally{try{d||null==v.return||v.return()}finally{if(u)throw h}}var E=3;a.props.appSetState({progressBarValue:E,isPleaseWait:!0}),I.a.post(n,i,{onDownloadProgress:function(e){var t=Math.round(100*e.loaded/e.total);E=e.lengthComputable?t:E,a.props.appSetState({progressBarValue:E})}}).then(function(){E=-1,a.props.appSetState({progressBarValue:-1});var t=f({q:"workpath"});I.a.get(t).then(function(t){if(200===t.status&&""===t.data.error){var r=a.props.app.formats[a.props.app.currentFormat].dpi?a.props.app.formats[a.props.app.currentFormat].dpi:300,n=e.map(function(e){var n=t.data.data.thumbs+e.dir+e.name.substr(0,e.name.lastIndexOf("."))+".jpg";return{name:e.name,extension:e.extension,width:k(e.width,r),height:k(e.height,r),width_pixel:e.width,height_pixel:e.height,orientation:e.orientation,thumb:n.replace("?","%3F"),src:t.data.data.works+e.name,format:a.props.app.formats[a.props.app.currentFormat],count:1,editorState:{maskTB:0,maskLR:0,imageZoom:1,imageZoomMax:1.9,imageZoomMin:.1,imageRotate:0,colorR:1,colorG:1,colorB:1,brightness:1,contrast:1,saturate:1,sepia:!1,sliderPositionTB:0,sliderPositionLR:0,initedImagePosition:!1,initedMask:!1,ratio:1,imgWidth:e.width,imgHeight:e.height,currentTab:0}}});a.props.onClickNextBtn(n)}})}).catch(function(e){e.response&&(console.log("movetowork error",e.responderEnd),a.props.onMessage("movetowork error: "+e.responderEnd),E=-1,a.props.appSetState({progressBarValue:-1,isPleaseWait:!1}))})}else a.props.onMessage(P("To continue you should select at least one image"))},a.imagesContainer=null,a.isAutoclearTimer=null,a.state=Z,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.app.sources[this.props.app.currentSource].autoclear?this.setState({isAutoclearLoading:!0},function(){e.onClickDir(null)}):this.onClickDir(null)}},{key:"scrollImages",value:function(e){if(this.imagesContainer){console.log("scrollTop",this.imagesContainer.scrollTop),console.log("scrollHeight",this.imagesContainer.scrollHeight);var t=this.imagesContainer.scrollHeight/Math.ceil(this.state.images.length/3);console.log("rowCount",t),this.imagesContainer.scrollTop+=t*e}}},{key:"onClickDir",value:function(e){var t=this,a=e&&this.state.folders?this.state.folders[e].dir:"",r="";if(this.state.isAutoclearLoading)r=f({q:"source",id:this.props.app.currentSource,dir:a}),I.a.get(r).then(function(e){200===e.status&&""===e.data.error&&t.setState({isAutoclearLoaded:e.data.data.length})}),this.isAutoclearTimer=setTimeout(function(){t.onClickDir()},3e3);else{this.isAutoclearTimer&&clearTimeout(this.isAutoclearTimer);var n="",i=[{list:this.props.app.currentSource,source:this.props.app.sources[this.props.app.currentSource],name:this.props.app.sources[this.props.app.currentSource].name,dir:n,level:0}];this.setState({folders:i,currentFolder:null}),r=f({q:"folders",id:this.props.app.currentSource,dir:a}),I.a.get(r).then(function(e){if(200===e.status&&""===e.data.error){for(var r=1,s=0;s<e.data.tree.length;s++){n+=(""!==n?"/":"")+e.data.tree[s];var o={list:t.props.app.currentSource,name:e.data.tree[s],dir:n,level:r};r<5&&r++,i.push(o)}var l=!0,c=!1,p=void 0;try{for(var m,d=e.data.data[Symbol.iterator]();!(l=(m=d.next()).done);l=!0){var u=m.value;u.level=r,i.push(u)}}catch(v){c=!0,p=v}finally{try{l||null==d.return||d.return()}finally{if(c)throw p}}t.setState({folders:i,currentFolder:e.data.tree.length}),t.setState({images:[],is_loadind_images:!0});var h=3;t.props.appSetState({progressBarValue:h});var g=f({q:"source",precache:!0,id:t.props.app.currentSource,dir:a});I.a.get(g,{onDownloadProgress:function(e){var a=Math.round(100*e.loaded/e.total);h=e.lengthComputable?a:h,t.props.appSetState({progressBarValue:h})}}).then(function(){t.props.appSetState({progressBarValue:-1}),g=f({q:"source",id:t.props.app.currentSource,dir:a}),I.a.get(g).then(function(e){200===e.status&&""===e.data.error&&t.setState({images:e.data.data},function(){t.imagesScroll()}),t.setState({is_loadind_images:!1})})}).catch(function(e){e.response&&(console.log(e.responderEnd),t.props.onMessage("testProgress error: "+e.responderEnd),h=-1,t.props.appSetState({progressBarValue:-1}))})}})}}},{key:"showExpandImg",value:function(e){var t=this;this.setState({expandedImage:null},function(){t.setState({expandedImage:e},function(){t.reopenThumb(e)})})}},{key:"reopenThumb",value:function(e){var t=this,a=this.state.images.slice(),r=a[e].name;a[e].name="",this.setState({images:a},function(){a[e].name=r,t.setState({images:a})})}},{key:"hideExpandImg",value:function(){this.setState({expandedImage:null})}},{key:"MarkImage",value:function(e){var t=this.state.images.slice();t[e].marked=!t[e].marked,this.setState({images:t})}},{key:"markAllImages",value:function(e){for(var t=this.state.images,a=0;a<t.length;a++)t[a].marked=e;this.setState({images:t})}},{key:"setpreviewMaxResize",value:function(e){this.setState({previewMaxResize:e})}},{key:"imagesScroll",value:function(){var e=this.state.images.slice(),t=!1;if(this.imagesContainer&&this.imagesContainer.children)for(var a=this.imagesContainer.clientHeight,r=this.imagesContainer.children.length,n=0;n<r;n++)if(e[n]&&!e[n].is_appeared){var i=this.imagesContainer.children[n].getBoundingClientRect();!(i.bottom<0||i.top-a>=0)&&(e[n].is_appeared=!0,t=!0)}t&&this.setState({images:e})}},{key:"render",value:function(){var e=this,t=this.state.images.filter(function(e){return e.marked}),a=this.props.app.formats[this.props.app.currentFormat].cost;return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-start w-100 h-100"},n.a.createElement("div",{className:"app-main h-90"},n.a.createElement("div",{className:"d-inline-block w-85 h-100"},n.a.createElement("div",{className:"app-main-selectors w-100 h-100 d-flex flex-row"},n.a.createElement("div",{className:"app-main-selectors-folder h-100 p-2 flex-grow-1 flex-shrink-1"},n.a.createElement(W.a,{className:"scrollbar p-2 h-100 app-bg-e"},this.state.folders.map(function(t,a){return n.a.createElement(L.a,{key:a,className:"m-1 app-dir-item level"+t.level+" "+(e.state.currentFolder===a?" text-white bg-primary":""),onClick:function(){return e.onClickDir(a)}},n.a.createElement(j.a,null,t.source&&n.a.createElement("img",{src:f()+t.source.icon,alt:t.source.name,className:"app-dir-item-icon"}),t.name,0===a&&n.a.createElement(R.a,{className:"float-right"},"refresh")))}))),n.a.createElement("div",{className:"app-main-selectors-image h-100 p-2 flew-grow-0 flex-shrink-0"},n.a.createElement(W.a,{className:"h-100 position-relative app-bg-e"},n.a.createElement("div",{ref:function(t){e.imagesContainer=t},onScroll:function(){return e.imagesScroll()},className:"p-2 h-100 scrollbar"},this.state.images.map(function(t,a){return n.a.createElement(Y,Object.assign({key:t.name,image:t,itemIndex:a,imagesContainer:e.imagesContainer,onExpand:function(){return e.showExpandImg(a)},onMark:function(){return e.MarkImage(a)},setpreviewMaxResize:function(){return e.setpreviewMaxResize.bind(e)}},e.props))})),!this.state.is_loadind_images&&0===this.state.images.length&&n.a.createElement("div",{className:"app-source-noimages h-100 text-primary"},P("No images")),this.state.is_loadind_images&&!this.state.isAutoclearLoading&&n.a.createElement("div",{className:"list-images-loader spinner-border text-primary",role:"status"},n.a.createElement("span",{className:"sr-only"}," Loading...")))))),n.a.createElement("div",{className:"app-main-rightwidget w-15 h-100 p-2 d-inline-block"},n.a.createElement(W.a,{className:"h-100 p-2 app-bg-e position-relative"},n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-primary",onClick:function(){return e.nextPage()},disabled:!1,title:P("Next"),type:"button"},n.a.createElement(R.a,null,"arrow_forward")," ",P("Next"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-primary",onClick:function(){e.props.onClickPrevBtn()},disabled:!1,title:P("Previous"),type:"button"},n.a.createElement(R.a,null,"arrow_back")," ",P("Previous"))),n.a.createElement("div",{className:"_fabwrapper mt-4"},n.a.createElement("button",{className:"btn btn-success",onClick:function(){return e.scrollImages(-1)},disabled:!1,title:P("up"),type:"button"},n.a.createElement(R.a,null,"expand_less"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-success mr-2",onClick:function(){return e.markAllImages(!0)},disabled:!1,title:P("Select all"),type:"button"},n.a.createElement(R.a,null,"filter")),n.a.createElement("button",{className:"btn btn-success",onClick:function(){return e.markAllImages(!1)},disabled:!1,title:P("Select none"),type:"button"},n.a.createElement(R.a,null,"filter_none"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-success",onClick:function(){return e.scrollImages(1)},disabled:!1,title:P("down"),type:"button"},n.a.createElement(R.a,null,"expand_more"))),n.a.createElement("div",{className:"app-main-rightwidget-tablewrp"},n.a.createElement("table",{className:"table"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},P("Files")),n.a.createElement("th",{scope:"row"},this.state.images.length)),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},P("Selected")),n.a.createElement("th",{scope:"row"},t.length)),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},P("Cost")),n.a.createElement("th",{scope:"row"},w(t.length*a))))))))),n.a.createElement("div",{className:"app-bottomframe w-100 h-10 p-2 position-relative"},n.a.createElement(W.a,{className:"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp"},n.a.createElement(R.a,{className:"_icon text-white"},"info"),n.a.createElement("div",{className:"_msg"},P("Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture"))),this.props.app.progressBarValue>=0&&n.a.createElement("div",{className:"app-bottom-progress h-100 p-2 w-100"},n.a.createElement(A.a,{variant:"determinate",value:this.props.app.progressBarValue}))),this.state.isAutoclearLoading&&n.a.createElement("div",{className:"app-please-wait-wrp position-fixed"},n.a.createElement(W.a,{className:"app-page-loadimages-wait p-3"},n.a.createElement("div",{className:"app-source-icon-wrp"},n.a.createElement("img",{src:f()+this.props.app.sources[this.props.app.currentSource].icon,alt:this.props.app.sources[this.props.app.currentSource].name,className:"app-source-icon"})),this.props.app.sources[this.props.app.currentSource].name,n.a.createElement("div",{className:"_loaded p-3"},P("Loaded already"),": ",this.state.isAutoclearLoaded),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-success",onClick:function(){e.setState({isAutoclearLoading:!1},function(){e.onClickDir()})},disabled:!1,title:P("OK"),type:"button"},P("Next"))))),n.a.createElement(X,{image:null!==this.state.expandedImage?this.state.images[this.state.expandedImage]:null,itemCurrent:this.state.expandedImage,itemPrev:this.state.expandedImage>0?this.state.expandedImage-1:null,itemNext:this.state.expandedImage<this.state.images.length-2?this.state.expandedImage+1:null,onExpand:this.showExpandImg.bind(this),onMark:this.MarkImage.bind(this),onClose:this.hideExpandImg.bind(this)}))}}]),t}(n.a.Component),Y=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.image,a="";switch(this.props.image.orientation){case 3:a=" rotate180";break;case 6:a=" rotate90";break;case 8:a=" rotate270"}var r=300;this.props.previewMaxResize?r=this.props.previewMaxResize:this.imgWrapper&&(r=this.imgWrapper.clientWidth,this.props.setpreviewMaxResize(r));var i={backgroundImage:"url("+f({q:"img",id:t.list,dir:t.dir,src:t.name,max:r})+")"};return n.a.createElement(L.a,{className:"app-source-image-item d-inline-block m-1 position-relative"},n.a.createElement(j.a,{className:"p-0",onClick:function(){return e.props.onMark()},onDoubleClick:function(){return e.props.onExpand(e.props.itemIndex)}},n.a.createElement("div",{ref:function(t){e.imgWrapper=t},className:"app-source-image-item-img-wrapper p-1 "+(t.marked?" text-white bg-primary":"")},t.is_appeared&&n.a.createElement("div",{className:"app-source-image-item-img border "+a,style:i}),!t.is_appeared&&n.a.createElement("div",{className:"app-source-image-item-img border "}),n.a.createElement("div",{className:"app-source-image-item-toggle position-absolute"},n.a.createElement(G.a,{className:"bg-primary text-light",onClick:function(t){t.stopPropagation(),e.props.onMark()},"aria-label":"Check"},n.a.createElement(R.a,null,"check"))),n.a.createElement("div",{className:"app-source-image-item-fullscreen position-absolute"},n.a.createElement(G.a,{className:"bg-success text-light",onClick:function(){return e.props.onExpand(e.props.itemIndex)},"aria-label":"Fullscreen"},n.a.createElement(R.a,null,"zoom_in"))),n.a.createElement("div",{className:"app-selectimages-item-text text-center m-1"},t.name))))}}]),t}(r.PureComponent),X=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.image;if(null===t)return null;var a="";switch(t.orientation){case 3:a=" rotate180";break;case 6:a=" rotate90";break;case 8:a=" rotate270"}var r=f({q:"img",id:t.list,dir:t.dir,src:t.name,max:-1});return n.a.createElement("div",{className:"app-modal",onClick:function(){return e.props.onClose()}},n.a.createElement("div",{className:"app-modal-main position-fixed"},n.a.createElement("div",{className:"rotate-wrp app-source-image-expanded rounded"+a+(t.marked?" bg-primary":"")},n.a.createElement("img",{src:r,alt:"zoomed",onClick:function(t){t.stopPropagation(),e.props.onMark(e.props.itemCurrent)}}))),n.a.createElement("div",{onClick:function(t){null!==e.props.itemPrev&&(t.stopPropagation(),e.props.onExpand(e.props.itemPrev))},className:"app-image-expanded-button _prev position-absolute"},n.a.createElement(G.a,{disabled:null===this.props.itemPrev,"aria-label":"Previous"},n.a.createElement(R.a,null,"navigate_before"))),n.a.createElement("div",{onClick:function(t){t.stopPropagation(),e.props.onMark(e.props.itemCurrent)},className:"app-image-expanded-button _check position-absolute"},n.a.createElement(G.a,{"aria-label":"Check"},n.a.createElement(R.a,{className:"text-success"},"check"))),n.a.createElement("div",{onClick:function(t){null!==e.props.itemNext&&(t.stopPropagation(),e.props.onExpand(e.props.itemNext))},className:"app-image-expanded-button _next position-absolute"},n.a.createElement(G.a,{disabled:null===this.props.itemNext,"aria-label":"Next"},n.a.createElement(R.a,null,"navigate_next"))),n.a.createElement("div",{onClick:function(t){t.stopPropagation(),e.props.onClose()},className:"app-image-expanded-button _close position-absolute"},n.a.createElement(G.a,{"aria-label":"Close"},n.a.createElement(R.a,null,"close"))))}}]),t}(r.PureComponent),J=(a(216),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).nodeThumb=null,a.scrollRef=null,a.state={thumbWidth:"100px"},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.nodeThumb&&this.state.thumbWidth!==this.nodeThumb.clientHeight&&this.setState({thumbWidth:this.nodeThumb.clientHeight})}},{key:"componentDidUpdate",value:function(e,t,a){this.scrollRef&&this.props.selected&&this.props.scrollIntoView(this.scrollRef)}},{key:"render",value:function(){var e=this,t=this.props.image,a="";switch(t.orientation){case 3:a=" rotate180";break;case 6:a=" rotate90";break;case 8:a=" rotate270"}var r={width:this.state.thumbWidth,height:this.state.thumbWidth},i={width:"100%",height:"auto"};t.height>t.width&&(i={width:"auto",height:"100%"});var s="disabled",o="disabled",l="disabled";return t.editorState&&(t.editorState.initedImagePosition&&(s="inherit"),1!==t.editorState.brightness&&(o="inherit"),1!==t.editorState.contrast&&(o="inherit"),1!==t.editorState.saturate&&(o="inherit"),t.editorState.sepia&&(o="inherit"),1!==t.editorState.colorR&&(l="inherit"),1!==t.editorState.colorG&&(l="inherit"),1!==t.editorState.colorB&&(l="inherit")),n.a.createElement(L.a,{className:"app-editor-thumb-item h-100 d-inline-block m-1 position-relative "+(this.props.selected?" text-light bg-primary":" text-primary bg-light")},n.a.createElement(j.a,{className:"p-0 h-100 position-relative",onClick:this.props.onSelect},n.a.createElement("div",{ref:function(t){return e.scrollRef=t},className:"app-editor-thumb-item-img-wrapper h-100 p-1"},n.a.createElement("div",{ref:function(t){return e.nodeThumb=t},style:r,className:"app-editor-thumb-item-box h-100 border "+a},n.a.createElement("span",{className:"app-editor-thumb-item-img-helper"}),n.a.createElement("img",{src:f()+encodeURI(t.thumb),style:i,alt:"",className:"app-editor-thumb-item-image"+(t.count?"":" _zero")}))),n.a.createElement("div",{className:"app-editor-thumb-item-img-countbubble",style:{backgroundColor:v.palette.primary.main,color:v.palette.primary.contrastText}},n.a.createElement("span",null,t.count?t.count:"-")),n.a.createElement("div",{className:"app-editor-thumb-item-img-controls h-100"},n.a.createElement("div",{className:"app-editor-thumb-item-img-controls-flexv pr-1 h-100"},n.a.createElement("div",null,n.a.createElement(R.a,{fontSize:"small",color:s},"zoom_out_map")),n.a.createElement("div",null,n.a.createElement(R.a,{fontSize:"small",color:o},"brightness_medium")),n.a.createElement("div",null,n.a.createElement(R.a,{fontSize:"small",color:l},"equalizer")),n.a.createElement("div",{className:"app-editor-thumb-item-img-index"},n.a.createElement("span",null,this.props.itemIndex+1)))),!t.count&&n.a.createElement("div",{className:"app-editor-thumb-zeroprint"},"x")))}}]),t}(r.PureComponent)),K=a(26),Q=a.n(K),$=a(33),ee=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).onDragStart=function(e){return e.preventDefault(),!1},a.movingStart=function(){a.setState({dragImage:!0,dragX:null,dragY:null})},a.movingOn=function(e){if(a.state.dragImage){var t=a.state.dragX?a.state.dragX:e.screenX,r=a.state.dragY?a.state.dragY:e.screenY,n=e.screenX-t,i=e.screenY-r;a.setState({dragX:e.screenX,dragY:e.screenY},function(){var e=a.props.app.images[a.props.app.currentImage].editorState.sliderPositionLR+n,t=a.props.app.images[a.props.app.currentImage].editorState.sliderPositionTB+i;a.props.appImageChanged(a.props.app.currentImage,{sliderPositionLR:e,sliderPositionTB:t})})}},a.movingStop=function(){a.setState({dragImage:!1,dragX:null,dragY:null})},a.canvasImg=new Image,a.canvasImg.crossOrigin="anonymous";var r=a.updateCanvas.bind(Object($.a)(a));return a.canvasImg.onload=function(){r()},a.renderedImageIndex=null,a.state={imgSrc:null,dragImage:!1,dragX:0,dragY:0},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.app.images[this.props.app.currentImage].editorState.initedMask||this.props.appImageInitMask(this.props.app.currentImage)}},{key:"componentDidUpdate",value:function(e,t,a){if(this.props.app.currentImage!==e.app.currentImage)return console.log("new image clicked"),void this.setState({imgSrc:null});this.props.appEditorChanged(this.myImgContainer.clientWidth,this.myImgContainer.clientHeight);var r=this.props.app.images[this.props.app.currentImage];if(r.editorState.initedMask)if(r.editorState.initedImagePosition){var n=f()+encodeURI(r.src);if(this.canvasImg.src!==n){var i=this.updateCanvas.bind(this);return this.canvasImg.onload=function(){i()},void(this.canvasImg.src=n)}this.updateCanvas()}else this.props.alignInit(this.props.app.currentImage);else this.props.appImageInitMask(this.props.app.currentImage)}},{key:"updateCanvas",value:function(){if(this.myCanvas&&0!==this.myCanvas.clientWidth&&0!==this.myCanvas.clientHeight){var e=this.myCanvas.getContext("2d"),t=this.myCanvas.clientWidth,a=this.myCanvas.clientHeight,r=this.props.app.images[this.props.app.currentImage].editorState;try{e.drawImage(this.canvasImg,0,0,t,a);var n=e.getImageData(0,0,t,a);if(1===r.brightness&&1===r.contrast&&1===r.colorR&&1===r.colorG&&1===r.colorB||(n=b(n,r.brightness,r.contrast,r.colorR,r.colorG,r.colorB)),r.sepia&&(n=S(n)),1!==r.saturate&&(n=E(n,r.saturate)),e.putImageData(n,0,0),this.props.app.isDebugShow){var i=N(this.props.app,this.props.app.currentImage),s=i.sX,o=i.sY,l=i.sW,c=i.sH,p=r.ratio,m=r.imageZoom;e.lineWidth=6,e.strokeStyle="yellow",e.strokeRect(Math.round(s*p*m)+6,Math.round(o*p*m)+6,Math.round(l*p*m)-12,Math.round(c*p*m)-12)}}catch(d){console.log("drawImage failed")}}}},{key:"render",value:function(){var e=this,t=this.renderedImageIndex!==this.props.app.currentImage;this.renderedImageIndex=this.props.app.currentImage;var a=this.props.app.images[this.props.app.currentImage];if(t){var r=f()+encodeURI(a.src);this.canvasImg.src!==r&&(this.canvasImg.src=r)}var i,s,o,l,c={height:a.editorState.maskTB},p={height:this.props.app.editorHeight-2*a.editorState.maskTB,width:this.props.app.editorWidth-2*a.editorState.maskLR,top:a.editorState.maskTB,left:a.editorState.maskLR},m={width:a.editorState.maskLR},d=Math.ceil(a.editorState.imgWidth),u=Math.ceil(a.editorState.imgHeight),h={top:a.editorState.sliderPositionTB,left:a.editorState.sliderPositionLR,transform:"rotate("+a.editorState.imageRotate+"deg)"};if(this.props.app.isDebugShow){var g=N(this.props.app,this.props.app.currentImage),v=a.editorState.ratio;i=Math.round(g.pX*v)+2,s=Math.round((g.pX+g.pW)*v)-2,o=Math.round(g.pY*v)+2,l=Math.round((g.pY+g.pH)*v)-2}return n.a.createElement("div",{className:"app-main-editor-Printable-Mask border-light fld3d"},n.a.createElement("div",{className:"app-main-editor-Printable-mask _t",style:{height:"1rem"}}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _l",style:{width:"1rem"}}),n.a.createElement("div",{ref:function(t){e.myImgContainer=t},className:"app-main-editor-Printable"},n.a.createElement("div",{className:"app-main-editor-Printable-mask _t",style:c}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _l",style:m}),n.a.createElement("div",{onMouseMove:this.movingOn,onMouseUp:this.movingStop,className:"app-main-editor-Printable-viewport",style:p},n.a.createElement("canvas",{className:"app-main-editor-Printable-img",ref:function(t){e.myCanvas=t},width:d,height:u,style:h,draggable:!0,onDragStart:function(t){return e.onDragStart(t)},onMouseDown:this.movingStart,onMouseUp:this.movingStop}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"vRuler vRulerX",style:{left:i}}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"vRuler vRulerW",style:{left:s}}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"hRuler hRulerY",style:{top:o}}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"hRuler hRulerH",style:{top:l}})),n.a.createElement("div",{className:"app-main-editor-Printable-mask _r",style:m}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _b",style:c})),n.a.createElement("div",{className:"app-main-editor-Printable-mask _r",style:{width:"1rem"}}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _b",style:{height:"1rem"}}))}}]),t}(n.a.Component),te=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).sliderZoom=function(e,t){var r=a.props.app,n=r.images[r.currentImage],i=t/100,s=y(n.width,n.format.dpi)*i*n.editorState.ratio,o=y(n.height,n.format.dpi)*i*n.editorState.ratio,l=(n.editorState.imgWidth-s)/2,c=(n.editorState.imgHeight-o)/2,p={imageZoom:i,sliderPositionTB:n.editorState.sliderPositionTB+c,sliderPositionLR:n.editorState.sliderPositionLR+l,imgWidth:s,imgHeight:o,needUpdateCanvas:!0};a.props.appImageChanged(a.props.app.currentImage,p)},a.sliderChangeTB=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{sliderPositionTB:t})},a.sliderChangeLR=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{sliderPositionLR:t})},a.imageRotate=function(){var e=0;switch(a.props.app.images[a.props.app.currentImage].editorState.imageRotate){case 90:e=180;break;case 180:e=270;break;case 270:e=0;break;default:e=90}a.props.appImageChanged(a.props.app.currentImage,{imageRotate:e})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.app.images[this.props.app.currentImage];return n.a.createElement("div",{className:"h-100 d-flex flex-row"},n.a.createElement("div",{className:"app-main-editor-visual-left h-90 flex-grow-0 flex-shrink-0"},n.a.createElement("div",{className:"vert-slider-button-wrapper text-center d-inline-block"},n.a.createElement(G.a,{color:"primary",className:"_fabmini ml-3",onClick:function(){e.sliderZoom(null,100*t.editorState.imageZoom+.51)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"zoom_in"))),n.a.createElement("div",{className:"vert-slider-wrapper h-85 position-relative d-inline-block"},n.a.createElement(Q.a,{className:"app-slider-for-zoom",classes:{thumb:"_thumb"},thumb:n.a.createElement(R.a,{className:"app-slider-thumb-icon",color:"primary"},"zoom_in"),vertical:!0,max:100*t.editorState.imageZoomMax,min:100*t.editorState.imageZoomMin,value:100*t.editorState.imageZoom,onChange:this.sliderZoom}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,t.editorState.imageZoom))),n.a.createElement("div",{className:"vert-slider-button-wrapper text-center d-inline-block"},n.a.createElement(G.a,{color:"primary",className:"_fabmini ml-3",onClick:function(){e.sliderZoom(null,100*t.editorState.imageZoom-.51)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"zoom_out")))),n.a.createElement("div",{className:"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1"},n.a.createElement("div",{className:"h-90"},n.a.createElement(ee,this.props)),n.a.createElement("div",{className:"app-main-editor-visual-bottom h-10 w-100  d-flex flex-row"},n.a.createElement("div",{className:"hori-slider-button-wrapper text-center flex-grow-0"},n.a.createElement(G.a,{color:"primary",className:"_fabmini mt-3",onClick:function(){e.sliderChangeLR(null,t.editorState.sliderPositionLR-1)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"navigate_before"))),n.a.createElement("div",{className:" flex-grow-1"},n.a.createElement("div",{className:"hori-slider-wrapper h-100 w-100 position-relative d-inline-flex"},n.a.createElement(Q.a,{className:"app-slider-for-position",classes:{trackAfter:"_trackAfter",thumb:"_thumb"},thumb:n.a.createElement(R.a,{className:"app-slider-thumb-icon",color:"primary"},"image"),max:.9*(this.props.app.editorWidth-2*t.editorState.maskLR),value:t.editorState.sliderPositionLR,min:-.9*t.editorState.imgWidth,onChange:this.sliderChangeLR}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",t.editorState.sliderPositionLR,")")))),n.a.createElement("div",{className:"hori-slider-button-wrapper text-center flex-grow-0"},n.a.createElement(G.a,{color:"primary",className:"_fabmini mt-3",onClick:function(){e.sliderChangeLR(null,t.editorState.sliderPositionLR+1)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"navigate_next"))))),n.a.createElement("div",{className:"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0"},n.a.createElement("div",{className:"d-inline-flex flex-column h-100"},n.a.createElement("div",{className:"vert-slider-button-wrapper text-center d-inline-block"},n.a.createElement(G.a,{color:"primary",className:"_fabmini",onClick:function(){e.sliderChangeTB(null,t.editorState.sliderPositionTB-1)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"expand_less"))),n.a.createElement("div",{className:"vert-slider-wrapper h-85 position-relative d-inline-flex"},n.a.createElement(Q.a,{className:"app-slider-for-position",classes:{trackAfter:"_trackAfter",thumb:"_thumb"},thumb:n.a.createElement(R.a,{className:"app-slider-thumb-icon",color:"primary"},"image"),max:-.9*t.editorState.imgHeight,value:t.editorState.sliderPositionTB,min:.9*(this.props.app.editorHeight-2*t.editorState.maskTB),onChange:this.sliderChangeTB,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",t.editorState.sliderPositionTB,")"))),n.a.createElement("div",{className:"vert-slider-button-wrapper text-center d-inline-block"},n.a.createElement(G.a,{color:"primary",className:"_fabmini",onClick:function(){e.sliderChangeTB(null,t.editorState.sliderPositionTB+1)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"expand_more")))),n.a.createElement("div",{className:"vert-buttons-wrapper h-100 d-inline-flex"},n.a.createElement("div",{className:"app-main-editor-visual-right-buttons"},n.a.createElement("div",{className:"zoom-positioning"},n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h1  d-inline-block"}),n.a.createElement("div",{className:"zoom-positioning-w2 zoom-positioning-h1 d-inline-block"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignTop()}},n.a.createElement(R.a,null,"vertical_align_top"))),n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h1 d-inline-block"})),n.a.createElement("div",{className:"zoom-positioning"},n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h2 d-inline-block"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignLeft()}},n.a.createElement(R.a,{style:{transform:"rotate(270deg)"}},"vertical_align_top"))),n.a.createElement("div",{className:"d-inline-block"},n.a.createElement("div",{className:"zoom-positioning-w2 zoom-positioning-h1"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignLandscape(e.props.app.currentImage,t.format)}},n.a.createElement(R.a,null,"swap_horiz"))),n.a.createElement("div",{className:"zoom-positioning-w2 zoom-positioning-h1"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignPortrait(e.props.app.currentImage,t.format)}},n.a.createElement(R.a,null,"swap_vert")))),n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h2 d-inline-block"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignRight()}},n.a.createElement(R.a,{style:{transform:"rotate(90deg)"}},"vertical_align_top")))),n.a.createElement("div",{className:"zoom-positioning"},n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h1 d-inline-block"}),n.a.createElement("div",{className:"zoom-positioning-w2 zoom-positioning-h1 d-inline-block"},n.a.createElement("button",{type:"button",className:"btn btn-primary h-100",onClick:function(){e.props.alignBottom()}},n.a.createElement(R.a,{style:{transform:"rotate(180deg)"}},"vertical_align_top"))),n.a.createElement("div",{className:"zoom-positioning-w1 zoom-positioning-h1 d-inline-block"})),n.a.createElement("div",{className:"app-main-editor-visual-rotate-buttons mt-4 text-center"},n.a.createElement("button",{type:"button",className:"btn  btn-medium btn-primary mr-4",onClick:this.imageRotate},n.a.createElement(R.a,null,"rotate_right")),n.a.createElement("button",{type:"button",className:"btn  btn-medium btn-primary",onClick:function(){return e.props.appFormatRotate()}},n.a.createElement(R.a,null,"crop_rotate")))))))}}]),t}(n.a.Component),ae=a(56),re=a.n(ae),ne=a(25),ie=a.n(ne),se=function(e){function t(e){var a;Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).canvasImg=new Image,a.canvasImg.crossOrigin="anonymous";var r=a.updateCanvas.bind(Object($.a)(a));return a.canvasImg.onload=function(){r()},a.state={imgSrc:null,fakeThins:!0},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){if(this.props.app.currentImage!==e.app.currentImage)return console.log("new image clicked"),void this.setState({imgSrc:null});this.props.appEditorChanged(this.myImgContainer.clientWidth,this.myImgContainer.clientHeight);var r=this.props.app.images[this.props.app.currentImage];if(r.editorState.initedMask)if(r.editorState.initedImagePosition){var n=f()+encodeURI(r.src);if(this.canvasImg.src!==n){var i=this.updateCanvas.bind(this);return this.canvasImg.onload=function(){i()},void(this.canvasImg.src=n)}this.updateCanvas()}else this.props.alignInit(this.props.app.currentImage);else this.props.appImageInitMask(this.props.app.currentImage)}},{key:"updateCanvas",value:function(){if(this.myCanvas&&0!==this.myCanvas.clientWidth&&0!==this.myCanvas.clientHeight){var e=this.myCanvas.getContext("2d"),t=this.myCanvas.clientWidth,a=this.myCanvas.clientHeight,r=this.props.app.images[this.props.app.currentImage].editorState;try{e.drawImage(this.canvasImg,0,0,t,a);var n=e.getImageData(0,0,t,a);1===r.brightness&&1===r.contrast&&1===r.colorR&&1===r.colorG&&1===r.colorB||(n=b(n,r.brightness,r.contrast,r.colorR,r.colorG,r.colorB)),r.sepia&&(n=S(n)),1!==r.saturate&&(n=E(n,r.saturate)),e.putImageData(n,0,0)}catch(i){console.log("drawImage failed")}}}},{key:"render",value:function(){var e=this,t=this.renderedImageIndex!==this.props.app.currentImage;this.renderedImageIndex=this.props.app.currentImage;var a=this.props.app.images[this.props.app.currentImage];if(t){var r=f()+encodeURI(a.src);this.canvasImg.src!==r&&(this.canvasImg.src=r)}var i={height:a.editorState.maskTB},s={height:this.props.app.editorHeight-2*a.editorState.maskTB,width:this.props.app.editorWidth-2*a.editorState.maskLR,top:a.editorState.maskTB,left:a.editorState.maskLR},o={width:a.editorState.maskLR},l=Math.ceil(a.editorState.imgWidth),c=Math.ceil(a.editorState.imgHeight),p={top:a.editorState.sliderPositionTB,left:a.editorState.sliderPositionLR,transform:"rotate("+a.editorState.imageRotate+"deg)"};return n.a.createElement("div",{className:"app-main-editor-Printable-Mask border-light fld3d"},n.a.createElement("div",{className:"app-main-editor-Printable-mask _t",style:{height:"1rem"}}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _l",style:{width:"1rem"}}),n.a.createElement("div",{ref:function(t){e.myImgContainer=t},className:"app-main-editor-Printable"},n.a.createElement("div",{className:"app-main-editor-Printable-mask _t",style:i}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _l",style:o}),n.a.createElement("div",{className:"app-main-editor-Printable-viewport",style:s},n.a.createElement("canvas",{className:"app-main-editor-Printable-img",ref:function(t){e.myCanvas=t},width:l,height:c,style:p})),n.a.createElement("div",{className:"app-main-editor-Printable-mask _r",style:o}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _b",style:i})),n.a.createElement("div",{className:"app-main-editor-Printable-mask _r",style:{width:"1rem"}}),n.a.createElement("div",{className:"app-main-editor-Printable-mask _b",style:{height:"1rem"}}))}}]),t}(n.a.Component),oe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).sliderChangeBrightness=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,brightness:t})},a.sliderChangeContrast=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,contrast:t})},a.sliderChangeSaturate=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,saturate:t})},a.sliderResetBrightness=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,brightness:1})},a.sliderResetContrast=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,contrast:1})},a.sliderResetSaturate=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,saturate:1})},a.sliderChangeSepia=function(){a.props.appImageChanged(a.props.app.currentImage,{sepia:!a.props.app.images[a.props.app.currentImage].editorState.sepia,colorR:1,colorG:1,colorB:1,needUpdateCanvas:!0})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.app.images[this.props.app.currentImage];return n.a.createElement("div",{className:"h-100 d-flex flex-row"},n.a.createElement("div",{className:"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0"}),n.a.createElement("div",{className:"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1"},n.a.createElement("div",{className:"h-90"},n.a.createElement(se,this.props)),n.a.createElement("div",{className:"app-main-editor-visual-bottom h-10 w-100"})),n.a.createElement("div",{className:"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0"},n.a.createElement("div",{className:"h-75"},n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement(R.a,{className:"_reset",color:"primary",onClick:this.sliderResetBrightness},"brightness_medium"),n.a.createElement(Q.a,{className:"app-slider-for-filter",max:2,value:e.editorState.brightness,min:0,onChange:this.sliderChangeBrightness,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.brightness,")"))),n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement(R.a,{className:"_reset",color:"primary",onClick:this.sliderResetContrast},"tonality"),n.a.createElement(Q.a,{className:"app-slider-for-filter",max:2,value:e.editorState.contrast,min:0,onChange:this.sliderChangeContrast,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.contrast,")"))),n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement(R.a,{className:"_reset",color:"primary",onClick:this.sliderResetSaturate},"color_lens"),n.a.createElement(Q.a,{className:"app-slider-for-filter",max:2,value:e.editorState.saturate,min:0,onChange:this.sliderChangeSaturate,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.saturate,")")))),n.a.createElement("div",{className:"h-25"},n.a.createElement("div",{className:"hori-slider-wrapper w-100 position-relative d-inline-flex"},n.a.createElement(re.a,{control:n.a.createElement(ie.a,{checked:e.editorState.sepia,onChange:this.sliderChangeSepia,value:"true",color:"primary"}),label:"Sepia"})))))}}]),t}(n.a.Component),le=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).sliderChangeColorR=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorR:t})},a.sliderChangeColorG=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorG:t})},a.sliderChangeColorB=function(e,t){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorB:t})},a.sliderResetColorR=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorR:1})},a.sliderResetColorG=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorG:1})},a.sliderResetColorB=function(){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,colorB:1})},a.sliderChangeSepia=function(){a.props.appImageChanged(a.props.app.currentImage,{sepia:!a.props.app.images[a.props.app.currentImage].editorState.sepia,colorR:1,colorG:1,colorB:1,needUpdateCanvas:!0})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.app.images[this.props.app.currentImage];return n.a.createElement("div",{className:"h-100 d-flex flex-row"},n.a.createElement("div",{className:"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0"}),n.a.createElement("div",{className:"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1"},n.a.createElement("div",{className:"h-90"},n.a.createElement(se,this.props)),n.a.createElement("div",{className:"app-main-editor-visual-bottom h-10 w-100"})),n.a.createElement("div",{className:"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0"},n.a.createElement("div",{className:"h-75"},n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement("div",{className:"_reset app-slider-icon",style:{backgroundColor:v.palette.primary.main,color:v.palette.primary.contrastText},onClick:this.sliderResetColorR},"R"),n.a.createElement(Q.a,{className:"app-slider-for-filter",classes:{track:"_trackR",thumb:"_thumbR"},step:.05,max:2,value:e.editorState.colorR,min:0,onChange:this.sliderChangeColorR,disabled:e.editorState.sepia,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.colorR,")"))),n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement("div",{className:"_reset app-slider-icon",style:{backgroundColor:v.palette.primary.main,color:v.palette.primary.contrastText},onClick:this.sliderResetColorG},"G"),n.a.createElement(Q.a,{className:"app-slider-for-filter",classes:{track:"_trackG",thumb:"_thumbG"},step:.05,max:2,value:e.editorState.colorG,min:0,onChange:this.sliderChangeColorG,disabled:e.editorState.sepia,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.colorG,")"))),n.a.createElement("div",{className:"vert-slider-wrapper h-100 position-relative d-inline-flex"},n.a.createElement("div",{className:"_reset app-slider-icon",style:{backgroundColor:v.palette.primary.main,color:v.palette.primary.contrastText},onClick:this.sliderResetColorB},"B"),n.a.createElement(Q.a,{className:"app-slider-for-filter",classes:{track:"_trackB",thumb:"_thumbB"},step:.05,max:2,value:e.editorState.colorB,min:0,onChange:this.sliderChangeColorB,disabled:e.editorState.sepia,vertical:!0}),this.props.app.isDebugShow&&n.a.createElement("div",{className:"_value"},n.a.createElement("small",null,"(",e.editorState.colorB,")")))),n.a.createElement("div",{className:"h-25"},n.a.createElement("div",{className:"hori-slider-wrapper w-100 position-relative d-inline-flex"},n.a.createElement(re.a,{control:n.a.createElement(ie.a,{checked:e.editorState.sepia,onChange:this.sliderChangeSepia,value:"true",color:"primary"}),label:"Sepia"})))))}}]),t}(n.a.Component),ce=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={showTabButton:!0},a.tabChange=function(e){a.props.appImageChanged(a.props.app.currentImage,{needUpdateCanvas:!0,currentTab:e})},a.alignTop=function(){var e=a.props.app.images[a.props.app.currentImage],t=0;90!==e.editorState.imageRotate&&270!==e.editorState.imageRotate||(t=(e.editorState.imgWidth-e.editorState.imgHeight)/2),a.props.appImageChanged(a.props.app.currentImage,{sliderPositionTB:t})},a.alignRight=function(){var e=a.props.app.images[a.props.app.currentImage],t=y(e.width,e.format.dpi)*e.editorState.imageZoom*e.editorState.ratio,r=a.props.app.editorWidth-2*e.editorState.maskLR-t;90!==e.editorState.imageRotate&&270!==e.editorState.imageRotate||(r+=(e.editorState.imgWidth-e.editorState.imgHeight)/2),a.props.appImageChanged(a.props.app.currentImage,{sliderPositionLR:r})},a.alignBottom=function(){var e=a.props.app.images[a.props.app.currentImage],t=y(e.height,e.format.dpi)*e.editorState.imageZoom*e.editorState.ratio,r=a.props.app.editorHeight-2*e.editorState.maskTB-t;90!==e.editorState.imageRotate&&270!==e.editorState.imageRotate||(r-=(e.editorState.imgWidth-e.editorState.imgHeight)/2),a.props.appImageChanged(a.props.app.currentImage,{sliderPositionTB:r})},a.alignLeft=function(){var e=a.props.app.images[a.props.app.currentImage],t=0;90!==e.editorState.imageRotate&&270!==e.editorState.imageRotate||(t-=(e.editorState.imgWidth-e.editorState.imgHeight)/2),a.props.appImageChanged(a.props.app.currentImage,{sliderPositionLR:t})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){this.props.app.images[this.props.app.currentImage].editorState.initedMask||this.props.appImageChanged(this.props.app.currentImage,{needUpdateCanvas:!0,currentTab:0})}},{key:"render",value:function(){var e=this,t=this.props.app.images[this.props.app.currentImage],a=t.editorState.currentTab;return(a<0||a>2)&&(a=0),n.a.createElement("div",{className:"h-100",ref:function(t){e.editorWrapper=t}},n.a.createElement("div",{ref:function(t){e.editorTabs=t},className:"app-main-editor-visual-container-tabs"}),n.a.createElement(W.a,{className:"app-main-editor-visual-container-controls app-bg-e h-100 position-relative"},0===a&&n.a.createElement(te,Object.assign({},this.props,{alignTop:this.alignTop.bind(this),alignRight:this.alignRight.bind(this),alignBottom:this.alignBottom.bind(this),alignLeft:this.alignLeft.bind(this)})),1===a&&n.a.createElement(oe,this.props),2===a&&n.a.createElement(le,this.props),n.a.createElement("div",{onClick:function(){e.setState({showTabButton:!e.state.showTabButton})},className:"app-btn-pie app-main-editor-tabs-pie bg-primary text-light "},n.a.createElement(R.a,null,"settings_brightness")),this.state.showTabButton&&n.a.createElement(G.a,{color:"primary",className:"app-main-editor-tabs-pie-button position-absolute bg-success",style:{right:"1em",bottom:"8em"},onClick:function(){e.tabChange(2)},disabled:!1,"aria-label":"Colors"},n.a.createElement(R.a,null,"tune")),this.state.showTabButton&&n.a.createElement(G.a,{color:"primary",className:"app-main-editor-tabs-pie-button position-absolute bg-success",style:{right:"5.5em",bottom:"5.5em"},onClick:function(){e.tabChange(1)},disabled:!1,"aria-label":"Brightness",type:"button"},n.a.createElement(R.a,null,"brightness_medium")),this.state.showTabButton&&n.a.createElement(G.a,{color:"primary",className:"app-main-editor-tabs-pie-button position-absolute bg-success",style:{right:"8em",bottom:"1em"},onClick:function(){e.tabChange(0)},disabled:!1,"aria-label":"Zoom"},n.a.createElement(R.a,null,"transform")),this.state.showTabButton&&n.a.createElement(G.a,{color:"primary",className:"app-main-editor-tabs-pie-button position-absolute bg-success",style:{right:"1em",bottom:"18em"},onClick:function(){e.props.changeCountImage(e.props.app.currentImage,t.count+1)},disabled:t.count>98,"aria-label":"Increase"},n.a.createElement(R.a,null,"add")),this.state.showTabButton&&n.a.createElement(G.a,{color:"primary",className:"app-main-editor-tabs-pie-button position-absolute bg-success",style:{right:"1em",bottom:"13em"},onClick:function(){e.props.changeCountImage(e.props.app.currentImage,t.count-1)},disabled:t.count<0,"aria-label":"Decrease"},n.a.createElement(R.a,null,"remove"))))}}]),t}(n.a.Component),pe=a(29),me=a.n(pe),de=a(32),ue=a.n(de),he=a(30),ge=a.n(he),ve=a(31),fe=a.n(ve),be=a(34),Ee=a.n(be),Se=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).checkUndo=function(){return!(1===a.undo.history.length||0===a.undo.current)},a.clickUndo=function(){if(!a.checkUndo)return!1;var e=a.undo.history.length-2;a.undo.current>0&&(e=a.undo.current-1),a.props.appImageChanged(a.props.app.currentImage,a.undo.history[e]),a.undo.current=e,a.undo.skipChanges=!0},a.checkRedo=function(){return!(null===a.undo.current||a.undo.current===a.undo.history.length-1)},a.clickRedo=function(){if(!a.checkRedo)return!1;var e=a.undo.current+1;a.props.appImageChanged(a.props.app.currentImage,a.undo.history[e]),a.undo.current=e,a.undo.skipChanges=!0},a.selectImage=function(e){e!==a.props.app.currentImage&&(a.undo={history:[],current:null,skipChanges:!0}),a.props.appSetState({currentImage:e})},a.changeCurrentImage=function(e){var t=a.props.app.currentImage+e;t>=0&&t<a.props.app.images.length&&a.selectImage(t)},a.changeCountImage=function(e,t){if(t>-1){var r=a.props.app.images;r[e].count=t;var n={images:r};0===t&&a.changeCurrentImage(1),a.props.appSetState(n,function(){a.countSumm()})}else a.changeCurrentImage(1),a.props.app.currentImage<a.props.app.images.length-1&&a.props.appSetState({currentImage:a.props.app.currentImage+1})},a.scrollIntoViewIfNeed=function(e){e.scrollIntoViewIfNeeded()},a.openFormatsPanel=function(){a.setState({isFormatsOpen:!a.state.isFormatsOpen})},a.repeatColors=function(){var e=a.getColorsToRepeat();e&&a.props.appImageChanged(a.props.app.currentImage,e)},a.getColorsToRepeat=function(){if(null===a.props.app.currentImage||0===a.props.app.currentImage)return!1;var e=a.props.app.images[a.props.app.currentImage-1].editorState,t=a.props.app.images[a.props.app.currentImage].editorState,r=!1;return e.brightness!==t.brightness&&(r=!0),e.contrast!==t.contrast&&(r=!0),e.saturate!==t.saturate&&(r=!0),e.colorR!==t.colorR&&(r=!0),e.colorG!==t.colorG&&(r=!0),e.colorB!==t.colorB&&(r=!0),!!r&&{brightness:e.brightness,contrast:e.contrast,saturate:e.saturate,colorR:e.colorR,colorG:e.colorG,colorB:e.colorB}},a.undo={history:[],current:null,skipChanges:!0},a.state={confirmBack:!1,imagesCount:0,imagesSum:0},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.selectImage(0),this.countSumm()}},{key:"countSumm",value:function(){for(var e=0,t=0,a=this.props.app.images.length,r=0;r<a;r++)e+=this.props.app.images[r].count,t+=this.props.app.images[r].count*this.props.app.images[r].format.cost;this.setState({imagesCount:e,imagesSum:t})}},{key:"shouldComponentUpdate",value:function(e,t,a){if(this.props.app.images[this.props.app.currentImage].editorState.initedImagePosition&&this.props.app.images[this.props.app.currentImage].editorState.initedMask){var r=!0;if(this.undo.history.length>0)r=!function(){var e,t,a,r;function n(e,t){var i;if(isNaN(e)&&isNaN(t)&&"number"===typeof e&&"number"===typeof t)return!0;if(e===t)return!0;if("function"===typeof e&&"function"===typeof t||e instanceof Date&&t instanceof Date||e instanceof RegExp&&t instanceof RegExp||e instanceof String&&t instanceof String||e instanceof Number&&t instanceof Number)return e.toString()===t.toString();if(!(e instanceof Object&&t instanceof Object))return!1;if(e.isPrototypeOf(t)||t.isPrototypeOf(e))return!1;if(e.constructor!==t.constructor)return!1;if(e.prototype!==t.prototype)return!1;if(a.indexOf(e)>-1||r.indexOf(t)>-1)return!1;for(i in t){if(t.hasOwnProperty(i)!==e.hasOwnProperty(i))return!1;if(typeof t[i]!==typeof e[i])return!1}for(i in e){if(t.hasOwnProperty(i)!==e.hasOwnProperty(i))return!1;if(typeof t[i]!==typeof e[i])return!1;switch(typeof e[i]){case"object":case"function":if(a.push(e),r.push(t),!n(e[i],t[i]))return!1;a.pop(),r.pop();break;default:if(e[i]!==t[i])return!1}}return!0}if(arguments.length<1)return!0;for(e=1,t=arguments.length;e<t;e++)if(a=[],r=[],!n(arguments[0],arguments[e]))return!1;return!0}(this.undo.history[this.undo.history.length-1],this.props.app.images[this.props.app.currentImage].editorState);if((!this.undo.skipChanges||0===this.undo.history.length)&&r){null!==this.undo.current&&(this.undo.history=this.undo.history.slice(0,this.undo.current-1)),this.undo.history.push(Object.assign({},this.props.app.images[this.props.app.currentImage].editorState));if(this.undo.history.length>99){var n=this.undo.history.length-99;this.undo.history=this.undo.history.slice(n,n+99)}this.undo.current=null}this.undo.skipChanges=!1}return!0}},{key:"componentDidUpdate",value:function(e,t,a){this.props.savePages()}},{key:"backPressed",value:function(){this.setState({confirmBack:!0})}},{key:"backConfirmed",value:function(e){e&&this.props.onClickPrevBtn(),this.setState({confirmBack:!1})}},{key:"formatChange",value:function(e){var t=this,a=this.props.app.formats[e],r=this.props.app.currentImage,n=this.props.app.images;n[r].format=a,n[r].editorState.initedMask=!1,n[r].editorState.initedImagePosition=!1,this.props.appSetState({images:n},function(){t.props.appImageInitMask(r,!0,function(){t.props.alignInit(r,function(){t.countSumm()})})}),this.setState({isFormatsOpen:!1})}},{key:"render",value:function(){var e=this,t=this.props.app.images[this.props.app.currentImage],a=t?t.format:{},r=this.state.isFormatsOpen?n.a.createElement(H.a,{onClickAway:function(){e.openFormatsPanel()}},n.a.createElement(W.a,{className:"app-main-change-formats scrollbar position-absolute"},n.a.createElement("table",{className:"table-formats"},this.props.app.formats.map(function(t,a){return t.enabled?n.a.createElement("tbody",{key:a,onClick:function(){return e.formatChange(a)}},n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},t.name),n.a.createElement("th",{scope:"row"},t.height,'"x ',t.width,'"'),n.a.createElement("th",{scope:"row"},Math.round(25.4*t.height),"x",Math.round(25.4*t.width)),n.a.createElement("th",{scope:"row"},P(t.surface)),n.a.createElement("th",{scope:"row"},w(t.cost)))):""})))):null,i=n.a.createElement("div",{className:"app-main-rightwidget h-100 p-2 d-inline-block"},n.a.createElement(W.a,{className:"h-100 p-2 app-bg-e position-relative"},n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-primary",onClick:function(){return e.props.onClickNextBtn()},disabled:!1,title:P("Next"),type:"button"},n.a.createElement(R.a,null,"arrow_forward")," ",P("Next"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-big btn-primary",onClick:this.backPressed.bind(this),disabled:!1,title:P("Previous"),type:"button"},n.a.createElement(R.a,null,"arrow_back")," ",P("Previous"))),n.a.createElement("div",{className:"_fabwrapper"},n.a.createElement("button",{className:"btn btn-light mr-2",onClick:this.repeatColors.bind(this),disabled:!this.getColorsToRepeat(),title:P("repeat color settings"),type:"button"},n.a.createElement(R.a,null,"compare")),n.a.createElement("button",{className:"btn btn-light mr-2",onClick:this.clickUndo.bind(this),disabled:!this.checkUndo(),title:P("Undo"),type:"button"},n.a.createElement(R.a,null,"undo")),n.a.createElement("button",{className:"btn btn-light mr-2",onClick:this.clickRedo.bind(this),disabled:!this.checkRedo(),title:P("Redo"),type:"button"},n.a.createElement(R.a,null,"redo"))),n.a.createElement("div",{className:"app-main-rightwidget-tablewrp"},r,n.a.createElement(G.a,{color:"primary",className:"app-main-change-formats-button position-absolute text-primary bg-light",style:{right:"0",bottom:"100%"},onClick:function(){e.openFormatsPanel()},"aria-label":"Colors"},n.a.createElement(R.a,null,"menu")),n.a.createElement("table",{className:"table"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"row",colSpan:2},P("Format")," ",a.name)),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row",colSpan:2},a.height,'"x ',a.width,'" ',Math.round(25.4*a.height),"x",Math.round(25.4*a.width))),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},P("Files")),n.a.createElement("th",{scope:"row"},this.props.app.images.length," / ",this.state.imagesCount)),n.a.createElement("tr",null,n.a.createElement("th",{scope:"row"},P("Cost")),n.a.createElement("th",{scope:"row"},w(this.state.imagesSum)))))))),s=n.a.createElement(me.a,{open:this.state.confirmBack,onClose:function(){return e.backConfirmed(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},n.a.createElement(Ee.a,{id:"alert-dialog-title"},P("Warning")),n.a.createElement(ge.a,null,n.a.createElement(fe.a,{id:"alert-dialog-description"},P("Current state of editor images will be lost.")," ",P("Are you sure?"))),n.a.createElement(ue.a,null,n.a.createElement("button",{onClick:function(){return e.backConfirmed(!0)},className:"btn btn-big btn-light",autoFocus:!0},P("OK")),n.a.createElement("button",{onClick:function(){return e.backConfirmed(!1)},className:"btn btn-big btn-primary"},P("Cancel"))));return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-start w-100 h-100"},n.a.createElement("div",{style:{display:"none",visibility:"hidden"}},n.a.createElement("canvas",{ref:function(t){e.processCanvasNode=t}})),n.a.createElement("div",{className:"app-main h-75"},n.a.createElement("div",{className:"app-main-selectors w-100 h-100"},n.a.createElement("div",{className:"app-main-editor-wrapper h-100 p-2 d-inline-block"},n.a.createElement("div",{className:" h-100 position-relative"},null!==this.props.app.currentImage&&n.a.createElement(ce,Object.assign({changeCountImage:this.changeCountImage.bind(this),processCanvas:this.processCanvasNode,onMessage:this.props.onMessage},this.props)))),i)),n.a.createElement(W.a,{className:"app-bottomframe h-25 p-2 position-relative app-bg-e"},n.a.createElement("div",{className:"app-bottom-thumblist-button"},n.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:0===this.props.app.currentImage,onClick:function(){e.changeCurrentImage(-1)}},n.a.createElement(R.a,null,"navigate_before"))),n.a.createElement("div",{className:"scrollbar _horizontal h-100 w-100"},n.a.createElement("div",{id:"listImages",className:"app-bottom-thumblist h-100 p-2"},this.props.app.images.map(function(t,a){return n.a.createElement(J,Object.assign({key:a,image:t,itemIndex:a,selected:e.props.app.currentImage===a,onSelect:function(){return e.selectImage(a)},scrollIntoView:e.scrollIntoViewIfNeed},e.props))}))),n.a.createElement("div",{className:"app-bottom-thumblist-button"},n.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:this.props.app.currentImage===this.props.app.images.length-1,onClick:function(){e.changeCurrentImage(1)}},n.a.createElement(R.a,null,"navigate_next")))),s)}}]),t}(n.a.Component),Ne=(a(45),function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={editedFormats:null},a.formatNew=function(){var e=a.state.editedFormats.slice();e.length>0?e.push(Object.assign({},e[e.length-1])):e.push({});var t=e.length-1;e[t].name="new format",e[t].enabled=!1,a.setState({editedFormats:e})},a.formatRemove=function(e){var t=a.state.editedFormats;t.splice(e,1),a.setState({editedFormats:t})},a.formatChange=function(e,t,r){var n=a.state.editedFormats,i=!0;switch(t){case"enabled":case"portrait":n[e][t]=!n[e][t];break;case"name":case"height":case"width":case"surface":n[e][t]=r.target.value;break;case"dpi":n[e][t]=w(r.target.value,0);break;case"cost":var s=r.target.value.replace(/,/g,".");n[e][t]=s;break;default:i=!1}i&&a.setState({editedFormats:n})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){for(var e=this.props.app.formats.filter(function(e){return!e.rotated}),t=0;t<e.len;t++)e[t].cost=w(e[t].cost);this.setState({editedFormats:e})}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"formatSave",value:function(){var e=this,t=this.state.editedFormats.slice();console.log(t);for(var a=0;a<t.length;a++)t[a].dpi=Math.max(150,Math.min(w(t[a].dpi,0),1500)),t[a].cost=w(t[a].cost,2);var r=f(),n=new URLSearchParams;n.append("q","setupFormatSave"),n.append("formats",JSON.stringify(t)),n.append("p",this.props.app.isSetupPassword),I.a.post(r,n).then(function(a){200===a.status?""===a.data.error?e.props.appSetState({formats:t},function(){e.props.onMessage(P("successful saved"))}):e.props.onMessage("error :"+a.data.error):console.log("axios.post status ",a.status)})}},{key:"formatMove",value:function(e,t){var a=e+t;if(console.log(a),a<0||a>this.state.editedFormats.length-1)return!1;var r=this.state.editedFormats.slice(),n=r[e];r[e]=r[a],r[a]=n,this.setState({editedFormats:r})}},{key:"render",value:function(){var e=this,t=this.state.editedFormats?this.state.editedFormats:[];return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-setup-formats w-100 h-100"},n.a.createElement("div",{className:"app-setup  h-100"},n.a.createElement("div",{className:"app-setup-main h-100"},n.a.createElement(W.a,{className:"app-setup-formats scrollbar p-2 h-100"},n.a.createElement("div",{className:"app-setup-formats-header"},n.a.createElement("div",{className:"_wrp _wrp_enabled"},n.a.createElement("small",null,"On")),n.a.createElement("div",{className:"_wrp _wrp_name"},n.a.createElement("small",null,P("Name"))),n.a.createElement("div",{className:"_wrp _wrp_dpi"},n.a.createElement("small",null,"DPI")),n.a.createElement("div",{className:"_wrp _wrp_height"},n.a.createElement("small",null,P("Height"))),n.a.createElement("div",{className:"_wrp _wrp_width"},n.a.createElement("small",null,P("Width"))),n.a.createElement("div",{className:"_wrp _wrp_surface"},n.a.createElement("small",null,P("Surface"))),n.a.createElement("div",{className:"_wrp _wrp_cost"},n.a.createElement("small",null,P("Cost"))),n.a.createElement("div",{className:"_wrp _wrp_portrait"},n.a.createElement("small",null,P("Portrait"))),n.a.createElement("div",{className:"_wrp _wrp_movecontrol"}," ")),t.map(function(t,a){return n.a.createElement("div",{key:a,className:"app-setup-format-item"+(t.enabled?"":" _disabled")},n.a.createElement("div",{className:"_wrp _wrp_enabled"},n.a.createElement(ie.a,{checked:t.enabled,onChange:function(t){return e.formatChange(a,"enabled",t)},value:"enabled",color:"primary"})),n.a.createElement("div",{className:"_wrp _wrp_name"},n.a.createElement("input",{type:"text",value:t.name,onChange:function(t){return e.formatChange(a,"name",t)}})),n.a.createElement("div",{className:"_wrp _wrp_dpi"},n.a.createElement("input",{type:"text",value:t.dpi,onChange:function(t){return e.formatChange(a,"dpi",t)}})),n.a.createElement("div",{className:"_wrp _wrp_height"},n.a.createElement("select",{value:t.height,"data-hint":t.height,onChange:function(t){return e.formatChange(a,"height",t)}},[2.5,3.5,4,4.5,5,6,8,10,11,12].map(function(e,t){return n.a.createElement("option",{key:t,value:e},e,'" (',Math.round(25.4*e),")")}))),n.a.createElement("div",{className:"_wrp _wrp_width"},n.a.createElement("select",{value:t.width,onChange:function(t){return e.formatChange(a,"width",t)}},[3.5,5,6,7,8,10,12,14,15,16,17,18].map(function(e,t){return n.a.createElement("option",{key:t,value:e},e,'" (',Math.round(25.4*e),")")}))),n.a.createElement("div",{className:"_wrp _wrp_surface"},n.a.createElement("select",{value:t.surface,onChange:function(t){return e.formatChange(a,"surface",t)}},["glance","matte"].map(function(e,t){return n.a.createElement("option",{key:t,value:e},P(e))}))),n.a.createElement("div",{className:"_wrp _wrp_cost"},n.a.createElement("input",{type:"text",value:t.cost,onChange:function(t){return e.formatChange(a,"cost",t)}})),n.a.createElement("div",{className:"_wrp _wrp_portrait"},n.a.createElement(ie.a,{checked:t.portrait,onChange:function(t){return e.formatChange(a,"portrait",t)},value:"portrait",color:"primary"})),t.enabled&&n.a.createElement("div",{className:"_wrp _wrp_movecontrol"},n.a.createElement("div",null,n.a.createElement(R.a,{className:"text-primary",onClick:function(){e.formatMove(a,-1)}},"arrow_upward")),n.a.createElement("div",null,n.a.createElement(R.a,{className:"text-primary",onClick:function(){e.formatMove(a,1)}},"arrow_downward"))),!t.enabled&&n.a.createElement("div",{className:"_wrp _wrp_movecontrol"},n.a.createElement(G.a,{className:"app-setup-format-item-remove",onClick:function(){return e.formatRemove(a)},color:"secondary","aria-label":"Remove",size:"small"},n.a.createElement(R.a,null,"delete"))),n.a.createElement("hr",null))}),n.a.createElement("div",{className:"app-setup-format-new"},n.a.createElement("button",{className:"btn btn-primary",onClick:this.formatNew,disabled:!1,title:"newFormat",type:"button"},n.a.createElement(R.a,null,"add")),n.a.createElement("span",{className:"float-right"},n.a.createElement("button",{className:"btn btn-success ",onClick:this.formatSave.bind(this),disabled:!1,title:"Save",type:"button"},n.a.createElement(R.a,null,"save"))))))))}}]),t}(n.a.Component)),ke=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={arhives:[],currentArchive:null,isLoading:!1,archiveFiles:[],currentArchiveFile:null,isMultipleSelectOrders:!1,isDeleteConfirmation:0},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadList()}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"loadList",value:function(){var e=this;if(!this.state.isLoading){var t=f({q:"loadArchives",p:this.props.app.isSetupPassword});this.setState({arhives:[],currentArchive:null,archiveFiles:[],isLoading:!0}),I.a.get(t).then(function(t){if(200===t.status&&""===t.data.error&&t.data.data){var a=t.data.data.map(function(e){return{folder:e,selected:!1}});e.setState({arhives:a})}e.setState({isLoading:!1})})}}},{key:"tryDeleteArchive",value:function(){var e=0;if(this.state.isMultipleSelectOrders){var t=this.state.arhives.filter(function(e){return e.selected});console.log(t),e=t.length}e>0&&this.setState({isDeleteConfirmation:e})}},{key:"deleteArchive",value:function(){if(this.state.isMultipleSelectOrders)for(var e=this.state.arhives.length,t=0;t<e;t++)this.state.arhives[t].selected&&this._remove(this.state.arhives[t].folder);this.setState({isDeleteConfirmation:0,isMultipleSelectOrders:!1,currentArchive:null,archiveFiles:[]})}},{key:"_remove",value:function(e){var t=this,a=f({q:"removeArchive",folder:e,p:this.props.app.isSetupPassword});I.a.get(a).then(function(e){200===e.status&&""===e.data.error&&t.loadList()})}},{key:"toggleMultiple",value:function(){var e=!this.state.isMultipleSelectOrders;if(e)this.setState({isMultipleSelectOrders:e});else{for(var t=this.state.arhives.slice(),a=t.length,r=0;r<a;r++)t[r].selected=!1;this.setState({arhives:t,isMultipleSelectOrders:e})}}},{key:"selectArchive",value:function(e){var t=this;if(this.state.isMultipleSelectOrders){var a=this.state.arhives.slice();a[e].selected=!a[e].selected,this.setState({arhives:a,currentArchive:e})}else this.setState({currentArchive:e});if(e!==this.state.currentArchive){var r=f({q:"loadArchive",folder:this.state.arhives[e].folder,p:this.props.app.isSetupPassword});this.setState({archiveFiles:[],isLoading:!0}),I.a.get(r).then(function(e){200===e.status&&""===e.data.error&&e.data.data&&t.setState({archiveFiles:e.data.data}),t.setState({isLoading:!1,currentArchiveFile:null})})}}},{key:"selectFile",value:function(e){this.setState({currentArchiveFile:e})}},{key:"render",value:function(){for(var e=this,t=0,a=0,r="",i=this.state.archiveFiles.length,s=0;s<i;s++)t+=this.state.archiveFiles[s].count,a+=this.state.archiveFiles[s].format.cost*this.state.archiveFiles[s].count,r=this.state.archiveFiles[s].date+" "+this.state.archiveFiles[s].time;var o=null;this.state.currentArchiveFile>=0&&this.state.archiveFiles[this.state.currentArchiveFile]&&(o=this.state.archiveFiles[this.state.currentArchiveFile]);var l=this.state.isMultipleSelectOrders,c=0;if(l){var p=this.state.arhives.filter(function(e){return e.selected});console.log(p),c=p.length}return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-setup-formats w-100 h-100"},n.a.createElement("div",{className:"app-setup  h-100"},n.a.createElement("div",{className:"app-setup-main h-100"},n.a.createElement(W.a,{className:"app-setup-arhives p-2 h-100 w-100 d-flex flex-column"},n.a.createElement("div",{className:"_listswrp flex-grow-1 h-75"},n.a.createElement("div",{className:"h-100 d-flex flex-row"},n.a.createElement("div",{className:"app-setup-archives-list scrollbar flex-grow-0 border position-relative"},this.state.isLoading&&n.a.createElement("div",{className:"spinner-border text-primary position-absolute",role:"status"},n.a.createElement("span",{className:"sr-only"}," Loading...")),this.state.arhives.map(function(t,a){return n.a.createElement("div",{key:a,className:"_item"+(a===e.state.currentArchive?" bg-primary text-light":" bg-light"),onClick:function(){e.selectArchive(a)}},l&&n.a.createElement(R.a,{fontSize:"inherit",className:"text-success"},t.selected?"check_circle":"radio_button_unchecked"),t.folder)})),n.a.createElement("div",{className:"app-setup-archive-files scrollbar flex-grow-0 border position-relative"},this.state.isLoading&&n.a.createElement("div",{className:"spinner-border text-primary position-absolute",role:"status"},n.a.createElement("span",{className:"sr-only"}," Loading...")),this.state.archiveFiles.map(function(t,a){return n.a.createElement("div",{key:a,className:"_item"+(a===e.state.currentArchiveFile?" bg-primary text-light":" bg-light"),onClick:function(){e.selectFile(a)}},t.name)})),n.a.createElement("div",{className:"app-setup-archive-fileview flex-grow-1 border h-100"},n.a.createElement("div",{className:"d-flex flex-column h-100"},n.a.createElement("div",{className:"_view-img border bg-light flex-grow-1",style:{backgroundImage:o?"url('"+f()+o.file+"')":""}}," "),n.a.createElement("div",{className:"_infobottom flex-grow-0"},n.a.createElement("table",{className:"table"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"col",colSpan:"2"},P("Format")),n.a.createElement("th",{scope:"col"},P("Amount")),n.a.createElement("th",{scope:"col"},P("Date")),n.a.createElement("th",{scope:"col"},P("Prints")),n.a.createElement("th",{scope:"col"},P("Total")))),n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",null,o?o.format.name+" "+o.format.width+'"x'+o.format.height+'"':""),n.a.createElement("td",null,o?Math.round(25.4*o.format.height)+"x"+Math.round(25.4*o.format.width)+" , "+P(o.format.surface):""),n.a.createElement("td",null,o?o.count:""),n.a.createElement("td",null,o?o.date+" "+o.time:r),n.a.createElement("td",null,t),n.a.createElement("td",null,w(a)))))))))),n.a.createElement("div",{className:"_btnswrp flex-grow-0"},n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-success btn ",onClick:function(){e.loadList()},title:"sample",type:"button"},n.a.createElement(R.a,null,"refresh"))),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn"+(l?" btn-outline-success":" btn-outline-secondary"),onClick:function(){e.toggleMultiple()},title:"multiple",type:"button"},n.a.createElement(R.a,null,"filter_none"))),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-success btn ",onClick:function(){e.tryDeleteArchive()},disabled:0===c,title:"Delete",type:"button"},n.a.createElement(R.a,null,"delete_forever"))))))),n.a.createElement(me.a,{open:this.state.isDeleteConfirmation>0,onClose:function(){return e.setState({isDeleteConfirmation:0})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},n.a.createElement(Ee.a,{id:"alert-dialog-title"},P("Warning")),n.a.createElement(ge.a,null,n.a.createElement(fe.a,{id:"alert-dialog-description"},P("You are selected archives to remove:")," ",n.a.createElement("span",{className:"text-center text-dark",style:{fontSize:"1.4em"}},this.state.isDeleteConfirmation>0?this.state.isDeleteConfirmation:""),n.a.createElement("br",null),P("Are you sure?"))),n.a.createElement(ue.a,null,n.a.createElement("button",{onClick:function(){return e.deleteArchive()},className:"btn btn-big btn-light"},P("OK")),n.a.createElement("button",{onClick:function(){return e.setState({isDeleteConfirmation:0})},className:"btn btn-big btn-primary",autoFocus:!0},P("Cancel")))))}}]),t}(n.a.Component),ye=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={editedSources:a.props.app.sources.slice(),listIcons:[],listScripts:[],scriptTxt:!1},a.sourceNew=function(){var e=a.state.editedSources.slice();e.push(Object.assign({},e[0]));var t=e.length-1;e[t].name="new source",e[t].enabled=!1,a.setState({editedSources:e})},a.sourceRemove=function(e){var t=a.state.editedSources;t.splice(e,1),a.setState({editedSources:t})},a.sourceChange=function(e,t,r){var n=a.state.editedSources,i=!0;switch(t){case"enabled":case"emptyhide":case"autoclear":n[e][t]=!n[e][t];break;case"name":case"path":case"icon":case"scripton":case"scriptoff":n[e][t]=r.target.value;break;default:i=!1}i&&a.setState({editedSources:n})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.editedSources||this.setState({editedSources:this.props.app.sources.slice()});var t=f({q:"setupSourcesListIcons",p:this.props.app.isSetupPassword});I.a.get(t).then(function(t){200===t.status&&""===t.data.error&&t.data.data&&e.setState({listIcons:t.data.data})}),t=f({q:"setupSourcesListScripts",p:this.props.app.isSetupPassword}),I.a.get(t).then(function(t){200===t.status&&""===t.data.error&&t.data.data&&e.setState({listScripts:t.data.data})})}},{key:"viewScript",value:function(e){for(var t=!1,a=this.state.listScripts.length,r=0;r<a;r++)if(console.log(this.state.listScripts[r].name,e),this.state.listScripts[r].name===e){console.log("gotcha"),t=this.state.listScripts[r].script;break}this.setState({scriptTxt:t})}},{key:"componentDidUpdate",value:function(e,t,a){}},{key:"sourcesSave",value:function(){var e=this,t=this.state.editedSources,a=f(),r=new URLSearchParams;r.append("q","setupSourcesSave"),r.append("sources",JSON.stringify(t)),r.append("p",this.props.app.isSetupPassword),I.a.post(a,r).then(function(a){200===a.status?""===a.data.error?e.props.appSetState({sources:t},function(){e.props.onMessage(P("successful saved"))}):e.props.onMessage("error :"+a.data.error):console.log("axios.post status ",a.status)})}},{key:"sourceMove",value:function(e,t){var a=e+t;if(console.log(a),a<0||a>this.state.editedSources.length-1)return!1;var r=this.state.editedSources.slice(),n=r[e];r[e]=r[a],r[a]=n,this.setState({editedSources:r})}},{key:"render",value:function(){var e=this,t=this.state.editedSources?this.state.editedSources:[],a=this.state.listIcons,r=this.state.listScripts;return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-setup-formats w-100 h-100"},n.a.createElement("div",{className:"app-setup  h-100"},n.a.createElement("div",{className:"app-setup-main h-100"},n.a.createElement(W.a,{className:"app-setup-sources scrollbar p-2 h-100"},n.a.createElement("div",{className:"app-setup-sources-header"},n.a.createElement("div",{className:"_wrp _wrp_enabled"},n.a.createElement("small",null,"On")),n.a.createElement("div",{className:"_wrp _wrp_name"},n.a.createElement("small",null,P("Name"))),n.a.createElement("div",{className:"_wrp _wrp_icondisplay"}," "),n.a.createElement("div",{className:"_wrp _wrp_path"},n.a.createElement("small",null,P("Path"))),n.a.createElement("div",{className:"_wrp _wrp_scripton"},n.a.createElement("small",null,P("Script ON / OFF"))),n.a.createElement("div",{className:"_wrp _wrp_emptyhide"},n.a.createElement("small",null,P("Emptyhide"))),n.a.createElement("div",{className:"_wrp _wrp_autoclear"},n.a.createElement("small",null,P("Autoclear"))),n.a.createElement("div",{className:"_wrp _wrp_movecontrol"}," ")),t.map(function(t,i){return n.a.createElement("div",{key:i,className:"app-setup-source-item"+(t.enabled?"":" _disabled")},n.a.createElement("div",{className:"_wrp _wrp_enabled"},n.a.createElement(ie.a,{checked:t.enabled,onChange:function(t){return e.sourceChange(i,"enabled",t)},value:"enabled",color:"primary"})),n.a.createElement("div",{className:"_wrp _wrp_name"},n.a.createElement("div",null,n.a.createElement("input",{type:"text",value:t.name,onChange:function(t){return e.sourceChange(i,"name",t)},className:"w-100"})),n.a.createElement("div",null,n.a.createElement("select",{value:t.icon,"data-value":t.icon,onChange:function(t){return e.sourceChange(i,"icon",t)},className:"w-100"},a.map(function(e,t){return n.a.createElement("option",{key:t,value:e},e.replace(/^.*[\\\/]/,""))})))),n.a.createElement("div",{className:"_wrp _wrp_icondisplay",style:{backgroundImage:t.icon?"url("+f()+t.icon+")":""}}," "),n.a.createElement("div",{className:"_wrp _wrp_path"},n.a.createElement("input",{type:"text",value:t.path,onChange:function(t){return e.sourceChange(i,"path",t)},className:"w-100"})),n.a.createElement("div",{className:"_wrp _wrp_scripton"},n.a.createElement("div",null,n.a.createElement("select",{value:t.scripton,onChange:function(t){return e.sourceChange(i,"scripton",t)}},n.a.createElement("option",{key:"d",value:""},P("---")),r.map(function(e,t){return n.a.createElement("option",{key:t,value:e.name},e.name)})),n.a.createElement(R.a,{onClick:function(){e.viewScript(t.scripton)},className:"text-success"},"description")),n.a.createElement("div",null,n.a.createElement("select",{value:t.scriptoff,onChange:function(t){return e.sourceChange(i,"scriptoff",t)}},n.a.createElement("option",{key:"d",value:""},P("---")),r.map(function(e,t){return n.a.createElement("option",{key:t,value:e.name},e.name)})),n.a.createElement(R.a,{onClick:function(){e.viewScript(t.scriptoff)},className:"text-warning"},"description"))),n.a.createElement("div",{className:"_wrp _wrp_emptyhide"},n.a.createElement(ie.a,{checked:t.emptyhide,onChange:function(t){return e.sourceChange(i,"emptyhide",t)},value:"emptyhide",color:"primary"})),n.a.createElement("div",{className:"_wrp _wrp_autoclear"},n.a.createElement(ie.a,{checked:t.autoclear,onChange:function(t){return e.sourceChange(i,"autoclear",t)},value:"autoclear",color:"primary"})),t.enabled&&n.a.createElement("div",{className:"_wrp _wrp_movecontrol"},n.a.createElement("div",null,n.a.createElement(R.a,{className:"text-primary",onClick:function(){e.sourceMove(i,-1)}},"arrow_upward")),n.a.createElement("div",null,n.a.createElement(R.a,{className:"text-primary",onClick:function(){e.sourceMove(i,1)}},"arrow_downward"))),!t.enabled&&n.a.createElement("div",{className:"_wrp _wrp_movecontrol"},n.a.createElement(G.a,{className:"app-setup-format-item-remove",onClick:function(){return e.sourceRemove(i)},color:"secondary","aria-label":"Remove",size:"small"},n.a.createElement(R.a,null,"delete"))),n.a.createElement("hr",null))}),n.a.createElement("div",{className:"app-setup-format-new"},n.a.createElement("button",{className:"btn btn-primary",onClick:this.sourceNew,disabled:!1,title:"newFormat",type:"button"},n.a.createElement(R.a,null,"add")),n.a.createElement("span",{className:"float-right"},n.a.createElement("button",{className:"btn btn-success ",onClick:this.sourcesSave.bind(this),disabled:!1,title:"Save",type:"button"},n.a.createElement(R.a,null,"save"))))))),n.a.createElement(me.a,{open:this.state.scriptTxt,onClose:function(){return e.setState({scriptTxt:null})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",maxWidth:!1},n.a.createElement(ge.a,null,n.a.createElement(fe.a,{id:"alert-dialog-description",className:"app-setup-view-code-wrapper"},n.a.createElement("textarea",{className:"app-setup-view-code",readOnly:!0},this.state.scriptTxt))),n.a.createElement(ue.a,null,n.a.createElement("button",{onClick:function(){return e.setState({scriptTxt:null})},className:"btn btn-primary"},P("Close")))))}}]),t}(n.a.Component),we=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={inputNP:"",inputNP2:"",setup:a.props.app.setup,removeOlder:!(a.props.app.setup.removeArchiveOlder<14||a.props.app.setup.removeArchiveOlder>5e3)},a.inputTyped=function(e,t){var r={};r[t]=e.target.value,a.setState(r)},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"savePass",value:function(){var e=this;if(this.state.inputNP!==this.state.inputNP2)return this.props.onMessage(P("New password and his confirm does not match")),void this.setState({inputNP:"",inputNP2:""});var t=f({q:"setupPasswordSave",value:this.state.inputNP,p:this.props.app.isSetupPassword});I.a.get(t).then(function(t){200===t.status&&(""===t.data.error?(e.props.onMessage(P("New password saved")),e.setState({inputNP:"",inputNP2:""}),e.props.needConfigure&&document.location.reload()):(e.props.onMessage(P("error")+t.data.error),console.log(t.data.error)))})}},{key:"saveParameters",value:function(){var e=this,t=f(),a=new URLSearchParams;a.append("q","setupParametersSave");var r=Object.assign(this.state.setup);(r.removeArchiveOlder<14||r.removeArchiveOlder>5e3)&&(r.removeArchiveOlder=0,this.setState({setup:r,removeOlder:!1})),a.append("setup",JSON.stringify(r)),a.append("p",this.props.app.isSetupPassword),I.a.post(t,a).then(function(t){200===t.status?""===t.data.error?e.props.onMessage(P("Parameters saved")):(e.props.onMessage(P("error")+t.data.error),console.log(t.data.error)):console.log("axios.post status ",t.status)})}},{key:"removeOlderToggle",value:function(){this.setState({removeOlder:!this.state.removeOlder})}},{key:"setupChange",value:function(e,t){var a=Object.assign(this.state.setup),r=!0;switch(e){case"processMode":case"batchSaveMode":case"copiesMode":case"printNaming":case"copiesNaming":case"removeArchiveOlder":a[e]=t.target.value;break;default:r=!1}r&&this.setState({setup:a})}},{key:"render",value:function(){var e=this,t=["_4x6_102x152_glance","_102x152_glance","_4x6_glance","_102x152","_4x6","_4x6_102x152"];return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-setup-formats w-100 h-100"},n.a.createElement("div",{className:"app-setup  h-100"},n.a.createElement("div",{className:"app-setup-main h-100"},n.a.createElement(W.a,{className:"app-setup-formats scrollbar p-4 mr-2"},n.a.createElement("div",{className:"m-2"},this.props.needConfigure&&n.a.createElement("div",{className:"text-center text-danger"},n.a.createElement("strong",null,P("You should setup new password!"))),n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"np"},P("New password")),n.a.createElement("input",{id:"np",type:"text",autoComplete:"off",className:"app-login-pass form-control text-center",value:this.state.inputNP,onChange:function(t){return e.inputTyped(t,"inputNP")},autoFocus:!0})),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"np2"},P("Retype password")),n.a.createElement("input",{id:"np2",type:"text",autoComplete:"off",className:"app-login-pass form-control text-center",value:this.state.inputNP2,onChange:function(t){return e.inputTyped(t,"inputNP2")}})),n.a.createElement("div",{className:"p-2 text-right"},n.a.createElement("button",{className:"btn btn-primary",onClick:this.savePass.bind(this),disabled:!1,title:"save",type:"button"},P("Save")))))),n.a.createElement(W.a,{className:"app-setup-formats scrollbar p-4 mr-2"},n.a.createElement("div",{className:"m-2"},n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"processmode"},P("Process mode")),n.a.createElement("select",{id:"processmode",value:this.state.setup.processMode,onChange:function(t){return e.setupChange("processMode",t)},className:"form-control"},n.a.createElement("option",{key:"frontend",value:"frontend"},"DOESN'T WORK",P("frontend")),n.a.createElement("option",{key:"backend",value:"backend"},P("backend")," (",P("Recomended"),")"))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"batch"},P("Print mode")),n.a.createElement("select",{id:"batch",value:this.state.setup.batchSaveMode,onChange:function(t){return e.setupChange("batchSaveMode",t)},className:"form-control"},n.a.createElement("option",{value:"0"},"DOESN'T WORK ",P("Wait for each file")),n.a.createElement("option",{value:"1"},P("Fast batch on backend")," (",P("Recomended"),")"))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"copiesMode"},P("Print copies")),n.a.createElement("select",{id:"copiesMode",value:this.state.setup.copiesMode,onChange:function(t){return e.setupChange("copiesMode",t)},className:"form-control"},n.a.createElement("option",{value:"1"},P("Make copy for each file")),n.a.createElement("option",{value:"0"},P("Add count to name of file")," (",P("Recomended"),")"))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"printNaming"},P("Print naming")),n.a.createElement("select",{id:"printNaming",value:this.state.setup.printNaming,onChange:function(t){return e.setupChange("printNaming",t)},className:"form-control"},t.map(function(e,t){return n.a.createElement("option",{key:t,value:t},e)}))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"copiesNaming"},P("Copies naming")),n.a.createElement("select",{id:"copiesNaming",value:this.state.setup.copiesNaming,onChange:function(t){return e.setupChange("copiesNaming",t)},className:"form-control"},n.a.createElement("option",{value:"0"},"999_copy2",t[this.state.setup.printNaming]),n.a.createElement("option",{value:"1"},"999",t[this.state.setup.printNaming],"_copy2"),n.a.createElement("option",{value:"2"},"999",t[this.state.setup.printNaming],"_c2"),n.a.createElement("option",{value:"3"},"999_c2",t[this.state.setup.printNaming]))),n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"removeArchiveOlder"},P("Remove archives, older than days")),n.a.createElement(ie.a,{checked:this.state.removeOlder,onChange:function(t){return e.removeOlderToggle()},value:"enabled",color:"primary"}),n.a.createElement("input",{type:"text",value:this.state.setup.removeArchiveOlder,onChange:function(t){return e.setupChange("removeArchiveOlder",t)}})),n.a.createElement("div",{className:"p-2 text-right"},n.a.createElement("button",{className:"btn btn-primary",onClick:this.saveParameters.bind(this),disabled:!1,title:"save",type:"button"},P("Save")))))))))}}]),t}(n.a.Component),Ce=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={currentTab:"archive"},a.openTab=function(e){e!==a.state.currentTab&&a.setState({currentTab:e})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.needConfigure&&this.setState({currentTab:"parameters"})}},{key:"render",value:function(){var e=this,t=null;switch(this.state.currentTab){case"formats":t=n.a.createElement(Ne,Object.assign({key:this.state.currentTab},this.props));break;case"sources":t=n.a.createElement(ye,Object.assign({key:this.state.currentTab},this.props));break;case"parameters":t=n.a.createElement(we,Object.assign({key:this.state.currentTab},this.props));break;default:t=n.a.createElement(ke,Object.assign({key:this.state.currentTab},this.props))}return n.a.createElement("div",{className:"app-page app-bg-e0 app-setup w-100 h-100"},n.a.createElement("div",{className:"app-setup-wrapper h-100"},n.a.createElement("div",{className:"app-setup-main h-85 w-100"},n.a.createElement("div",{className:"app-setup-main-tabcontrol w-15 h-100 d-inline-block p-2"},n.a.createElement(W.a,{className:"_tab-control w-100 h-100 p-2"},n.a.createElement("div",{className:"_menuwrapper"},n.a.createElement("button",{className:"btn "+("formats"===this.state.currentTab?"btn-primary":"btn-outline-primary"),onClick:function(){e.openTab("formats")},type:"button"}," ",P("Formats"))),n.a.createElement("div",{className:"_menuwrapper"},n.a.createElement("button",{className:"btn "+("sources"===this.state.currentTab?"btn-primary":"btn-outline-primary"),onClick:function(){e.openTab("sources")},type:"button"}," ",P("Sources"))),n.a.createElement("div",{className:"_menuwrapper"},n.a.createElement("button",{className:"btn "+("archive"===this.state.currentTab?"btn-primary":"btn-outline-primary"),onClick:function(){e.openTab("archive")},type:"button"}," ",P("Archive"))),n.a.createElement("div",{className:"_menuwrapper"},n.a.createElement("button",{className:"btn "+("parameters"===this.state.currentTab?"btn-primary":"btn-outline-primary"),onClick:function(){e.openTab("parameters")},type:"button"}," ",P("Parameters"))),n.a.createElement("hr",null),n.a.createElement("div",null,n.a.createElement("small",null,n.a.createElement("p",null,P("You should use Chrome-browser as client with parameters:")),n.a.createElement("p",{className:"text-info"},"chrome ",window.location.href," --kiosk  --new-window --start-maximized --disable-extensions --disable-notifications --disable-sync --disable-translate=1"))))),n.a.createElement("div",{className:"app-setup-main-tab w-85 h-100 d-inline-block p-2"},t)),n.a.createElement("div",{className:"app-setup-bottom h-15 p-2"},n.a.createElement(W.a,{className:"app-setup-bottom-buttons text-center h-100 p-2"},n.a.createElement(W.a,{className:"float-left h-100 p-2"},this.props.app.appWidth,"x",this.props.app.appHeight,n.a.createElement("div",null,n.a.createElement("button",{className:"btn btn-light",onClick:function(){window.confirm(P("Refresh application")+"?")&&document.location.reload()},disabled:!1,title:"Refresh",type:"button"},n.a.createElement(R.a,null,"update")," ",this.props.app.version))),!this.props.needConfigure&&n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-primary btn-big",onClick:function(){e.props.Logout()},disabled:!1,title:"Logout",type:"button"},n.a.createElement(R.a,null,"close")))))))}}]),t}(n.a.Component),Ie=(a(252),function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={orderFolder:null,orderNum:null,savingImages:!1,orderPrinted:!1},a.saveImage=function(e){var t=10,r=a.props.app.images.length;e+t>r&&(t=r-e);var n=0,i="";a.state.orderFolder&&(i=a.state.orderFolder),a.savePartialProgress(e,n,t,r);var s=f({q:"orderGetFolder",folder:i});I.a.get(s).then(function(s){200===s.status?""===s.data.error?s.data.data&&(i=s.data.data,a.setState({orderFolder:i,orderNum:s.data.orderNum}),a.props.app.images.slice(e,e+t).forEach(function(s,o){var l=e+o;n++,a.savePartialProgress(e,n,t,r),a.autoInitImage(l,function(){var s=a.props.app.images[l];if(s.count)if("frontend"===a.props.app.setup.processMode)!function(e,t,a,r){var n=t.images[a];if(console.log(n),"function"===typeof r){var i=new Image;i.crossOrigin="anonymous",i.onload=function(){0===n.editorState.imageRotate||180===n.editorState.imageRotate?(e.width=y(n.format.width,n.format.dpi),e.height=y(n.format.height,n.format.dpi)):(e.width=y(n.format.height,n.format.dpi),e.height=y(n.format.width,n.format.dpi));var s=N(t,a),o=e.getContext("2d",{alpha:!1});if(o.fillStyle="#ffffff",o.fillRect(0,0,e.width,e.height),console.log("processImage",s),0!==n.editorState.imageRotate)o.drawImage(i,s.sX,s.sX,s.sW,s.sH,s.cX,s.cY,s.cW,s.cH);else{var l=e.width/-2,c=e.height/-2;if(90===n.editorState.imageRotate||270===n.editorState.imageRotate){var p=e.width;e.width=e.height,e.height=p}o.translate(e.width/2,e.height/2),o.rotate(n.editorState.imageRotate*Math.PI/180),o.drawImage(i,s.sx,s.sy,s.sW,s.sH,l+s.cX,c+s.cY,s.cW,s.cH)}var m=o.getImageData(Math.floor(s.pX),Math.floor(s.pY),Math.ceil(s.pW),Math.ceil(s.pH));1===n.editorState.brightness&&1===n.editorState.contrast&&1===n.editorState.colorR&&1===n.editorState.colorG&&1===n.editorState.colorB||(m=b(m,n.editorState.brightness,n.editorState.contrast,n.editorState.colorR,n.editorState.colorG,n.editorState.colorB)),n.editorState.sepia&&(m=S(m)),1!==n.editorState.saturate&&(m=E(m,n.editorState.saturate)),o.putImageData(m,Math.floor(s.pX),Math.floor(s.pY)),r(e.toDataURL("image/jpeg",.7))},i.src=f()+n.src}}(a.processCanvasNode,a.props.app,l,function(o){var c=f(),p=new URLSearchParams;p.append("q","orderFileWrite"),p.append("folder",i),p.append("image",JSON.stringify(s)),p.append("name",l+1+"."+s.extension),p.append("count",s.count),p.append("copy",a.props.app.setup.copiesMode?a.props.app.setup.copiesMode:1),p.append("data",o),I.a.post(c,p).then(function(i){200===i.status&&(""!==i.data.error&&a.props.onMessage("error "+i.data.error),n++,a.savePartialProgress(e,n,t,r))})});else{var o=N(a.props.app,l),c=f(),p=new URLSearchParams;p.append("q","orderFileToProcess"),"1"===a.props.app.setup.batchSaveMode&&p.append("batch","1"),p.append("folder",i),p.append("name",l+1+"."+s.extension),p.append("image",JSON.stringify(s)),p.append("dimensions",JSON.stringify(o)),p.append("count",s.count),p.append("copy",a.props.app.setup.copiesMode?a.props.app.setup.copiesMode:1),I.a.post(c,p).then(function(i){200===i.status&&(""!==i.data.error&&a.props.onMessage(P("error")+":"+i.data.error),n++,a.savePartialProgress(e,n,t,r))})}else n++,a.savePartialProgress(e,n,t,r)})},Object($.a)(a))):a.props.onMessage(P("error")+":"+s.data.error):(a.props.onMessage(P("error status, let see log")),console.log("error status",s.status))})},a.autoInitImage=function(e,t){var r=a.props.app.images[e];a.props.appImageInitMask(e,!1,function(){r.editorState.initedImagePosition?"function"===typeof t&&t():a.props.alignInit(e,t)})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"savePartialProgress",value:function(e,t,a,r){var n=this;t/=2;var i=Math.ceil((e+t)/r*100),s=e+t>=r;if(s){if(i=-1,"1"===this.props.app.setup.batchSaveMode){var o=f({q:"orderFilesProcessBatch",folder:this.state.orderFolder});I.a.get(o).then(function(e){200===e.status?""!==e.data.error&&n.props.onMessage(P("orderFilesProcessBatch error:")+e.data.error):(n.props.onMessage(P("orderFilesProcessBatch error status, let see log")),console.log(P("orderFilesProcessBatch error status"),e.status))})}}else t>=a&&setTimeout(function(){n.saveImage(e+t)},500);if(this.props.app.progressBarValue!==i){var l=i>-1&&i<99;this.props.appSetState({progressBarValue:i,isPleaseWait:l,savingImages:!s})}s&&this.setState({orderPrinted:!0})}},{key:"checkBeforeSaveImage",value:function(){for(var e=0,t=0;t<this.props.app.images.length;t++)e+=this.props.app.images[t].count;e?this.saveImage(0):this.props.onClickNextBtn()}},{key:"render",value:function(){for(var e=this,t=this.props.app.formats,a=this.props.app.images,r=[],i=t.length,s=function(e){var n=a.filter(function(a){for(var r in a.format)if(void 0===t[e][r]||t[e][r]!==a.format[r])return!1;return!0});r.push(n)},o=0;o<i;o++)s(o);var l=[];i=r.length;for(var c=0,p=0;p<i;p++){var m=r[p];if(m.length>0){for(var d=0,u=0;u<m.length;u++)d+=m[u].count;d>0&&(l.push({format:t[p],count:d}),c+=t[p].cost*d)}}return n.a.createElement("div",{className:"app-page app-bg-e0 app-page-start w-100 h-100"},n.a.createElement("div",{className:"app-print h-90 p-2"},n.a.createElement(W.a,{className:"h-100 w-100 p-2 app-bg-e text-center"},n.a.createElement(W.a,{className:"app-print-costs-paper scrollbar p-2 m-2"},n.a.createElement("table",{className:"table"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{scope:"col",colSpan:"2"},P("Format")),n.a.createElement("th",{scope:"col"},P("Amount")),n.a.createElement("th",{scope:"col"},P("Total"),": ",c))),n.a.createElement("tbody",null,l.map(function(e,t){return n.a.createElement("tr",{key:t},n.a.createElement("td",null,e.format.name," ",e.format.width,'" x',e.format.height,'"'),n.a.createElement("td",null,Math.round(25.4*e.format.height),"x",Math.round(25.4*e.format.width)," , ",P(e.format.surface)),n.a.createElement("td",null,e.count),n.a.createElement("td",null,w(e.format.cost*e.count)))})))),n.a.createElement("div",{className:"app-print-costs-buttons text-center"},n.a.createElement("button",{className:"btn btn-big btn-primary m-2",onClick:function(){e.props.onClickPrevBtn()},disabled:!1,title:P("Previous"),type:"button"},n.a.createElement(R.a,null,"arrow_back")," ",P("Previous")),n.a.createElement("button",{type:"button",className:"btn btn-big btn-success m-2",disabled:this.state.savingImages,onClick:function(){e.checkBeforeSaveImage()}},n.a.createElement(R.a,null,"print")," ",P("Print"))))),n.a.createElement("div",{className:"app-bottomframe w-100 h-10 p-2 position-relative"},n.a.createElement(W.a,{className:"h-100 w-100 p-2 app-bg-e"},this.props.app.progressBarValue>=0&&n.a.createElement("div",{className:"app-bottom-progress h-100 p-2 w-100"},n.a.createElement(A.a,{variant:"determinate",value:this.props.app.progressBarValue})))),n.a.createElement(me.a,{open:this.state.orderPrinted,onClose:this.props.onClickNextBtn,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},n.a.createElement(Ee.a,{id:"alert-dialog-title"},P("Successful printed")),n.a.createElement(ge.a,null,n.a.createElement(fe.a,{id:"alert-dialog-description"},P("The number of your order is"),n.a.createElement("span",{className:"text-center text-dark",style:{fontSize:"1.4em",display:"block"}},this.state.orderNum),P("Dont forget to remove your source."),n.a.createElement("br",null),n.a.createElement("br",null),P("Thank you!"))),n.a.createElement(ue.a,null,n.a.createElement("button",{onClick:this.props.onClickNextBtn,className:"btn btn-big  btn-primary",autoFocus:!0},"OK"))))}}]),t}(n.a.Component)),xe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={pwd:""},a.passTyped=function(e){a.setState({pwd:e.target.value}),a.props.appSetState({isSetupPassword:e.target.value})},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"numbClick",value:function(e){var t=this.state.pwd+""+e;this.setState({pwd:t}),this.props.appSetState({isSetupPassword:t})}},{key:"render",value:function(){var e=this;return!this.props.app.isSetup||this.props.app.isSetupLogged?null:n.a.createElement("div",{className:"app-page-login p-2 w-100 h-100"},n.a.createElement("div",{className:"app-login-wrapper-bkg app-bg-e0 app-page-start p-2 w-100 h-100"}," "),n.a.createElement("div",{className:"app-main app-login-wrapper w-100"},n.a.createElement(W.a,{className:"app-login p-2"},n.a.createElement("form",{onSubmit:function(t){e.setState({pwd:""}),e.props.Login(t)}},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"p"},"Pin"),n.a.createElement("input",{id:"p",type:"text",autoComplete:"off",className:"app-login-pass form-control text-center",value:this.state.pwd,onChange:this.passTyped,autoFocus:!0})),n.a.createElement("div",{className:"numbrow"},n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("7")},type:"button"}," 7")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("8")},type:"button"}," 8")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("9")},type:"button"}," 9"))),n.a.createElement("div",{className:"numbrow"},n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("4")},type:"button"}," 4")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("5")},type:"button"}," 5")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("6")},type:"button"}," 6"))),n.a.createElement("div",{className:"numbrow"},n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("1")},type:"button"}," 1")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("2")},type:"button"}," 2")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("3")},type:"button"}," 3"))),n.a.createElement("div",{className:"numbrow"},n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-success btn-medium btn-3d",disabled:!1,title:"Login",type:"submit"},n.a.createElement(R.a,null,"vpn_key"))),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",disabled:!1,onClick:function(){return e.numbClick("0")},type:"button"}," 0")),n.a.createElement("div",{className:"m-2 d-inline-block"},n.a.createElement("button",{className:"btn btn-medium btn-3d",onClick:function(){e.setState({pwd:""}),e.props.Logout()},disabled:!1,title:"Logout",type:"button"},n.a.createElement(R.a,null,"close"))))))))}}]),t}(n.a.Component),_e=(a(253),function(e){function t(){var e,a;Object(o.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(c.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={caseInfinityLoop:!1},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.tm=setTimeout(function(){e.setState({caseInfinityLoop:!0})},179e3)}},{key:"componentWillUnmount",value:function(){this.tm&&clearTimeout(this.tm)}},{key:"langOnLoad",value:function(e){x(e),this.setState({caseInfinityLoop:!1})}},{key:"render",value:function(){var e=this,t=_();return n.a.createElement("div",{className:"splash-screen app-bg-e"},this.props.serverError||this.state.caseInfinityLoop?n.a.createElement("div",{className:"text-center"},n.a.createElement("div",{className:"splash-screen-text-wrapper error bg-danger text-light pr-5 pl-5"},P("Server error:"),n.a.createElement("br",null),n.a.createElement("br",null),this.props.serverError),n.a.createElement("div",{className:"p-4"},n.a.createElement("button",{className:"btn btn-primary btn-big btn-3d",onClick:function(){document.location.reload()},disabled:!1,title:"Refresh",type:"button"},n.a.createElement(R.a,null,"update")," ",P("Restart")))):n.a.createElement("div",{className:"splash-screen-text-wrapper"},P("Wait a moment while app loading"),n.a.createElement("div",{className:"loading-dot"},".")),n.a.createElement("div",{className:"splash-screen-lang-buttons"},t.map(function(t,a){return n.a.createElement("div",{key:a,className:"m-3 d-inline-block"},n.a.createElement("button",{className:"btn btn-success btn-3d p-3",onClick:function(){return e.langOnLoad(t.key)},disabled:!1,title:"Language",type:"button"},n.a.createElement(R.a,null,"language"),t.caption))})))}}]),t}(n.a.Component)),Pe=a(106),Oe=a.n(Pe),Me=a(107),Re=a.n(Me),Te=a(68),Le=a.n(Te),Be=a(108),je=a.n(Be),Fe=(a(254),a(255),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(c.a)(this,Object(p.a)(t).call(this,e))).state={appstate:"start",pages:{},sources:[],currentSource:null,formats:[],currentFormat:null,images:[],is_loading_init:!1,editorHeight:0,editorWidth:0,snackMessage:null,setup:{batchSaveMode:!1},isAppStarting:!0,isSetup:!1,isSetupLogged:!1,isSetupPassword:"",isUploadEnable:!1,isPleaseWait:!1,progressBarValue:-1,isDebugShow:!1,appWidth:null,appHeight:null,serverError:null,version:d.a},a.appSetState=function(e,t){var r=a.state;for(var n in e)r[n]=e[n];a.setState(r,function(){"function"===typeof t&&t()})},a.appImageChanged=function(e,t,r){var n=a.state.images[e];for(var i in t)n.editorState[i]=t[i];var s=a.state.images;s[e]=n,a.setState({images:s},function(){"function"===typeof r&&r()})},a.appEditorChanged=function(e,t){if(a.state.editorWidth!==e||a.state.editorHeight!==t){for(var r=a.state.images,n=r.length,i=0;i<n;i++)r[i].editorState.initedMask=!1;a.setState({editorWidth:e,editorHeight:t,images:r},function(){a.state.currentImage>=0&&(console.log("try reinit"),a.appImageInitMask(a.state.currentImage,!0))})}},a.appFormatRotate=function(e,t){var r=a.state.currentImage;void 0!==e&&(r=e);var n=a.state.images[r].format.rotated_key;if(a.state.formats[n]){var i=a.state.formats[n],s=a.state.images;s[r].format=i,s[r].editorState.initedMask=!1,s[r].editorState.initedImagePosition=!1,s[r].editorState.imageRotate=0,s[r].editorState.initedFormat=!0,a.appSetState({images:s},function(){a.appImageInitMask(r,!0,t)})}else a.onMessage(P("Error - format does not exist!"))},a.alignInit=function(e,t){console.log("alignInit",e,t);var r=a.state.images[e],n=r.format,i=!1,s=n.width-n.height>1,o=r.width-r.height>1;if(!r.editorState.initedFormat){if(6===r.orientation||8===r.orientation)return void a.appFormatRotate(e,function(){a.alignInit(e,t)});if(s!==o)return void a.appFormatRotate(e,function(){a.alignInit(e,t)})}s!==o&&(i=!0),i?s?a.alignPortrait(e,t,!0,i):a.alignLandscape(e,t,!0,i):s?a.alignLandscape(e,t,!0):a.alignPortrait(e,t,!0)},a.alignLandscape=function(e,t,r,n){var i=a.state.images[e],s=0,o=i.format.width/i.width,l=y(i.width,i.format.dpi)*o*i.editorState.ratio,c=y(i.height,i.format.dpi)*o*i.editorState.ratio,p=a.state.editorHeight-2*i.editorState.maskTB,m=(p-c)/2,d=p>c;if((90===i.editorState.imageRotate||270===i.editorState.imageRotate||n)&&(o=i.format.width/i.height,m=((l=y(i.width,i.format.dpi)*o*i.editorState.ratio)-(c=y(i.height,i.format.dpi)*o*i.editorState.ratio))/2+(p-l)/2,s=(c-l)/2,d=p>l),r&&d)a.alignPortrait(e,t,!1,n);else{var u={imageZoom:o,imageZoomMax:5*o,imageZoomMin:.5*o,sliderPositionTB:m,sliderPositionLR:s,imgWidth:l,imgHeight:c,initedImagePosition:!(0===l&&0===c),needUpdateCanvas:o>i.editorState.imageZoom};n&&(u.imageRotate=90),a.appImageChanged(e,u,t)}},a.alignPortrait=function(e,t,r,n){var i=a.state.images[e],s=0,o=i.format.height/i.height,l=y(i.width,i.format.dpi)*o*i.editorState.ratio,c=y(i.height,i.format.dpi)*o*i.editorState.ratio,p=a.state.editorWidth-2*i.editorState.maskLR,m=(p-l)/2,d=p>l;if((90===i.editorState.imageRotate||270===i.editorState.imageRotate||n)&&(o=i.format.height/i.width,l=y(i.width,i.format.dpi)*o*i.editorState.ratio,m=((c=y(i.height,i.format.dpi)*o*i.editorState.ratio)-l)/2+(p-c)/2,s=(l-c)/2,d=p>c),r&&d)a.alignLandscape(e,t,!1,n);else{var u={imageZoom:o,imageZoomMax:5*o,imageZoomMin:.5*o,sliderPositionTB:s,sliderPositionLR:m,imgWidth:l,imgHeight:c,initedImagePosition:!(0===l&&0===c),needUpdateCanvas:o>i.editorState.imageZoom};n&&(u.imageRotate=90),a.appImageChanged(e,u,t)}},a.checkLoadedState=function(e){console.log("checkLoadedState");for(var t=e.formats.length,a=[],r=0;r<t;r++)void 0===e.formats[r].rotated&&(e.formats[r].rotated=!1,e.formats[r].rotated_key=t+r,a.push({cost:e.formats[r].cost,dpi:e.formats[r].dpi,enabled:!1,rotated:!0,rotated_key:r,height:e.formats[r].width,width:e.formats[r].height,name:"m"+e.formats[r].name}));return e.formats=e.formats.concat(a),e.isUploadEnable=!1,delete e.version,delete e.appWidth,delete e.appHeight,e.isAppStarting=!1,e},a.onMessage=function(e){e&&a.setState({snackMessage:e})},a.onMessageHide=function(){a.setState({snackMessage:null})},a.uploadEnable=function(e){e.preventDefault();var t=f({q:"login",pass:a.state.isSetupPassword});I.a.get(t).then(function(e){200===e.status&&(""===e.data.error?a.setState({isUploadEnable:!0,isSetup:!1}):(console.log(e.data.error),a.Logout()))})},a.Login=function(e){e.preventDefault();var t=f({q:"login",pass:a.state.isSetupPassword});return I.a.get(t).then(function(e){200===e.status&&(""===e.data.error?a.setState({isSetupLogged:!0}):(console.log(e.data.error),a.Logout()))}),!1},a.Logout=function(){var e=a.state.isSetupLogged;a.setState({isSetup:!1,isSetupLogged:!1,isSetupPassword:""},function(){a.savePages(),e&&a.resetApp()})},a.scriptSource=function(e,t){if(e[t]&&""!==e[t]){var a=f({q:"scriptSource",scripts:e[t]});I.a.get(a)}},a.autoclearSource=function(e){if(a.state.sources[e].autoclear){var t=f({q:"autoclearSource",id:e});I.a.get(t)}},a.updateSavePageTimer=null,a.appWrapperNode=null,a.needConfigure=!1,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"appImageInitMask",value:function(e,t,a){var r=this.state.images[e];if(!r.editorState.initedMask||t){var n=0,i=0;(r.format.height&&r.format.width?r.format.height/r.format.width:1)>this.state.editorHeight/this.state.editorWidth?i=(this.state.editorWidth-r.format.width/r.format.height*this.state.editorHeight)/2:n=(this.state.editorHeight-r.format.height/r.format.width*this.state.editorWidth)/2;var s={maskTB:n,maskLR:i,ratio:(this.state.editorHeight-2*n)/y(r.format.height,r.format.dpi),initedMask:!0};this.appImageChanged(e,s,function(){"function"===typeof a&&a()})}else"function"===typeof a&&a()}},{key:"updateDimensions",value:function(){if(this.appWrapperNode){var e=this.appWrapperNode.clientWidth,t=this.appWrapperNode.clientHeight;this.appWrapperNode.clientWidth>this.appWrapperNode.clientHeight&&this.setState({appWidth:e,appHeight:t})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.updateDimensions);var t=f({q:"init"});I.a.get(t).then(function(t){if(200===t.status)if(""===t.data.error){if(t.data.data){var a=e.checkLoadedState(t.data.data);for(var r in t.data.setup)a.setup[r]=t.data.setup[r];e.setState(a,function(){e.updateDimensions(),I.a.get(f({q:"configure"})).then(function(t){200===t.status&&t.data.error&&(e.needConfigure=!0,e.setState({appstate:"setup"}))})})}}else e.setState({serverError:t.data.error});else e.setState({serverError:"Error: server fail"})}).catch(function(t){console.log(t),e.setState({serverError:t.message})})}},{key:"resetApp",value:function(){var e=this,t=f({q:"init",reset:"reset"});I.a.get(t).then(function(t){if(200===t.status&&""===t.data.error&&t.data.data){var a=e.checkLoadedState(t.data.data);for(var r in t.data.setup)a.setup[r]=t.data.setup[r];e.setState(a,function(){e.updateDimensions(),e.savePages()})}})}},{key:"savePages",value:function(e,t,a){var r=this,n=this.state;this.updateSavePageTimer&&clearTimeout(this.updateSavePageTimer),this.updateSavePageTimer=setTimeout(function(){var e=f(),t=new URLSearchParams;t.append("q","saveClientState"),t.append("state",JSON.stringify(n)),I.a.post(e,t).then(function(e){200===e.status&&""===e.data.error&&a&&r.onMessage(a)})},1700)}},{key:"sourceClick",value:function(e){var t=this.state.sources[e];t.enabled&&(!t.emptyhide||t.emptyhide&&t.hasFiles)&&this.setState({currentSource:e})}},{key:"formatClick",value:function(e){this.setState({currentFormat:e})}},{key:"removeTmp",value:function(e){var t=f({q:"removetmp"});I.a.get(t).then(function(t){200===t.status&&""===t.data.error&&"function"===typeof e&&e()})}},{key:"ClickNextBtn",value:function(e){var t=this;switch(this.state.appstate){case"start":this.scriptSource(this.state.sources[this.state.currentSource],"scripton"),this.removeTmp(function(){t.setState({appstate:"loadImages"})});break;case"loadImages":this.scriptSource(this.state.sources[this.state.currentSource],"scriptoff"),this.setState({appstate:"editor",images:e,currentImage:null,isPleaseWait:!1});break;case"editor":this.setState({appstate:"print"},function(){t.savePages()});break;case"print":this.autoclearSource(this.state.currentSource),this.resetApp();break;default:alert("no action")}}},{key:"ClickPrevBtn",value:function(){switch(this.state.appstate){case"loadImages":this.autoclearSource(this.state.currentSource),this.resetApp();break;case"editor":this.scriptSource(this.state.sources[this.state.currentSource],"scripton"),this.setState({appstate:"loadImages"});break;case"print":this.setState({appstate:"editor"});break;default:alert("no action")}}},{key:"render",value:function(){var e=this,t=!!(!this.state.serverError&&this.appWrapperNode&&this.appWrapperNode.clientHeight>this.appWrapperNode.clientWidth),a=n.a.createElement("div",null," "),r=this.state.appstate;if(this.state.isSetupLogged&&(r="setup"),this.state.isAppStarting||t)a=n.a.createElement(_e,{serverError:this.state.serverError});else switch(r){case"setup":a=n.a.createElement(Ce,{app:this.state,onMessage:this.onMessage,appSetState:this.appSetState.bind(this),Logout:this.Logout.bind(this),savePages:this.savePages.bind(this),needConfigure:this.needConfigure});break;case"start":a=n.a.createElement(z,{app:this.state,onMessage:this.onMessage,onClickSource:function(t){return e.sourceClick(t)},onClickFormat:function(t){return e.formatClick(t)},onClickNextBtn:function(){return e.ClickNextBtn()},savePages:this.savePages.bind(this),appSetState:this.appSetState.bind(this)});break;case"loadImages":a=n.a.createElement(V,{app:this.state,onMessage:this.onMessage,onClickNextBtn:this.ClickNextBtn.bind(this),onClickPrevBtn:function(){return e.ClickPrevBtn()},savePages:this.savePages.bind(this),appSetState:this.appSetState.bind(this)});break;case"editor":a=n.a.createElement(Se,{app:this.state,onMessage:this.onMessage,onClickNextBtn:function(){return e.ClickNextBtn()},onClickPrevBtn:function(){return e.ClickPrevBtn()},savePages:this.savePages.bind(this),appSetState:this.appSetState.bind(this),appFormatRotate:this.appFormatRotate.bind(this),appImageInitMask:this.appImageInitMask.bind(this),appEditorChanged:this.appEditorChanged.bind(this),appImageChanged:this.appImageChanged.bind(this),alignInit:this.alignInit.bind(this),alignLandscape:this.alignLandscape.bind(this),alignPortrait:this.alignPortrait.bind(this)});break;case"print":a=n.a.createElement(Ie,{app:this.state,onMessage:this.onMessage,onClickNextBtn:this.ClickNextBtn.bind(this),onClickPrevBtn:function(){return e.ClickPrevBtn()},savePages:this.savePages.bind(this),appSetState:this.appSetState.bind(this),alignInit:this.alignInit.bind(this),alignLandscape:this.alignLandscape.bind(this),alignPortrait:this.alignPortrait.bind(this),appImageInitMask:this.appImageInitMask.bind(this)});break;default:a=n.a.createElement("div",{className:"App"},"Learn React")}var i=this.state.appWidth?this.state.appWidth:"100%",s=this.state.appHeight?this.state.appHeight:"100%";return n.a.createElement("div",{ref:function(t){e.appWrapperNode=t},style:{width:i,height:s},className:"app-wrapper"},n.a.createElement(Oe.a,null),n.a.createElement(u.MuiThemeProvider,{theme:v},n.a.createElement(xe,{app:this.state,appSetState:this.appSetState.bind(this),Login:1===this.state.isSetup?this.Login.bind(this):2===this.state.isSetup?this.uploadEnable.bind(this):this.Login.bind(this),Logout:this.Logout.bind(this)}),a,n.a.createElement(Re.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:6e3,open:null!==this.state.snackMessage,onClose:this.onMessageHide,ContentProps:{"aria-describedby":"message-id"},message:n.a.createElement("span",{id:"message-id"},this.state.snackMessage),action:[n.a.createElement(Le.a,{key:"close","aria-label":"Close",color:"inherit",className:"classes.close",onClick:this.onMessageHide},n.a.createElement(je.a,null))]}),this.state.isPleaseWait&&n.a.createElement("div",{className:"app-please-wait-wrp position-fixed"},n.a.createElement("div",{onClick:function(){e.setState({isPleaseWait:!1})},className:"app-please-wait spinner-border text-primary",role:"status"},n.a.createElement("span",{className:"sr-only"}," Loading..."))),n.a.createElement(me.a,{open:t,onClose:function(){e.updateDimensions()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},n.a.createElement(Ee.a,{id:"alert-dialog-title"},P("Wrong orientation")),n.a.createElement(ge.a,null,n.a.createElement(fe.a,{id:"alert-dialog-description"},P("Please, turn your device to lanscape"))),n.a.createElement(ue.a,null,n.a.createElement("button",{onClick:function(){e.updateDimensions()},className:"btn btn-big  btn-primary",autoFocus:!0},"OK")))))}}]),t}(n.a.Component));s.a.render(n.a.createElement(Fe,null),document.getElementById("root"))},45:function(e,t,a){},57:function(e,t,a){}},[[109,1,2]]]);
//# sourceMappingURL=main.23721ad1.chunk.js.map