{"version":3,"sources":["tools.js","Components/i18n.js","Components/PageStart/index.js","Components/PageLoadImages/index.js","Components/PageEditor/ImageThumb.js","Components/PageEditor/ImageEditorZoomCanvas.js","Components/PageEditor/ImageEditorZoom.js","Components/PageEditor/ImageEditorColorCanvas.js","Components/PageEditor/ImageEditorBrightness.js","Components/PageEditor/ImageEditorColor.js","Components/PageEditor/ImageEditor.js","Components/PageEditor/index.js","Components/PageSetup/PageSetupFormats.js","Components/PageSetup/PageSetupArchive.js","Components/PageSetup/PageSetupSources.js","Components/PageSetup/PageSetupParameters.js","Components/PageSetup/index.js","Components/PagePrint/index.js","Components/SetupPin.js","Components/LoaderSplashScreen.js","App.js","index.js"],"names":["AJAX_URI","window","location","href","THEME","createMuiTheme","palette","primary","main","makeGetUri","param","str","key","hasOwnProperty","push","encodeURIComponent","uri","join","ColorCorrection","pixelArray","gain","contrast","gainR","gainG","gainB","intercept","i","data","length","saturate","amount","r","g","b","ColorSepia","calculateImageDimensions","app","indexImage","image","images","realRatio","editorState","imageZoom","ratio","viewportWidth","editorWidth","maskLR","viewportHeight","editorHeight","maskTB","sX","sliderPositionLR","sY","sliderPositionTB","sW","imgWidth","sH","imgHeight","imageRotate","centerX","TB","LR","cW","cH","cX","cY","pX","pY","pW","pH","dpi_dots2inch","dots","dpi","undefined","dpi_inch2dots","inch","Round","x","dec","String","replace","parseFloat","isNaN","toFixed","parseInt","setLang","newLang","i18n","LANG","getLangs","langs","prop","caption","langCaption","t","en","ua","Wait a moment while app loading","Cancel","Warning","Next","Previous","Print","Save","Loaded already","Name","Height","Width","Surface","glance","matte","Files","Selected","Cost","Are you sure?","error","error status, let see log","Select CD, flash card or other source, then select format what you want, and press button","Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture","To continue you should select at least one image","Select all","Select none","No images","Current state of editor images will be lost.","Format","Amount","Total","Successful printed","The number of your order is","Dont forget to remove your source.","Thank you!","PageStart","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","clientUploadProgress","progress","percentage","Math","floor","loaded","total","appSetState","progressBarValue","clientUpload","event","formData","FormData","uploadfiles","target","files","isPleaseWait","config","onUploadProgress","Ev","headers","Content-Type","append","axios","post","tools","q","p","isSetupPassword","then","checkSources","catch","console","log","finally","openLangsPanel","setState","isLangsOpen","state","checkSourceTimer","checkSourceTimerMax","checkSourceTimerCount","clearTimeout","_this2","sources","slice","len","hasFiles","prevProps","prevState","snapshot","isUploadEnable","inputUpload","click","initRefresh","_this3","_loop","enabled","emptyhide","id","get","res","status","setTimeout","bind","_this4","langsList","react_default","a","createElement","ClickAwayListener_default","onClickAway","Paper_default","className","map","lang","index","onClick","scope","Icon_default","source","Card_default","currentSource","onClickSource","CardContent_default","src","icon","alt","name","formats","format","currentFormat","onClickFormat","height","width","round","surface","cost","disabled","onClickNextBtn","type","style","minWidth","title","isSetup","version","htmlFor","ref","input","multiple","onChange","e","LinearProgress_default","variant","value","React","Component","resetState","folders","tree","currentFolder","is_loadind_images","expandedImage","progressAjax","previewMaxResize","isAutoclearLoading","isAutoclearLoaded","PageLoadImages","nextPage","selectedimages","filter","marked","dirs","dir","params","URLSearchParams","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","_d","err","return","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_f","onDownloadProgress","progressEvent","percentCompleted","lengthComputable","thumbname","thumbs","substr","lastIndexOf","extension","width_pixel","height_pixel","orientation","thumb","works","count","imageZoomMax","imageZoomMin","colorR","colorG","colorB","brightness","sepia","initedImagePosition","initedMask","currentTab","response","responderEnd","onMessage","imagesContainer","isAutoclearTimer","autoclear","onClickDir","direction","scrollTop","scrollHeight","rowH","ceil","currentDir","list","level","_L","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","precache","imagesScroll","reopenThumb","_this5","newIm","reopen","mode","changed","children","viewHeight","clientHeight","is_appeared","rect","getBoundingClientRect","bottom","top","_this6","node","onScroll","PageLoadImages_ImagePreview","assign","itemIndex","onExpand","showExpandImg","onMark","MarkImage","setpreviewMaxResize","role","onClickPrevBtn","scrollImages","markAllImages","PageLoadImages_ModalExpand","itemCurrent","itemPrev","itemNext","onClose","hideExpandImg","ImagePreview","_this7","rotate","imgWrapper","clientWidth","imgStyle","backgroundImage","max","onDoubleClick","Fab_default","stopPropagation","aria-label","PureComponent","ModalExpand","_this8","imgsrc","ImageThumb","nodeThumb","scrollRef","thumbWidth","selected","scrollIntoView","boxStyles","styles","clrZoom","clrFilters","clrColors","onSelect","encodeURI","backgroundColor","color","contrastText","fontSize","ImageEditorZoomCanvas","onDragStart","preventDefault","movingStart","dragImage","dragX","dragY","movingOn","screenX","screenY","shiftX","shiftY","currentImage","appImageChanged","movingStop","canvasImg","Image","crossOrigin","_upd","updateCanvas","assertThisInitialized","onload","renderedImageIndex","imgSrc","appEditorChanged","myImgContainer","img_src","alignInit","appImageInitMask","myCanvas","ctx","getContext","canvasX","canvasY","drawImage","getImageData","putImageData","isDebugShow","_calculateImageDimens","z","lineWidth","strokeStyle","strokeRect","w","newImage","rL","rR","rT","rB","maskTBStyle","viewportStyles","left","maskLRStyle","canvasWidth","canvasHeight","canvasStyle","transform","onMouseMove","onMouseUp","draggable","onMouseDown","ImageEditorZoom","sliderZoom","L","T","newState","needUpdateCanvas","sliderChangeTB","sliderChangeLR","Slider_default","classes","vertical","min","ImageEditorZoomCanvas_ImageEditorZoomCanvas","trackAfter","alignTop","alignLeft","alignLandscape","alignPortrait","alignRight","alignBottom","ImageEditorColorCanvas","fakeThins","ImageEditorBrightness","sliderChangeBrightness","sliderChangeContrast","sliderChangeSaturate","sliderResetBrightness","sliderResetContrast","sliderResetSaturate","sliderChangeSepia","ImageEditorColorCanvas_ImageEditorColorCanvas","FormControlLabel_default","control","Switch_default","checked","label","sliderChangeColorR","sliderChangeColorG","sliderChangeColorB","sliderResetColorR","sliderResetColorG","sliderResetColorB","track","step","ImageEditor","editorControlsStyle","showTabButton","tabChange","editorWrapper","editorTabs","ImageEditorZoom_ImageEditorZoom","ImageEditorBrightness_ImageEditorBrightness","ImageEditorColor_ImageEditorBrightness","right","changeCountImage","PageEditor","checkUndo","undo","history","current","clickUndo","currentUndo","skipChanges","checkRedo","clickRedo","selectImage","changeCurrentImage","newCurrent","countSumm","scrollIntoViewIfNeed","domNode","scrollIntoViewIfNeeded","openFormatsPanel","isFormatsOpen","repeatColors","colors","getColorsToRepeat","hasChange","confirmBack","imagesCount","imagesSum","nextProps","nextState","nextContext","wasChanged","l","leftChain","rightChain","compare2Objects","y","Date","RegExp","Number","toString","isPrototypeOf","constructor","prototype","indexOf","pop","arguments","start","savePages","back","formatsList","formatChange","display","visibility","processCanvasNode","ImageEditor_ImageEditor","processCanvas","backPressed","colSpan","ImageThumb_ImageThumb","Dialog_default","open","backConfirmed","aria-labelledby","aria-describedby","DialogTitle_default","DialogContent_default","DialogContentText_default","DialogActions_default","autoFocus","PageSetupFormats","editedFormats","formatNew","last","formatRemove","splice","ev","JSON","stringify","shift","newIndex","tmp","data-hint","h","portrait","formatMove","size","formatSave","PageSetupArchive","arhives","currentArchive","isLoading","archiveFiles","currentArchiveFile","isMultipleSelectOrders","isDeleteConfirmation","loadList","d","folder","archCount","as","_remove","archiveCount","archiveTotal","archiveFile","selectedArchiveCount","selectArchive","f","selectFile","file","date","time","toggleMultiple","tryDeleteArchive","deleteArchive","PageSetupSources","editedSources","listIcons","listScripts","scriptTxt","sourceNew","sourceRemove","sourceChange","script","data-value","path","scripton","viewScript","scriptoff","sourceMove","sourcesSave","maxWidth","readOnly","PageSetupParameters","inputNP","inputNP2","setup","removeOlder","removeArchiveOlder","inputTyped","namingOption","autoComplete","savePass","processMode","setupChange","batchSaveMode","copiesMode","printNaming","n","copiesNaming","removeOlderToggle","saveParameters","PageSetup","openTab","tab","PageSetupFormats_PageSetupFormats","PageSetupSources_PageSetupSources","PageSetupParameters_PageSetupParameters","PageSetupArchive_PageSetupArchive","appWidth","appHeight","confirm","document","reload","Logout","PagePrint","orderFolder","orderNum","savingImages","orderPrinted","saveImage","first","party","imageslen","processed","savePartialProgress","forEach","autoInitImage","canvas","fn_callback","img","alpha","fillStyle","fillRect","zX","zY","translate","PI","sx","sy","toDataURL","DataURL","job_done","temporary","_flen","ims","summary","totalSum","cnt","j","sum","checkBeforeSaveImage","SetupPin","passTyped","isSetupLogged","onSubmit","Login","LoaderSplashScreen","caseInfinityLoop","tm","serverError","langOnLoad","App","appstate","pages","is_loading_init","snackMessage","isAppStarting","stateToSave","initrotate","format_lanscape","init","viewportY","isWhiteFields","viewportX","checkLoadedState","msg","onMessageHide","uploadEnable","pass","scriptSource","s_key","scripts","autoclearSource","source_id","updateSavePageTimer","appWrapperNode","force","removeEventListener","updateDimensions","addEventListener","message","reset","pageid","pagestate","OKmessage","newAppState","args","removeTmp","resetApp","alert","wrongOrientation","toRenderd","LoaderSplashScreen_LoaderSplashScreen","PageSetup_PageSetup","PageStart_PageStart","sourceClick","formatClick","ClickNextBtn","PageLoadImages_PageLoadImages","ClickPrevBtn","PageEditor_PageEditor","PagePrint_PagePrint","CssBaseline_default","core_styles","theme","SetupPin_SetupPin","Snackbar_default","anchorOrigin","horizontal","autoHideDuration","ContentProps","action","IconButton_default","Close_default","ReactDOM","render","src_App_0","getElementById"],"mappings":"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","file":"static/js/main.7ea6512b.chunk.js","sourcesContent":["import { createMuiTheme } from '@material-ui/core/styles';\r\n\r\n// must have finishing slash\r\nexport const AJAX_URI = (window.location.href!=='http://localhost:3000/') ? '/server/' : 'http://altpicture.local/server/';\r\n\r\n\r\nexport const THEME = createMuiTheme({\r\n    palette: {\r\n        primary: {\r\n            main:'#007bff',\r\n        },\r\n    }\r\n});\r\n\r\nexport function makeGetUri(param) {\r\n\r\n    let str = [];\r\n    for (let key in param)\r\n        if (param.hasOwnProperty(key)) {\r\n            str.push(encodeURIComponent(key) + \"=\" + encodeURIComponent(param[key]));\r\n        }\r\n    let uri = str.join(\"&\");\r\n    uri = AJAX_URI+(uri!=='' ? '?'+uri : '');\r\n\r\n    return uri;\r\n}\r\n\r\n// 1 inch  2.54 cm\r\n// 300 dpi = 300/2.54  118.11 dpcm (dot per cantimeter)\r\n\r\nexport function ColorCorrection(pixelArray, gain, contrast, gainR, gainG, gainB) {\r\n    const intercept = 128 * (1 - contrast);\r\n\r\n    for (let i = 0; i < pixelArray.data.length; i += 4) {\r\n        pixelArray.data[i] *= gainR * gain;\r\n        pixelArray.data[i + 1] *= gainG *gain;\r\n        pixelArray.data[i + 2] *= gainB *gain;\r\n\r\n        pixelArray.data[i] = pixelArray.data[i] * contrast + intercept;\r\n        pixelArray.data[i+1] = pixelArray.data[i+1] * contrast + intercept;\r\n        pixelArray.data[i+2] = pixelArray.data[i+2] * contrast + intercept;\r\n\r\n        // pixelArray.data[i] = 255 * Math.pow(pixelArray.data[i] / 255, 1 / gamma);\r\n        // pixelArray.data[i + 1] = 255 * Math.pow(pixelArray.data[i + 1] / 255, 1 / gamma);\r\n        // pixelArray.data[i + 2] = 255* Math.pow(pixelArray.data[i + 2] / 255, 1 / gamma);\r\n        //\r\n        // pixelArray.data[i] = 255 * (pixelArray.data[i]/255 + offset);\r\n        // pixelArray.data[i + 1] = 255 * (pixelArray.data[i + 1] / 255 + offset);\r\n        // pixelArray.data[i + 2] = 255 * (pixelArray.data[i + 2] / 255 + offset);\r\n    }\r\n    return pixelArray;\r\n}\r\n\r\nexport function saturate(pixelArray, amount) {\r\n    let r,g,b;\r\n\r\n    for (let i=0; i < pixelArray.data.length; i += 4) {\r\n        r = (.213 + .787 * amount) * pixelArray.data[i]\r\n            + (.715 - .715 * amount) * pixelArray.data[i + 1]\r\n            + (.072 - .072 * amount) * pixelArray.data[i + 2];\r\n        g = (.213 - .213 * amount) * pixelArray.data[i]\r\n            + (.715 + .285 * amount) * pixelArray.data[i + 1]\r\n            + (.072 - .072 * amount) * pixelArray.data[i + 2];\r\n        b = (.213 - .213 * amount) * pixelArray.data[i]\r\n            + (.715 - .715 * amount) * pixelArray.data[i + 1]\r\n            + (.072 + .928 * amount) * pixelArray.data[i + 2];\r\n\r\n        pixelArray.data[i] = r;\r\n        pixelArray.data[i + 1] = g;\r\n        pixelArray.data[i + 2] = b;\r\n    }\r\n    return pixelArray;\r\n}\r\n\r\nexport function ColorSepia (pixelArray) {\r\n    let r,g,b;\r\n    for (let i=0; i < pixelArray.data.length; i += 4) {\r\n\r\n        r = pixelArray.data[i] * 0.393 + pixelArray.data[i+1] * 0.769 + pixelArray.data[i+2] * 0.189;\r\n        g = pixelArray.data[i] * 0.349 + pixelArray.data[i+1] * 0.686 + pixelArray.data[i+2] * 0.168;\r\n        b = pixelArray.data[i] * 0.272 + pixelArray.data[i+1] * 0.534 + pixelArray.data[i+2] * 0.131;\r\n\r\n        pixelArray.data[i] = r;\r\n        pixelArray.data[i+1] = g;\r\n        pixelArray.data[i+2] = b;\r\n    }\r\n    return pixelArray;\r\n}\r\n\r\nexport function calculateImageDimensions(app, indexImage) {\r\n    const image = app.images[indexImage];\r\n    const realRatio = image.editorState.imageZoom*image.editorState.ratio;\r\n\r\n    let viewportWidth = app.editorWidth - image.editorState.maskLR*2;\r\n    let viewportHeight = app.editorHeight - image.editorState.maskTB*2;\r\n    // let formatWidth = dpi_inch2dots(image.format.width, image.format.dpi);\r\n    // let formatHeight = dpi_inch2dots(image.format.height, image.format.dpi);\r\n\r\n\r\n\r\n    let sX = image.editorState.sliderPositionLR*-1;\r\n    let sY = image.editorState.sliderPositionTB*-1;\r\n    let sW = image.editorState.imgWidth;\r\n    let sH = image.editorState.imgHeight;\r\n    // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\r\n    if(image.editorState.imageRotate===0 || image.editorState.imageRotate===180) {\r\n        if(sX>0) {\r\n            sW -= sX;\r\n        } else if(sX<0) {\r\n            sX=0;\r\n        }\r\n        if(sW+image.editorState.sliderPositionLR+sX>viewportWidth) {\r\n            sW = viewportWidth-image.editorState.sliderPositionLR-sX;\r\n        }\r\n        if(sW<0) sW = 0;\r\n        // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\r\n        if(sY>0) {\r\n            sH -= sY;\r\n            if(sY>image.editorState.imgHeight) sY = image.editorState.imgHeight;\r\n        } else if(sY<0) {\r\n            sY=0;\r\n        }\r\n        if(sH+image.editorState.sliderPositionTB+sY>viewportHeight) {\r\n            sH = viewportHeight-image.editorState.sliderPositionTB-sY;\r\n        }\r\n        if(sH<0) sH = 0;\r\n\r\n    } else { // --------------------------------------------rotated 90 / 270\r\n        let centerX = image.editorState.sliderPositionLR+image.editorState.imgWidth/2;\r\n        let centerY = image.editorState.sliderPositionTB+image.editorState.imgHeight/2;\r\n\r\n        let TB = centerY - image.editorState.imgWidth/2;\r\n        sX = 0;\r\n        if(TB+sW>viewportHeight) { sW = viewportHeight-TB; }\r\n        if(TB<0) { sX=TB*-1; sW-=sX; }\r\n        if(TB>viewportHeight){ sW = 0; }\r\n\r\n        let LR = centerX - image.editorState.imgHeight/2;\r\n        sY = 0;\r\n        if(LR+sH>viewportWidth) { sY = LR+sH-viewportWidth; sH-=sY;  }\r\n        if(LR<0) { sH += LR; }\r\n        if(LR>viewportWidth){ sH = 0; }\r\n\r\n    }\r\n    if(image.editorState.imageRotate===180 || image.editorState.imageRotate===270) { // 180 --- upside // 270 --- upside\r\n        sX = image.editorState.imgWidth - sW - sX;\r\n        sY = image.editorState.imgHeight - sH - sY;\r\n    }\r\n\r\n\r\n    // console.log(' Pre-Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH));\r\n\r\n    let cW = sW; //#######################################################################################\r\n    let cH = sH; //#######################################################################################\r\n\r\n    sX /= realRatio;\r\n    sY /= realRatio;\r\n    sW /= realRatio;\r\n    sH /= realRatio;\r\n    // console.log(' ------- Source : ',  Math.round(sX), Math.round(sY), Math.round(sW), Math.round(sH), 'dims:', Math.round(sX+sW),Math.round(sY+sH));\r\n\r\n\r\n    let cX = image.editorState.sliderPositionLR;\r\n    let cY = image.editorState.sliderPositionTB;\r\n    // console.log(' ------- Pre-Canvas : ',  Math.round(cX), Math.round(cY), Math.round(cW), Math.round(cH));\r\n    if(cX<0) {\r\n        cX = 0;\r\n    }\r\n    if(cY<0) {\r\n        cY = 0;\r\n    }\r\n\r\n    // console.log(' ------- Canvas : ',  Math.round(cX), Math.round(cY), Math.round(cW), Math.round(cH) );\r\n\r\n    cX /=image.editorState.ratio;\r\n    cY /=image.editorState.ratio;\r\n    cW /=image.editorState.ratio;\r\n    cH /=image.editorState.ratio;\r\n\r\n\r\n    let pX = image.editorState.sliderPositionLR;\r\n    let pY = image.editorState.sliderPositionTB;\r\n    let pW = image.editorState.imgWidth;\r\n    let pH = image.editorState.imgHeight;\r\n    // console.log('Pre-values: ',  Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\r\n    if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n        // let imageCenterX = pX + pW/2;\r\n        // let imageCenterY = pY + pH/2;\r\n        pX = (pX + pW/2) - pH/2;\r\n        pY = (pY + pH/2) - pW/2;\r\n\r\n        pW = image.editorState.imgHeight;\r\n        pH = image.editorState.imgWidth;\r\n    }\r\n    // console.log('Pre-values: ',  Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\r\n    if(pW+pX>viewportWidth) {\r\n        pW = viewportWidth-pX;\r\n    }\r\n    if(pX<0) {\r\n        pW += pX;\r\n        pX = 0;\r\n    }\r\n    if(pW<0) pW = 0;\r\n\r\n    if(pH+pY>viewportHeight) {\r\n        pH = viewportHeight-pY;\r\n    }\r\n    if(pY<0) {\r\n        pH += pY;\r\n        pY = 0;\r\n    }\r\n    if(pH<0) pH = 0;\r\n\r\n\r\n    pX /=image.editorState.ratio;\r\n    pY /=image.editorState.ratio;\r\n    pW /=image.editorState.ratio;\r\n    pH /=image.editorState.ratio;\r\n\r\n    // console.log('------Ret-values: ', Math.round(pX), Math.round(pY), Math.round(pW), Math.round(pH));\r\n\r\n\r\n\r\n    return {\r\n        sX: sX, sY: sY, sW: sW, sH: sH,\r\n\r\n        cX: cX, cY: cY, cW: cW, cH: cH,\r\n\r\n        pX: pX, pY: pY, pW: pW, pH: pH,\r\n    };\r\n\r\n}\r\n\r\nexport function processImage(canvas, app, index, fn_callback) {\r\n    // this.props.parentProps.image\r\n    const image = app.images[index];\r\n\r\n    console.log(image);\r\n    if(typeof fn_callback !== 'function') return;\r\n\r\n    let img = new Image();\r\n    img.crossOrigin = 'anonymous';\r\n\r\n    img.onload=function(){\r\n\r\n\r\n        if(image.editorState.imageRotate === 0 || image.editorState.imageRotate === 180) {\r\n            canvas.width = dpi_inch2dots(image.format.width, image.format.dpi);\r\n            canvas.height = dpi_inch2dots(image.format.height, image.format.dpi);\r\n        } else {\r\n            canvas.width = dpi_inch2dots(image.format.height, image.format.dpi);\r\n            canvas.height = dpi_inch2dots(image.format.width, image.format.dpi);\r\n        }\r\n\r\n\r\n        const p = calculateImageDimensions(app, index);\r\n\r\n        const ctx = canvas.getContext('2d', {alpha: false});\r\n        ctx.fillStyle = \"#ffffff\";\r\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n                        console.log('processImage', p);\r\n\r\n        if(image.editorState.imageRotate !== 0) {\r\n            ctx.drawImage(img, p.sX, p.sX, p.sW, p.sH, p.cX, p.cY, p.cW, p.cH);\r\n        } else {\r\n            let zX = canvas.width/-2;\r\n            let zY = canvas.height/-2;\r\n            if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n                let t = canvas.width;\r\n                canvas.width = canvas.height;\r\n                canvas.height = t;\r\n            }\r\n            ctx.translate(canvas.width / 2, canvas.height / 2);\r\n            ctx.rotate(image.editorState.imageRotate * Math.PI / 180);\r\n            ctx.drawImage(img, p.sx, p.sy, p.sW, p.sH, zX + p.cX, zY + p.cY, p.cW, p.cH);\r\n\r\n        }\r\n\r\n        let pixelArray = ctx.getImageData(Math.floor(p.pX), Math.floor(p.pY), Math.ceil(p.pW), Math.ceil(p.pH) );\r\n\r\n        if(image.editorState.brightness!==1 || image.editorState.contrast!==1 || image.editorState.colorR!==1 || image.editorState.colorG!==1 || image.editorState.colorB!==1 ) {\r\n            pixelArray = ColorCorrection(pixelArray, image.editorState.brightness, image.editorState.contrast, image.editorState.colorR, image.editorState.colorG, image.editorState.colorB);\r\n        }\r\n        if(image.editorState.sepia) {\r\n            pixelArray = ColorSepia(pixelArray, 1);\r\n        }\r\n        if(image.editorState.saturate!==1) {\r\n            pixelArray = saturate(pixelArray, image.editorState.saturate);\r\n        }\r\n\r\n        ctx.putImageData(pixelArray, Math.floor(p.pX), Math.floor(p.pY));\r\n\r\n        //const dataURL = this.myCanvas.toDataURL('image/png');\r\n        fn_callback( canvas.toDataURL('image/jpeg', 0.7) );\r\n    };\r\n    img.src= makeGetUri()+image.src;\r\n\r\n}\r\n\r\nexport function dpi_dots2cm(dots, dpi) {\r\n    if(dpi===undefined || !dpi) dpi = 300;\r\n    return dots / (dpi / 2.54);\r\n}\r\n\r\nexport function dpi_cm2dots(cm, dpi) {\r\n    if(dpi===undefined || !dpi) dpi = 300;\r\n    return cm * (dpi / 2.54);\r\n}\r\n\r\nexport function dpi_dots2inch(dots, dpi) {\r\n    if(dpi===undefined || !dpi) dpi = 300;\r\n    return dots / dpi;\r\n}\r\n\r\nexport function dpi_inch2dots(inch, dpi) {\r\n    if(dpi===undefined || !dpi) dpi = 300;\r\n    return inch * dpi;\r\n}\r\n\r\nexport function Round(x, dec) {\r\n    if(x===undefined) x=0;\r\n    x =  String(x).replace(/,/g,'.');\r\n    x = parseFloat(x);\r\n    if(isNaN(x)) x = 0;\r\n\r\n    if(dec===undefined) {\r\n        return x.toFixed(2);\r\n    } else {\r\n        return x.toFixed( parseInt(dec) );\r\n    }\r\n}\r\n\r\nexport function deepCompare () {\r\n    var i, l, leftChain, rightChain;\r\n\r\n    function compare2Objects (x, y) {\r\n        var p;\r\n\r\n        // remember that NaN === NaN returns false\r\n        // and isNaN(undefined) returns true\r\n        if (isNaN(x) && isNaN(y) && typeof x === 'number' && typeof y === 'number') {\r\n            return true;\r\n        }\r\n\r\n        // Compare primitives and functions.\r\n        // Check if both arguments link to the same object.\r\n        // Especially useful on the step where we compare prototypes\r\n        if (x === y) {\r\n            return true;\r\n        }\r\n\r\n        // Works in case when functions are created in constructor.\r\n        // Comparing dates is a common scenario. Another built-ins?\r\n        // We can even handle functions passed across iframes\r\n        if ((typeof x === 'function' && typeof y === 'function') ||\r\n            (x instanceof Date && y instanceof Date) ||\r\n            (x instanceof RegExp && y instanceof RegExp) ||\r\n            (x instanceof String && y instanceof String) ||\r\n            (x instanceof Number && y instanceof Number)) {\r\n            return x.toString() === y.toString();\r\n        }\r\n\r\n        // At last checking prototypes as good as we can\r\n        if (!(x instanceof Object && y instanceof Object)) {\r\n            return false;\r\n        }\r\n\r\n        if (x.isPrototypeOf(y) || y.isPrototypeOf(x)) {\r\n            return false;\r\n        }\r\n\r\n        if (x.constructor !== y.constructor) {\r\n            return false;\r\n        }\r\n\r\n        if (x.prototype !== y.prototype) {\r\n            return false;\r\n        }\r\n\r\n        // Check for infinitive linking loops\r\n        if (leftChain.indexOf(x) > -1 || rightChain.indexOf(y) > -1) {\r\n            return false;\r\n        }\r\n\r\n        // Quick checking of one object being a subset of another.\r\n        for (p in y) {\r\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) {\r\n                return false;\r\n            }\r\n            else if (typeof y[p] !== typeof x[p]) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        for (p in x) {\r\n            if (y.hasOwnProperty(p) !== x.hasOwnProperty(p)) {\r\n                return false;\r\n            }\r\n            else if (typeof y[p] !== typeof x[p]) {\r\n                return false;\r\n            }\r\n\r\n            switch (typeof (x[p])) {\r\n                case 'object':\r\n                case 'function':\r\n\r\n                    leftChain.push(x);\r\n                    rightChain.push(y);\r\n\r\n                    if (!compare2Objects (x[p], y[p])) {\r\n                        return false;\r\n                    }\r\n\r\n                    leftChain.pop();\r\n                    rightChain.pop();\r\n                    break;\r\n\r\n                default:\r\n                    if (x[p] !== y[p]) {\r\n                        return false;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    if (arguments.length < 1) {\r\n        return true; //Die silently? Don't know how to handle such case, please help...\r\n        // throw \"Need two or more arguments to compare\";\r\n    }\r\n\r\n    for (i = 1, l = arguments.length; i < l; i++) {\r\n\r\n        leftChain = [];\r\n        rightChain = [];\r\n\r\n        if (!compare2Objects(arguments[0], arguments[i])) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n}","\r\nexport function setLang(newLang) {\r\n    if(i18n[newLang]) window.LANG = newLang;\r\n}\r\n\r\nexport function getLangs() {\r\n    let langs = [];\r\n    for(let prop in i18n) {\r\n        langs.push({key:prop, caption:i18n[prop].langCaption});\r\n    }\r\n    return langs;\r\n}\r\n\r\nexport default function t(str) {\r\n    let LANG = 'ua';\r\n    if(window.LANG) LANG = window.LANG;\r\n    return (i18n[LANG][str]===undefined && i18n[LANG][str]!=='') ? str : i18n[LANG][str];\r\n}\r\n\r\nconst i18n = {\r\n    'en' : {\r\n        'langCaption' : 'English',\r\n    },\r\n    'ua' : {\r\n        'langCaption' : '',\r\n\r\n        'Wait a moment while app loading': ' ,  ',\r\n        'Cancel': '',\r\n        'Warning': '',\r\n        'Next': '',\r\n        'Previous': '',\r\n        'Print': '',\r\n        'Save': '',\r\n        'Loaded already': ' ',\r\n        'Name':'',\r\n        'Height':'',\r\n        'Width':'',\r\n        'Surface':'',\r\n        'glance':'',\r\n        'matte':'',\r\n\r\n        'Files': '',\r\n        'Selected': '',\r\n        'Cost': '',\r\n\r\n        'Are you sure?': ' ?',\r\n        'error': ' ',\r\n        'error status, let see log': '    ',\r\n\r\n        'Select CD, flash card or other source, then select format what you want, and press button':\r\n            ' CD        .    .   ',\r\n\r\n        'Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture' :\r\n            ' ,    .   ,    ',\r\n\r\n        'To continue you should select at least one image': '        ',\r\n        'Select all': ' ',\r\n        'Select none': '  ',\r\n        'No images': '  ',\r\n\r\n        'Current state of editor images will be lost.': '     .',\r\n\r\n\r\n        'Format': '',\r\n        'Amount': '-',\r\n        'Total': '',\r\n        'Successful printed': ' ',\r\n        'The number of your order is': '  ',\r\n        'Dont forget to remove your source.' : '    .',\r\n        'Thank you!': '!',\r\n\r\n    }\r\n};","import React from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport t from \"../i18n\";\r\nimport {getLangs} from \"../i18n\";\r\nimport {setLang} from \"../i18n\";\r\nimport './index.css';\r\nimport Icon from '@material-ui/core/Icon';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport axios from \"axios\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\nimport ClickAwayListener from \"@material-ui/core/ClickAwayListener\";\r\n\r\nexport default class PageStart extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.checkSourceTimer = null;\r\n        this.checkSourceTimerMax = 7200; // about 10 hours\r\n        this.checkSourceTimerCount = this.checkSourceTimerMax;\r\n\r\n        this.state = {\r\n            isLangsOpen: false,\r\n        }\r\n    }\r\n\r\n\r\n    componentWillUnmount() {\r\n        if(this.checkSourceTimer) clearTimeout(this.checkSourceTimer);\r\n    }\r\n\r\n    componentDidMount() {\r\n        let sources = this.props.app.sources.slice();\r\n        let len = sources.length;\r\n\r\n        for(let i=0; i<len; i++)\r\n            sources[i].hasFiles = false;\r\n        this.props.appSetState({sources : sources}, ()=>{\r\n            this.checkSources(true);\r\n        });\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(prevProps.app.isUploadEnable !== this.props.app.isUploadEnable && this.props.app.isUploadEnable){\r\n            if(this.inputUpload) this.inputUpload.click();\r\n        }\r\n    }\r\n\r\n    checkSources(initRefresh) {\r\n        if(!this.props.app.sources) return;\r\n\r\n        let sources = this.props.app.sources.slice();\r\n        let len = sources.length;\r\n\r\n        if(initRefresh) {\r\n            this.checkSourceTimerCount = 0;\r\n        }\r\n\r\n        for(let i=0; i<len; i++) {\r\n            if(sources[i].enabled && sources[i].emptyhide) {\r\n                let uri = tools.makeGetUri({'q':'checkEmptySource', 'id': i});\r\n                axios.get(uri).then(res => {\r\n                    if(res.status===200) {\r\n                        if(res.data.error==='') {\r\n                            sources[i].hasFiles = res.data.data;\r\n                            this.props.appSetState({sources : sources});\r\n                        }\r\n                    }\r\n\r\n                });\r\n            }\r\n        }\r\n        if(this.checkSourceTimerCount<this.checkSourceTimerMax)\r\n            this.checkSourceTimer = setTimeout( this.checkSources.bind(this), 9000 );\r\n\r\n        this.checkSourceTimerCount++;\r\n    }\r\n\r\n\r\n    clientUploadProgress = (progress) => {\r\n        let percentage = Math.floor((progress.loaded * 100) / progress.total);\r\n        // console.log(myFileId)\r\n        this.props.appSetState({ progressBarValue: percentage });\r\n\r\n        // console.log(percentage);\r\n    };\r\n\r\n    clientUpload = (event)=>{\r\n        let formData = new FormData();\r\n        let uploadfiles = event.target.files;\r\n\r\n        if(uploadfiles.length===0) return;\r\n\r\n        this.props.appSetState({isPleaseWait:true});\r\n        let config = {\r\n            onUploadProgress: (Ev)=>this.clientUploadProgress(Ev),\r\n            headers: { 'Content-Type': 'multipart/form-data' },\r\n        };\r\n\r\n        // formData.append(\"q\", 'src-upload');\r\n        for (let i=0; i<uploadfiles.length; i++) {\r\n            formData.append(\"images[]\", uploadfiles[i]);\r\n        }\r\n\r\n        axios.post( tools.makeGetUri({'q':'src-upload', 'p':this.props.app.isSetupPassword}), formData, config )\r\n            .then(()=>{\r\n                this.checkSources();\r\n            })\r\n            .catch((error)=>{\r\n                console.log(error);\r\n            })\r\n            .finally(()=>{\r\n                if(event.target) event.target.files = null;\r\n                this.props.appSetState({isPleaseWait:false, progressBarValue:-1});\r\n            });\r\n    };\r\n\r\n    openLangsPanel=(key)=>{\r\n        if(key) {\r\n            setLang(key);\r\n        }\r\n        this.setState({isLangsOpen:!this.state.isLangsOpen});\r\n    };\r\n\r\n\r\n\r\n    render() {\r\n        let sources = (this.props.app.sources ? this.props.app.sources : []);\r\n        let langs = getLangs();\r\n        let langsList = this.state.isLangsOpen ? (\r\n            <ClickAwayListener onClickAway={()=>{this.openLangsPanel()}}>\r\n                <Paper className=\"app-main-change-langs scrollbar position-absolute\">\r\n                    <table className=\"table-langs\">\r\n                        {langs.map( (lang, index)=>\r\n                            <tbody key={index} onClick={()=>this.openLangsPanel(lang.key)}>\r\n                            <tr>\r\n                                <th scope=\"row\" className=\"text-left\"><Icon>language</Icon> {lang.caption}</th>\r\n                            </tr>\r\n                            </tbody>\r\n\r\n                            )}\r\n                    </table>\r\n                </Paper>\r\n            </ClickAwayListener>\r\n        ) : null;\r\n\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\r\n                <div className=\"app-main h-85\">\r\n                    <div className=\"app-main-selectors w-85 h-100 d-inline-block\">\r\n                        <div  className=\"app-main-selectors-source text-center w-50 h-100 p-2 d-inline-block\">\r\n                            <Paper className=\"scrollbar p-2 h-100 app-bg-e  position-relative\">\r\n                                {sources.map( (source, index)=>\r\n                                    <Card key={index}\r\n                                          className={'app-source-item d-inline-block m-2'+(this.props.app.currentSource===index ? ' text-white bg-primary' : '')+(source.enabled ? '' : ' app-source-disabled')+((source.emptyhide && !source.hasFiles) ? ' app-source-emptyhide' : '')}\r\n                                          onClick={() => this.props.onClickSource(index)}\r\n                                    >\r\n                                        <CardContent>\r\n                                            <div className=\"card-img\">\r\n                                                <img src={tools.makeGetUri()+source.icon} alt={source.name} className=\"app-source-icon\"/>\r\n                                            </div>\r\n                                            {source.enabled && source.name}\r\n\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                )}\r\n\r\n                            </Paper>\r\n                        </div>\r\n                        <div className=\"app-main-selectors-format w-50 h-100 p-2 d-inline-block position-relative\">\r\n                            <Paper className=\"scrollbar p-2 h-100 app-bg-e  position-relative\">\r\n                                {this.props.app.formats.map( (format, index)=>format.enabled ?\r\n                                    <Card key={index}\r\n                                          className={'app-format-item m-2'+(this.props.app.currentFormat===index ? ' text-white bg-primary' : '')}\r\n                                          onClick={() => this.props.onClickFormat(index)}\r\n                                    >\r\n                                        <CardContent>\r\n                                            <div className=\"app-main-selectors-format-wrp\">\r\n                                                <div className=\"_w30\">{format.name}</div>\r\n                                                <div className=\"_w20\">\r\n                                                    {format.height}\"x {format.width}\"\r\n                                                </div>\r\n                                                <div className=\"_w20\">\r\n                                                    {Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}\r\n                                                </div>\r\n                                                <div className=\"_w15\">{t(format.surface)}</div>\r\n                                                <div className=\"_w15 text-right\">{tools.Round(format.cost)}</div>\r\n                                            </div>\r\n\r\n                                        </CardContent>\r\n                                    </Card>\r\n                                :\r\n                                    ''\r\n                                )}\r\n                            </Paper>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div className=\"app-main-rightwidget w-15 h-100 p-2 d-inline-block\">\r\n                        <Paper className=\"h-100 p-2 app-bg-e position-relative\">\r\n                            <div className=\"_fabwrapper\">\r\n                                <button\r\n                                    className={\"btn btn-big btn-primary\"}\r\n                                    disabled={this.props.app.currentSource===null || this.props.app.currentFormat===null}\r\n                                    onClick={() => this.props.onClickNextBtn()}\r\n                                    type=\"button\">\r\n                                    <Icon>arrow_forward</Icon> {t('Next')}\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"_fabwrapper\">\r\n                                <button\r\n                                    className=\"btn btn-big btn-success mt-4\"\r\n                                    disabled={this.checkSourceTimerCount<this.checkSourceTimerMax}\r\n                                    onClick={() => this.checkSources(true)}\r\n                                    type=\"button\">\r\n                                    <Icon>refresh</Icon> {t('Refresh')}\r\n                                </button>\r\n                            </div>\r\n\r\n\r\n                            <div className=\"bottom-absolute w-100\">\r\n\r\n                                <div className=\"_fabwrapper\">\r\n                                    <div className=\"app-main-change-langs-wrapper position-relative\">\r\n                                        {langsList}\r\n                                        <button className=\"btn btn-big btn-light text-success\"\r\n                                                style={{minWidth:'10vh', width:'auto'}}\r\n                                                onClick={this.openLangsPanel}\r\n                                                disabled={false}\r\n                                                title={t('Language')}\r\n                                                type=\"button\" >\r\n                                            <Icon>language</Icon>\r\n                                            <div>\r\n                                                {t('langCaption')}\r\n                                            </div>\r\n                                        </button>\r\n\r\n                                    </div>\r\n                                </div>\r\n\r\n\r\n                                <div className=\"_fabwrapper\">\r\n                                    <button type=\"button\"\r\n                                            className={\"btn btn-big btn-success\"}\r\n                                            disabled={false}\r\n                                            onClick={()=>{this.props.appSetState({isSetup:1})}}>\r\n                                        <Icon>build</Icon>\r\n                                        <div>\r\n                                            {this.props.app.version}\r\n                                        </div>\r\n                                    </button>\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n\r\n                        </Paper>\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <div className=\"app-bottomframe p-2 h-15 w-100\">\r\n                    <Paper className=\"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp position-relative\">\r\n\r\n                        {this.props.app.isUploadEnable && (\r\n                            <label htmlFor=\"file-input\">\r\n                                <input id=\"file-input\" ref={input=>this.inputUpload=input} type=\"file\" multiple onChange={(e)=>this.clientUpload(e)} />\r\n                                <Icon className=\"_icon text-white text-success\">info</Icon>\r\n                            </label>\r\n\r\n                        )}\r\n                        {!this.props.app.isUploadEnable && (\r\n                            <Icon onClick={()=>{this.props.appSetState({isSetup:2})}} className=\"_icon text-white\">info</Icon>\r\n                        )}\r\n\r\n                        <div className=\"_msg\">\r\n                            {t('Select CD, flash card or other source, then select format what you want, and press button')} '{t('Next')}'\r\n                        </div>\r\n\r\n                        {(this.props.app.progressBarValue>=0 && (\r\n                            <div className=\"app-bottom-progress h-100 p-2 w-100\">\r\n                                <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\r\n                            </div>\r\n                        ))}\r\n\r\n                    </Paper>\r\n                </div>\r\n\r\n            </div>\r\n\r\n\r\n        );\r\n    }\r\n}\r\n\r\n","import React, {PureComponent} from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport axios from \"axios\";\r\nimport t from \"../i18n\";\r\n\r\nimport './index.css';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\n// import ImageThumb from \"../PageEditor/ImageThumb\";\r\n\r\nconst resetState = {\r\n    folders: [],\r\n    tree: [],\r\n    currentFolder: null,\r\n    is_loadind_images: true,\r\n    expandedImage: null,\r\n    images: [],\r\n    progressAjax: {},\r\n    previewMaxResize: null,\r\n    isAutoclearLoading: false,\r\n    isAutoclearLoaded: 0,\r\n};\r\n\r\nexport default class PageLoadImages extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.imagesContainer = null;\r\n        this.isAutoclearTimer = null;\r\n\r\n        this.state = resetState;\r\n    }\r\n\r\n\r\n    componentDidMount() {\r\n        // if(this.props.app.pages['loadImages']) {\r\n        //     this.setState( this.props.app.pages['loadImages'] );\r\n        // } else {\r\n        //     this.onClickDir(null);\r\n        // }\r\n        if(this.props.app.sources[this.props.app.currentSource].autoclear) {\r\n            this.setState({isAutoclearLoading:true}, ()=>{this.onClickDir(null);});\r\n        } else {\r\n            this.onClickDir(null);\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    scrollImages(direction) {\r\n        // console.log(this.imagesContainer);\r\n\r\n        if(this.imagesContainer) {\r\n            console.log('scrollTop', this.imagesContainer.scrollTop);\r\n            console.log('scrollHeight', this.imagesContainer.scrollHeight);\r\n            let rowH = this.imagesContainer.scrollHeight/Math.ceil((this.state.images.length/3) );\r\n            console.log('rowCount', rowH);\r\n            this.imagesContainer.scrollTop += rowH*direction;\r\n        }\r\n    }\r\n\r\n    onClickDir(index) {\r\n        let currentDir = (index && this.state.folders ? this.state.folders[index].dir : '' );\r\n        let uri = '';\r\n\r\n        if(this.state.isAutoclearLoading) {\r\n\r\n            uri = tools.makeGetUri({'q':'source', 'id': this.props.app.currentSource, dir: currentDir});\r\n            axios.get(uri).then(res => {\r\n                if(res.status===200) {\r\n                    if(res.data.error==='') {\r\n                        this.setState({ isAutoclearLoaded: res.data.data.length } );\r\n                    }\r\n                }\r\n            });\r\n\r\n            this.isAutoclearTimer = setTimeout( ()=>{this.onClickDir()}, 3000);\r\n\r\n        } else { // ------------------------------------------- full load folders and images\r\n\r\n            if(this.isAutoclearTimer) clearTimeout(this.isAutoclearTimer);\r\n\r\n            let _d = '';\r\n            let folders = [{\r\n                'list': this.props.app.currentSource,\r\n                'source': this.props.app.sources[this.props.app.currentSource],\r\n                'name': this.props.app.sources[this.props.app.currentSource].name,\r\n                'dir': _d,\r\n                'level': 0,\r\n            }];\r\n            this.setState({folders: folders, currentFolder: null });\r\n\r\n            uri = tools.makeGetUri({'q':'folders', 'id': this.props.app.currentSource, dir: currentDir });\r\n            axios.get(uri).then(res => {\r\n                if(res.status===200) {\r\n                    if(res.data.error==='') {\r\n                        var _L = 1;\r\n                        for (let i=0; i<res.data.tree.length; i++) {\r\n                            _d += (_d!=='' ? '/' : '')+res.data.tree[i];\r\n                            let _f = {\r\n                                'list': this.props.app.currentSource,\r\n                                'name': res.data.tree[i],\r\n                                'dir': _d,\r\n                                'level': _L,\r\n                            };\r\n                            if(_L<5) _L++;\r\n                            folders.push(_f);\r\n                        }\r\n\r\n                        for (let _f of res.data.data) {\r\n                            _f.level = _L;\r\n                            folders.push(_f);\r\n                        }\r\n                        this.setState({\r\n                            folders: folders,\r\n                            currentFolder: res.data.tree.length,\r\n                        });\r\n\r\n                        this.setState({images: [], is_loadind_images: true });\r\n\r\n                        let progress = 3;\r\n                        this.props.appSetState({ progressBarValue:progress });\r\n                        let uri = tools.makeGetUri({'q':'source', 'precache':true, 'id': this.props.app.currentSource, dir: currentDir});\r\n                        axios.get(uri, {\r\n                            onDownloadProgress: (progressEvent) => {\r\n                                let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                                progress = progressEvent.lengthComputable ? percentCompleted : progress;\r\n                                // console.log(progress);\r\n                                this.props.appSetState({ progressBarValue: progress })\r\n                            }\r\n                        })\r\n                            .then((/*response*/) => {\r\n                                this.props.appSetState({ progressBarValue:-1 });\r\n\r\n                                uri = tools.makeGetUri({'q':'source', 'id': this.props.app.currentSource, dir: currentDir});\r\n                                axios.get(uri).then(res => {\r\n                                    if(res.status===200) {\r\n                                        if(res.data.error==='') {\r\n                                            this.setState({ images: res.data.data }, ()=>{this.imagesScroll()} );\r\n                                        }\r\n                                    }\r\n                                    this.setState({is_loadind_images: false});\r\n                                });\r\n\r\n\r\n                            }).catch(error => {\r\n                            if (error.response) {\r\n                                console.log(error.responderEnd);\r\n                                this.props.onMessage('testProgress error: '+error.responderEnd);\r\n                                progress = -1;\r\n                                this.props.appSetState({ progressBarValue:-1 })\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    showExpandImg(index) {\r\n        this.setState({expandedImage: null} , ()=>{\r\n            this.setState({expandedImage: index}, ()=>{this.reopenThumb(index)})\r\n        })\r\n    }\r\n    reopenThumb(index) {\r\n        //image.name\r\n        let newIm = this.state.images.slice();\r\n        let reopen = newIm[index].name;\r\n        newIm[index].name = '';\r\n        this.setState({images: newIm}, ()=>{\r\n            newIm[index].name = reopen;\r\n            this.setState({images: newIm});\r\n        });\r\n\r\n    }\r\n\r\n    hideExpandImg() {\r\n        this.setState({expandedImage: null})\r\n    }\r\n    MarkImage(index){\r\n        let newIm = this.state.images.slice();\r\n        newIm[index].marked = !newIm[index].marked;\r\n        this.setState({images: newIm});\r\n    }\r\n\r\n    markAllImages(mode) {\r\n        let newIm = this.state.images;\r\n        for(let i=0; i<newIm.length; i++) {\r\n            newIm[i].marked = mode;\r\n        }\r\n        this.setState({images: newIm});\r\n    }\r\n\r\n\r\n    setpreviewMaxResize(value) {\r\n        this.setState({previewMaxResize:value});\r\n    }\r\n\r\n    nextPage = ()=> {\r\n\r\n        // args - this.state.images\r\n        const selectedimages = this.state.images.filter(function(x){return x.marked});\r\n        if(selectedimages.length===0) {\r\n            this.props.onMessage(t('To continue you should select at least one image'));\r\n            return;\r\n        }\r\n        const dirs = selectedimages.map( (image)=> { return image.dir;} );\r\n        const files = selectedimages.map( (image)=> { return image.name;} );\r\n\r\n        let uri = tools.makeGetUri();\r\n        const params = new URLSearchParams();\r\n        params.append('q', 'movetowork');\r\n        params.append('id', this.props.app.currentSource);\r\n        params.append('maxWidth', (this.state.previewMaxResize ? this.state.previewMaxResize : 300));\r\n\r\n        for(let _d of dirs ) params.append('dirs[]', _d);\r\n        for(let _f of files ) params.append('files[]', _f);\r\n\r\n\r\n            let progress = 3;\r\n            this.props.appSetState({ progressBarValue: progress, isPleaseWait:true });\r\n            axios.post(uri, params, {\r\n                onDownloadProgress: (progressEvent) => {\r\n                    let percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                    progress = progressEvent.lengthComputable ? percentCompleted : progress;\r\n                    // console.log(progress);\r\n                    this.props.appSetState({ progressBarValue: progress })\r\n                }\r\n            })\r\n                .then((/*response*/) => {\r\n                    progress = -1;\r\n                    this.props.appSetState({ progressBarValue:-1 });\r\n\r\n                    let uri = tools.makeGetUri({'q':'workpath'});\r\n                    axios.get(uri).then(res => {\r\n                        if(res.status===200) {\r\n                            if(res.data.error==='') {\r\n                                let dpi =  this.props.app.formats[this.props.app.currentFormat].dpi ? this.props.app.formats[this.props.app.currentFormat].dpi : 300;\r\n                                const images = selectedimages.map( (image)=> {\r\n                                    let thumbname = res.data.data.thumbs+image.dir+ image.name.substr(0, image.name.lastIndexOf(\".\")) +\".jpg\";\r\n                                    return {\r\n                                        name: image.name,\r\n                                        extension: image.extension,\r\n                                        width: tools.dpi_dots2inch(image.width, dpi),\r\n                                        height: tools.dpi_dots2inch(image.height, dpi),\r\n                                        width_pixel: image.width,\r\n                                        height_pixel: image.height,\r\n                                        orientation : image.orientation,\r\n                                        thumb: thumbname.replace('?', '%3F'),\r\n                                        src: res.data.data.works+image.name,\r\n                                        format: this.props.app.formats[this.props.app.currentFormat],\r\n                                        count: 1,\r\n                                        editorState: {\r\n\r\n                                            maskTB: 0,\r\n                                            maskLR: 0,\r\n                                            imageZoom: 1.0,\r\n                                            imageZoomMax: 1.9,\r\n                                            imageZoomMin: 0.1,\r\n                                            imageRotate: 0,\r\n                                            colorR: 1.0,\r\n                                            colorG: 1.0,\r\n                                            colorB: 1.0,\r\n                                            brightness: 1,\r\n                                            contrast: 1,\r\n                                            saturate: 1,\r\n                                            sepia: false,\r\n\r\n                                            sliderPositionTB: 0,\r\n                                            sliderPositionLR: 0,\r\n\r\n                                            initedImagePosition: false,\r\n                                            initedMask: false,\r\n                                            ratio: 1.0,\r\n                                            imgWidth: image.width,\r\n                                            imgHeight: image.height,\r\n                                            currentTab: 0,\r\n\r\n                                        },\r\n\r\n\r\n                                };\r\n                                } );\r\n                                this.props.onClickNextBtn(images);\r\n\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    //console.log(images);\r\n                    // this.setState({appstate: 'editor', images: images});\r\n                }).catch(error => {\r\n                    if (error.response) {\r\n                        console.log('movetowork error', error.responderEnd);\r\n                        this.props.onMessage('movetowork error: '+error.responderEnd);\r\n                        progress = -1;\r\n                        this.props.appSetState({ progressBarValue:-1, isPleaseWait:false })\r\n                    }\r\n                });\r\n\r\n    };\r\n\r\n    imagesScroll() {\r\n        // console.log(this.imagesContainer.children);\r\n        let images = this.state.images.slice();\r\n        let changed = false;\r\n        if(this.imagesContainer && this.imagesContainer.children) {\r\n            let viewHeight = this.imagesContainer.clientHeight;\r\n            let len = this.imagesContainer.children.length;\r\n            for(let i=0; i<len; i++) {\r\n                if(images[i] && !images[i].is_appeared) {\r\n                    let rect = this.imagesContainer.children[i].getBoundingClientRect();\r\n                    let is_visible = !(rect.bottom < 0 || rect.top - viewHeight >= 0);\r\n                    if(is_visible) {\r\n                        images[i].is_appeared = true;\r\n                        changed = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(changed) {\r\n            this.setState({images:images});\r\n        }\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n\r\n        const selectedimages = this.state.images.filter(function(x){return x.marked});\r\n        const cost = this.props.app.formats[this.props.app.currentFormat].cost;\r\n\r\n        return (\r\n\r\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\r\n                <div className=\"app-main h-90\">\r\n                    <div className=\"d-inline-block w-85 h-100\">\r\n                        <div className=\"app-main-selectors w-100 h-100 d-flex flex-row\">\r\n                            <div  className=\"app-main-selectors-folder h-100 p-2 flex-grow-1 flex-shrink-1\">\r\n                                <Paper className=\"scrollbar p-2 h-100 app-bg-e\">\r\n                                    {this.state.folders.map( (dir, index)=>\r\n                                        <Card key={index}\r\n                                              className={'m-1 app-dir-item level'+dir.level+' '+(this.state.currentFolder===index ? ' text-white bg-primary' : '')}\r\n                                              onClick={() => this.onClickDir(index) }\r\n                                        >\r\n                                            <CardContent>\r\n                                                {dir.source && (\r\n                                                    <img src={tools.makeGetUri()+dir.source.icon} alt={dir.source.name} className=\"app-dir-item-icon\"/>\r\n                                                )}\r\n                                                {dir.name}\r\n                                                {index===0 &&\r\n                                                <Icon className=\"float-right\" >refresh</Icon>\r\n                                                }\r\n                                            </CardContent>\r\n                                        </Card>\r\n                                    )}\r\n                                </Paper>\r\n                            </div>\r\n                            <div className=\"app-main-selectors-image h-100 p-2 flew-grow-0 flex-shrink-0\">\r\n                                <Paper className=\"h-100 position-relative app-bg-e\">\r\n                                    <div  ref={(node)=>{this.imagesContainer=node}}\r\n                                          onScroll={()=>this.imagesScroll()}\r\n                                          className=\"p-2 h-100 scrollbar\">\r\n                                            {this.state.images.map( (image, index)=>\r\n                                                <ImagePreview\r\n                                                    key={image.name}\r\n                                                    image={image}\r\n                                                    itemIndex={index}\r\n                                                    imagesContainer = {this.imagesContainer}\r\n                                                    onExpand={()=>this.showExpandImg(index)}\r\n                                                    onMark={()=>this.MarkImage(index)}\r\n                                                    setpreviewMaxResize={()=>this.setpreviewMaxResize.bind(this)}\r\n                                                    {...this.props}\r\n                                                />\r\n                                            )}\r\n\r\n                                    </div>\r\n\r\n                                    {(!this.state.is_loadind_images && this.state.images.length===0) && (\r\n                                        <div className='app-source-noimages h-100 text-primary' >\r\n                                            {t('No images')}\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {(this.state.is_loadind_images && !this.state.isAutoclearLoading) && (\r\n                                        <div className = \"list-images-loader spinner-border text-primary\" role = \"status\" >\r\n                                            <span className = \"sr-only\" > Loading...</span>\r\n                                        </div>\r\n\r\n                                    )}\r\n\r\n                                </Paper>\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n                    <div className=\"app-main-rightwidget w-15 h-100 p-2 d-inline-block\">\r\n                        <Paper className=\"h-100 p-2 app-bg-e position-relative\">\r\n                            <div className=\"_fabwrapper\">\r\n                                <button className={\"btn btn-big btn-primary\"}\r\n                                        onClick={() => this.nextPage()}\r\n                                        disabled={false}\r\n                                        title={t(\"Next\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>arrow_forward</Icon> {t('Next')}\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"_fabwrapper\">\r\n                                <button className={\"btn btn-big btn-primary\"}\r\n                                        onClick={() => {this.props.onClickPrevBtn()}}\r\n                                        disabled={false}\r\n                                        title={t(\"Previous\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>arrow_back</Icon> {t(\"Previous\")}\r\n                                </button>\r\n                            </div>\r\n\r\n\r\n                            <div className=\"_fabwrapper mt-4\">\r\n                                <button className={\"btn btn-success\"}\r\n                                        onClick={()=>this.scrollImages(-1)}\r\n                                        disabled={false}\r\n                                        title={t(\"up\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>expand_less</Icon>\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"_fabwrapper\">\r\n                                <button className={\"btn btn-success mr-2\"}\r\n                                        onClick={() => this.markAllImages(true)}\r\n                                        disabled={false}\r\n                                        title={t(\"Select all\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>filter</Icon>\r\n                                </button>\r\n\r\n                                <button className={\"btn btn-success\"}\r\n                                        onClick={() => this.markAllImages(false)}\r\n                                        disabled={false}\r\n                                        title={t(\"Select none\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>filter_none</Icon>\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"_fabwrapper\">\r\n                                <button className={\"btn btn-success\"}\r\n                                        onClick={()=>this.scrollImages(1)}\r\n                                        disabled={false}\r\n                                        title={t(\"down\")}\r\n                                        type=\"button\" >\r\n                                    <Icon>expand_more</Icon>\r\n                                </button>\r\n                            </div>\r\n\r\n\r\n                            <div className=\"app-main-rightwidget-tablewrp\">\r\n                                <table className=\"table\">\r\n                                    <tbody>\r\n                                    <tr>\r\n                                        <th scope=\"row\">{t('Files')}</th>\r\n                                        <th scope=\"row\">{this.state.images.length}</th>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <th scope=\"row\">{t('Selected')}</th>\r\n                                        <th scope=\"row\">{selectedimages.length}</th>\r\n                                    </tr>\r\n                                    <tr>\r\n                                        <th scope=\"row\">{t('Cost')}</th>\r\n                                        <th scope=\"row\">{tools.Round(selectedimages.length*cost)}</th>\r\n                                    </tr>\r\n                                    </tbody>\r\n                                </table>\r\n\r\n                            </div>\r\n\r\n                        </Paper>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <div className=\"app-bottomframe w-100 h-10 p-2 position-relative\">\r\n                    <Paper className=\"p-2 app-bg-e h-100 w-100 app-bottom-msg-wrp\">\r\n                        <Icon className=\"_icon text-white\">info</Icon>\r\n                        <div className=\"_msg\">\r\n                            {t('Select folder from list, and choose pictures to print. To view in fullscreen click on the name of picture')}\r\n                        </div>\r\n                    </Paper>\r\n\r\n                    {(this.props.app.progressBarValue>=0 && (\r\n                    <div className=\"app-bottom-progress h-100 p-2 w-100\">\r\n                        <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\r\n                    </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {this.state.isAutoclearLoading && (\r\n                    <div className=\"app-please-wait-wrp position-fixed\">\r\n\r\n                        <Paper className=\"app-page-loadimages-wait p-3\">\r\n                            <div className=\"app-source-icon-wrp\">\r\n                                <img src={tools.makeGetUri()+this.props.app.sources[this.props.app.currentSource].icon} alt={this.props.app.sources[this.props.app.currentSource].name} className=\"app-source-icon\"/>\r\n                            </div>\r\n                            {this.props.app.sources[this.props.app.currentSource].name}\r\n                            <div className=\"_loaded p-3\">\r\n                                {t('Loaded already')}: {this.state.isAutoclearLoaded}\r\n                            </div>\r\n\r\n                            <div className=\"_fabwrapper\">\r\n                                <button className={\"btn btn-big btn-success\"}\r\n                                        onClick={()=>{this.setState({isAutoclearLoading:false}, ()=>{this.onClickDir()}) }}\r\n                                        disabled={false}\r\n                                        title={t(\"OK\")}\r\n                                        type=\"button\" >\r\n                                    {t('Next')}\r\n                                </button>\r\n                            </div>\r\n\r\n                        </Paper>\r\n\r\n                    </div>\r\n                )}\r\n\r\n\r\n                <ModalExpand\r\n                    image={this.state.expandedImage!==null ? this.state.images[this.state.expandedImage] : null}\r\n                    itemCurrent={this.state.expandedImage}\r\n                    itemPrev={this.state.expandedImage>0 ? this.state.expandedImage-1: null}\r\n                    itemNext={this.state.expandedImage<(this.state.images.length-2) ? this.state.expandedImage+1 : null}\r\n                    onExpand={this.showExpandImg.bind(this)}\r\n                    onMark={this.MarkImage.bind(this)}\r\n                    onClose={this.hideExpandImg.bind(this)}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass ImagePreview extends PureComponent {\r\n\r\n    render() {\r\n        const image = this.props.image;\r\n        // this.props.image.orientation\r\n        // 1 - no rotate\r\n        // 3 - 180deg\r\n        // 6 - 270deg\r\n        // 8 - 90deg\r\n        var rotate = \"\";\r\n        switch (this.props.image.orientation) {\r\n            case 3:\r\n                rotate = \" rotate180\";\r\n                break;\r\n            case 6:\r\n                rotate = \" rotate90\";\r\n                break;\r\n            case 8:\r\n                rotate = \" rotate270\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        let previewMaxResize = 300;\r\n        if(this.props.previewMaxResize) {\r\n            previewMaxResize = this.props.previewMaxResize;\r\n        } else {\r\n            if(this.imgWrapper) {\r\n                previewMaxResize = this.imgWrapper.clientWidth;\r\n                this.props.setpreviewMaxResize(previewMaxResize);\r\n            }\r\n        }\r\n\r\n        let imgStyle = {backgroundImage: 'url('+tools.makeGetUri({'q':'img', 'id':image.list, dir:image.dir, 'src':image.name, 'max':previewMaxResize})+')'};\r\n\r\n        return (\r\n            <Card className='app-source-image-item d-inline-block m-1 position-relative' >\r\n                <CardContent className={\"p-0\"}\r\n                     onClick={()=>this.props.onMark()}\r\n                     onDoubleClick={()=>this.props.onExpand(this.props.itemIndex)}\r\n                >\r\n                    <div ref={(node)=>{this.imgWrapper=node}}\r\n                        className={\"app-source-image-item-img-wrapper p-1 \"+(image.marked ? ' text-white bg-primary': '')}>\r\n                        {image.is_appeared &&\r\n                        <div className={\"app-source-image-item-img border \"+rotate} style={imgStyle} />\r\n                        }\r\n                        {!image.is_appeared &&\r\n                        <div className=\"app-source-image-item-img border \" >\r\n                        </div>\r\n                        }\r\n\r\n                        <div className='app-source-image-item-toggle position-absolute'>\r\n                            <Fab className=\"bg-primary text-light\"\r\n                                onClick={(e)=> {e.stopPropagation(); this.props.onMark()}}\r\n                                aria-label=\"Check\" >\r\n                                <Icon>check</Icon>\r\n                            </Fab>\r\n                        </div>\r\n                        <div className='app-source-image-item-fullscreen position-absolute'>\r\n                            <Fab className=\"bg-success text-light\"\r\n                                onClick={()=>this.props.onExpand(this.props.itemIndex)}\r\n                                aria-label=\"Fullscreen\" >\r\n                                <Icon>zoom_in</Icon>\r\n                            </Fab>\r\n                        </div>\r\n\r\n\r\n                        <div className=\"app-selectimages-item-text text-center m-1\">\r\n                            {image.name}\r\n                        </div>\r\n\r\n                    </div>\r\n                </CardContent>\r\n            </Card>\r\n        )\r\n    }\r\n}\r\n\r\nclass ModalExpand extends PureComponent {\r\n\r\n    render() {\r\n        const image = this.props.image;\r\n\r\n        if (image===null) return null;\r\n\r\n        var rotate = \"\";\r\n        switch (image.orientation) {\r\n            case 3:\r\n                rotate = \" rotate180\";\r\n                break;\r\n            case 6:\r\n                rotate = \" rotate90\";\r\n                break;\r\n            case 8:\r\n                rotate = \" rotate270\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n        let imgsrc = tools.makeGetUri({'q':'img', 'id':image.list, dir:image.dir, 'src':image.name, 'max':-1});\r\n\r\n        return (\r\n            <div className=\"app-modal\" onClick={()=>this.props.onClose()}>\r\n                <div className=\"app-modal-main position-fixed\">\r\n                        <div className={\"rotate-wrp app-source-image-expanded rounded\"+rotate+(image.marked ? ' bg-primary': '')}>\r\n                            <img src={imgsrc} alt=\"zoomed\" onClick={(e)=> {e.stopPropagation(); this.props.onMark(this.props.itemCurrent)}} />\r\n                        </div>\r\n\r\n                </div>\r\n\r\n                <div\r\n                    onClick={(e)=>{if(this.props.itemPrev===null)return; e.stopPropagation(); this.props.onExpand(this.props.itemPrev)}}\r\n                    className='app-image-expanded-button _prev position-absolute'>\r\n                    <Fab disabled={this.props.itemPrev===null} aria-label=\"Previous\">\r\n                        <Icon>navigate_before</Icon>\r\n                    </Fab>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={(e)=> {e.stopPropagation(); this.props.onMark(this.props.itemCurrent)}}\r\n                    className='app-image-expanded-button _check position-absolute'>\r\n                    <Fab\r\n                        aria-label=\"Check\" >\r\n                        <Icon className=\"text-success\">check</Icon>\r\n                    </Fab>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={(e)=>{if(this.props.itemNext===null)return; e.stopPropagation(); this.props.onExpand(this.props.itemNext)}}\r\n                    className='app-image-expanded-button _next position-absolute'>\r\n                    <Fab disabled={this.props.itemNext===null}\r\n                         aria-label=\"Next\">\r\n                        <Icon>navigate_next</Icon>\r\n                    </Fab>\r\n                </div>\r\n\r\n                <div\r\n                    onClick={(e)=>{e.stopPropagation(); this.props.onClose()}}\r\n                    className='app-image-expanded-button _close position-absolute'>\r\n                    <Fab aria-label=\"Close\" >\r\n                        <Icon>close</Icon>\r\n                    </Fab>\r\n                </div>\r\n\r\n            </div>\r\n        );\r\n\r\n\r\n    }\r\n\r\n}\r\n","import React, {PureComponent} from \"react\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\n\r\nimport * as tools from \"../../tools\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport {THEME} from \"../../tools\";\r\n\r\n\r\nexport default class ImageThumb extends PureComponent {\r\n    constructor(props){   // Optional, declare a class field to improve readability\r\n        super(props);\r\n        this.nodeThumb = null;\r\n        this.scrollRef = null;\r\n\r\n        this.state = {\r\n            thumbWidth: '100px',\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        if(this.nodeThumb) {\r\n            if(this.state.thumbWidth !== this.nodeThumb.clientHeight) {\r\n                this.setState({\r\n                    thumbWidth: this.nodeThumb.clientHeight, //this is not an error, need square\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(this.scrollRef && this.props.selected) {\r\n            this.props.scrollIntoView(this.scrollRef);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const image = this.props.image;\r\n        // this.props.image.orientation\r\n        // 1 - no rotate\r\n        // 3 - 180deg\r\n        // 6 - 270deg\r\n        // 8 - 90deg\r\n        let rotate = \"\";\r\n        switch (image.orientation) {\r\n            case 3:\r\n                rotate = \" rotate180\";\r\n                break;\r\n            case 6:\r\n                rotate = \" rotate90\";\r\n                break;\r\n            case 8:\r\n                rotate = \" rotate270\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        let boxStyles = {width: this.state.thumbWidth, height: this.state.thumbWidth}; //this is not an error, need square\r\n\r\n        let styles = {width: '100%', height: 'auto'};\r\n        if(image.height>image.width) {\r\n            styles = {width: 'auto', height: '100%'};\r\n        }\r\n\r\n\r\n        let _icon_enabled = 'inherit';\r\n        let _icon_disabled = 'disabled';\r\n        let clrZoom = _icon_disabled;\r\n        let clrFilters = _icon_disabled;\r\n        let clrColors = _icon_disabled;\r\n        if(image.editorState) {\r\n            if(image.editorState.initedImagePosition) clrZoom = _icon_enabled;\r\n            if(image.editorState.brightness!==1) clrFilters = _icon_enabled;\r\n            if(image.editorState.contrast!==1) clrFilters = _icon_enabled;\r\n            if(image.editorState.saturate!==1) clrFilters = _icon_enabled;\r\n            if(image.editorState.sepia) clrFilters = _icon_enabled;\r\n            if(image.editorState.colorR!==1) clrColors = _icon_enabled;\r\n            if(image.editorState.colorG!==1) clrColors = _icon_enabled;\r\n            if(image.editorState.colorB!==1) clrColors = _icon_enabled;\r\n        }\r\n\r\n\r\n        return (\r\n            <Card className={'app-editor-thumb-item h-100 d-inline-block m-1 position-relative '+(this.props.selected ? ' text-light bg-primary' : ' text-primary bg-light')} >\r\n                <CardContent  className={\"p-0 h-100 position-relative\"} onClick={this.props.onSelect} >\r\n                    <div ref={(node)=>this.scrollRef=node} className={\"app-editor-thumb-item-img-wrapper h-100 p-1\"}>\r\n                        <div ref={(node)=>this.nodeThumb=node} style={boxStyles} className={\"app-editor-thumb-item-box h-100 border \"+rotate} >\r\n                            <span className=\"app-editor-thumb-item-img-helper\"/>\r\n                            <img\r\n                                src={tools.makeGetUri()+encodeURI(image.thumb)}\r\n                                style={styles}\r\n                                alt=\"\" className={\"app-editor-thumb-item-image\"+(!image.count ? ' _zero' : '')}/>\r\n                        </div>\r\n                    </div>\r\n                    <div className={\"app-editor-thumb-item-img-countbubble\"}\r\n                        style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\r\n                        >\r\n                        <span>{image.count ? image.count : '-'}</span>\r\n                    </div>\r\n\r\n                    <div className={\"app-editor-thumb-item-img-controls h-100\"}>\r\n                        <div className=\"app-editor-thumb-item-img-controls-flexv pr-1 h-100\">\r\n\r\n                            <div>\r\n                                <Icon fontSize={'small'} color={clrZoom}>zoom_out_map</Icon>\r\n                            </div>\r\n                            <div>\r\n                                <Icon fontSize={'small'} color={clrFilters}>brightness_medium</Icon>\r\n                            </div>\r\n                            <div>\r\n                                <Icon fontSize={'small'} color={clrColors}>equalizer</Icon>\r\n                            </div>\r\n                            <div className={\"app-editor-thumb-item-img-index\"}>\r\n                                <span>{this.props.itemIndex+1}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n\r\n                    </div>\r\n                    {!image.count && (\r\n                        <div className=\"app-editor-thumb-zeroprint\">x</div>\r\n                    )}\r\n                </CardContent>\r\n\r\n\r\n            </Card>\r\n        )\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport * as tools from \"../../tools\";\r\nimport {calculateImageDimensions} from \"../../tools\";\r\n\r\nexport default class ImageEditorZoomCanvas extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.canvasImg = new Image();\r\n        this.canvasImg.crossOrigin = 'anonymous';\r\n        const _upd = this.updateCanvas.bind(this);\r\n        this.canvasImg.onload = function() {\r\n            _upd();\r\n        };\r\n        this.renderedImageIndex = null;\r\n\r\n        this.state = {\r\n            imgSrc: null,\r\n            dragImage: false,\r\n            dragX: 0,\r\n            dragY: 0,\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n\r\n        if(this.props.app.currentImage!==prevProps.app.currentImage) {\r\n            console.log('new image clicked');\r\n            this.setState({\r\n                imgSrc: null,\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.props.appEditorChanged(this.myImgContainer.clientWidth, this.myImgContainer.clientHeight);\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n        if(!image.editorState.initedMask) {\r\n            this.props.appImageInitMask(this.props.app.currentImage);\r\n            return;\r\n        }\r\n\r\n        if(!image.editorState.initedImagePosition) {\r\n            this.props.alignInit(this.props.app.currentImage);\r\n            return;\r\n        }\r\n\r\n        let img_src = tools.makeGetUri()+encodeURI(image.src);\r\n        if(this.canvasImg.src!==img_src) {\r\n            const _upd = this.updateCanvas.bind(this);\r\n            this.canvasImg.onload = function() {\r\n                _upd();\r\n            };\r\n            this.canvasImg.src=img_src;\r\n            return;\r\n        }\r\n\r\n        // if(image.editorState.needUpdateCanvas) {\r\n            this.updateCanvas();\r\n        // }\r\n\r\n\r\n    }\r\n\r\n    updateCanvas() {\r\n\r\n        // console.log('Zoom updateCanvas');\r\n        if(!this.myCanvas || this.myCanvas.clientWidth===0 || this.myCanvas.clientHeight===0) return;\r\n\r\n        const ctx = this.myCanvas.getContext('2d');\r\n        let canvasX = this.myCanvas.clientWidth;\r\n        let canvasY = this.myCanvas.clientHeight;\r\n        // console.log('drawImage', this.canvasImg.src, canvasX, canvasY);\r\n\r\n        const editorState = this.props.app.images[this.props.app.currentImage].editorState;\r\n        ctx.drawImage(this.canvasImg, 0, 0, canvasX, canvasY);\r\n        let pixelArray = ctx.getImageData(0,0, canvasX, canvasY);\r\n\r\n        if(editorState.brightness!==1 || editorState.contrast!==1 || editorState.colorR!==1 || editorState.colorG!==1 || editorState.colorB!==1 ) {\r\n            pixelArray = tools.ColorCorrection(pixelArray, editorState.brightness, editorState.contrast, editorState.colorR, editorState.colorG, editorState.colorB);\r\n        }\r\n        if(editorState.sepia) {\r\n            pixelArray = tools.ColorSepia(pixelArray, 1);\r\n        }\r\n        if(editorState.saturate!==1) {\r\n            pixelArray = tools.saturate(pixelArray, editorState.saturate);\r\n        }\r\n        ctx.putImageData(pixelArray, 0, 0);\r\n\r\n        if(this.props.app.isDebugShow) {\r\n            // draw source rect\r\n            const {sX, sY, sW, sH} = calculateImageDimensions(this.props.app, this.props.app.currentImage);\r\n            const r = editorState.ratio;\r\n            const z = editorState.imageZoom;\r\n            const w = 6;\r\n            ctx.lineWidth = w;\r\n            ctx.strokeStyle = \"yellow\";\r\n            // console.log(Math.round(sX*r*z), Math.round(sY*r*z), Math.round(sW*r*z), Math.round(sH*r*z));\r\n            ctx.strokeRect(Math.round(sX*r*z)+w, Math.round(sY*r*z)+w, Math.round(sW*r*z)-w*2, Math.round(sH*r*z)-w*2 );\r\n        }\r\n\r\n    }\r\n\r\n    onDragStart = (e) => {\r\n        e.preventDefault();\r\n        return false;\r\n    };\r\n\r\n    movingStart =() =>{\r\n        this.setState({\r\n            dragImage: true,\r\n            dragX: null,\r\n            dragY: null,\r\n        });\r\n\r\n    };\r\n    movingOn = (e) => {\r\n        if(this.state.dragImage) {\r\n            const dragX = this.state.dragX ? this.state.dragX : e.screenX;\r\n            const dragY = this.state.dragY ? this.state.dragY : e.screenY;\r\n            const shiftX = e.screenX - dragX;\r\n            const shiftY = e.screenY - dragY;\r\n            // console.log(shiftX, shiftY);\r\n            this.setState({\r\n                dragX: e.screenX,\r\n                dragY: e.screenY,\r\n            }, ()=> {\r\n                const sliderPositionLR = this.props.app.images[this.props.app.currentImage].editorState.sliderPositionLR + shiftX;\r\n                const sliderPositionTB = this.props.app.images[this.props.app.currentImage].editorState.sliderPositionTB + shiftY;\r\n                this.props.appImageChanged(this.props.app.currentImage, {sliderPositionLR: sliderPositionLR, sliderPositionTB: sliderPositionTB})\r\n            });\r\n\r\n        }\r\n    };\r\n    movingStop =() =>{\r\n        this.setState({\r\n            dragImage: false,\r\n            dragX: null,\r\n            dragY: null,\r\n        });\r\n\r\n    };\r\n\r\n    render() {\r\n        // console.log('ZoomCanvas render');\r\n        const newImage = this.renderedImageIndex !== this.props.app.currentImage;\r\n        this.renderedImageIndex = this.props.app.currentImage;\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n        if(newImage) {\r\n            let img_src = tools.makeGetUri()+encodeURI(image.src);\r\n            if(this.canvasImg.src!==img_src) {\r\n                this.canvasImg.src=img_src;\r\n            }\r\n        }\r\n\r\n\r\n        // console.log('render ImageEditorZoomCanvas ');\r\n        let maskTBStyle = {\r\n            height: image.editorState.maskTB,\r\n        };\r\n        let viewportStyles = {\r\n            height: this.props.app.editorHeight - image.editorState.maskTB*2,\r\n            width: this.props.app.editorWidth - image.editorState.maskLR*2,\r\n            top: image.editorState.maskTB,\r\n            left: image.editorState.maskLR,\r\n        };\r\n        let maskLRStyle = {\r\n            width: image.editorState.maskLR,\r\n        };\r\n\r\n        let canvasWidth = image.editorState.imgWidth;\r\n        let canvasHeight = image.editorState.imgHeight;\r\n        let canvasStyle = {\r\n            top: image.editorState.sliderPositionTB,\r\n            left: image.editorState.sliderPositionLR,\r\n            transform: 'rotate('+image.editorState.imageRotate+'deg)',\r\n        };\r\n\r\n        let rL, rR, rT, rB;\r\n        if(this.props.app.isDebugShow) {\r\n            const p = calculateImageDimensions(this.props.app, this.props.app.currentImage);\r\n            // console.log(p);\r\n            const ratio = image.editorState.ratio;\r\n            rL = Math.round(p.pX*ratio)+2;\r\n            rR = Math.round((p.pX+p.pW)*ratio)-2;\r\n            rT = Math.round(p.pY*ratio)+2;\r\n            rB = Math.round((p.pY+p.pH)*ratio)-2;\r\n\r\n            // console.log(rT, rR, rB, rL);\r\n            // console.log('-----------------');\r\n        }\r\n\r\n       return (\r\n           <div className=\"app-main-editor-Printable-Mask border-light fld3d\">\r\n               <div className=\"app-main-editor-Printable-mask _t\" style={{height:'1rem'}} />\r\n               <div className=\"app-main-editor-Printable-mask _l\" style={{width:'1rem'}} />\r\n               <div ref={(node)=>{this.myImgContainer=node}} className='app-main-editor-Printable' >\r\n\r\n                   <div className=\"app-main-editor-Printable-mask _t\" style={maskTBStyle} />\r\n                   <div className=\"app-main-editor-Printable-mask _l\" style={maskLRStyle} />\r\n\r\n                   <div onMouseMove={this.movingOn} onMouseUp={this.movingStop} className=\"app-main-editor-Printable-viewport\"\r\n                        style={viewportStyles}>\r\n                       <canvas\r\n                           className=\"app-main-editor-Printable-img\"\r\n                           ref={(node)=>{this.myCanvas=node}}\r\n                           width={ canvasWidth }\r\n                           height={ canvasHeight}\r\n                           style={ canvasStyle }\r\n                           draggable\r\n                           onDragStart={(e)=>this.onDragStart(e)}\r\n                           onMouseDown={this.movingStart}\r\n                           onMouseUp={this.movingStop}\r\n                       />\r\n\r\n                       {this.props.app.isDebugShow && (\r\n                           <div className=\"vRuler vRulerX\" style={{left: rL}} />\r\n                       )}\r\n                       {this.props.app.isDebugShow && (\r\n                           <div className=\"vRuler vRulerW\" style={{left: rR}} />\r\n                       )}\r\n                       {this.props.app.isDebugShow && (\r\n                           <div className=\"hRuler hRulerY\" style={{top: rT}} />\r\n                       )}\r\n                       {this.props.app.isDebugShow && (\r\n                           <div className=\"hRuler hRulerH\" style={{top: rB}} />\r\n                       )}\r\n\r\n                   </div>\r\n                   <div className=\"app-main-editor-Printable-mask _r\" style={maskLRStyle} />\r\n                   <div className=\"app-main-editor-Printable-mask _b\" style={maskTBStyle} />\r\n\r\n\r\n               </div>\r\n               <div className=\"app-main-editor-Printable-mask _r\" style={{width:'1rem'}} />\r\n               <div className=\"app-main-editor-Printable-mask _b\" style={{height:'1rem'}} />\r\n\r\n           </div>\r\n\r\n\r\n\r\n        );\r\n    }\r\n}\r\n\r\n","import React from \"react\";\r\nimport Slider from \"@material-ui/lab/Slider\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport ImageEditorZoomCanvas from \"./ImageEditorZoomCanvas\"\r\nimport * as tools from \"../../tools\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\n\r\nexport default class ImageEditorZoom extends React.Component {\r\n    // constructor(props) {\r\n    //     super(props);\r\n    //     this.updateCanvasTimer = null;\r\n    //\r\n    //     this.state = {\r\n    //         needUpdateCanvas: false,\r\n    //     }\r\n    // }\r\n\r\n\r\n    sliderZoom = (event, value)=>{\r\n        const state = this.props.app;\r\n        const image = state.images[state.currentImage];\r\n\r\n        let imageZoom = value / 100;\r\n\r\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi)*imageZoom*image.editorState.ratio;\r\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi)*imageZoom*image.editorState.ratio;\r\n\r\n        let L = (image.editorState.imgWidth - imgWidth)/2;\r\n        let T = (image.editorState.imgHeight - imgHeight)/2;\r\n\r\n        // state.needUpdateCanvas = true;\r\n        // state.images[state.currentImage].editorState.imageZoom = imageZoom;\r\n        // state.images[state.currentImage].editorState.sliderPositionTB = image.sliderPositionTB + T;\r\n        // state.images[state.currentImage].editorState.sliderPositionLR = image.sliderPositionLR + L;\r\n        // state.images[state.currentImage].editorState.imgWidth = imgWidth;\r\n        // state.images[state.currentImage].editorState.imgHeight = imgHeight;\r\n        // this.props.saveAppState( state );\r\n\r\n        let newState = {\r\n            imageZoom: imageZoom,\r\n            sliderPositionTB: image.editorState.sliderPositionTB + T,\r\n            sliderPositionLR: image.editorState.sliderPositionLR + L,\r\n            imgWidth: imgWidth,\r\n            imgHeight: imgHeight,\r\n            needUpdateCanvas: true,\r\n        };\r\n\r\n        this.props.appImageChanged( this.props.app.currentImage, newState);\r\n\r\n    };\r\n\r\n    sliderChangeTB = (event, value)=>{this.props.appImageChanged( this.props.app.currentImage, { sliderPositionTB: value, }) };\r\n\r\n    sliderChangeLR = (event, value)=>{this.props.appImageChanged( this.props.app.currentImage, { sliderPositionLR: value, }) };\r\n\r\n    imageRotate = ()=> {\r\n        let imageRotate = 0;\r\n        switch (this.props.app.images[this.props.app.currentImage].editorState.imageRotate) {\r\n            case 90:\r\n                imageRotate = 180;\r\n                break;\r\n            case 180:\r\n                imageRotate = 270;\r\n                break;\r\n            case 270:\r\n                imageRotate = 0;\r\n                break;\r\n            default:\r\n                imageRotate = 90;\r\n                break;\r\n        }\r\n        this.props.appImageChanged( this.props.app.currentImage, { imageRotate: imageRotate });\r\n    };\r\n\r\n    render() {\r\n        // console.log('render ImageEditorZoom, imgWidth:', this.props.parentState.imgWidth);\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n\r\n        return (\r\n            <div className=\"h-100 d-flex flex-row\">\r\n                <div className=\"app-main-editor-visual-left h-90 flex-grow-0 flex-shrink-0\">\r\n                    <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\r\n                        <Fab color=\"primary\" className={'_fabmini ml-3'}\r\n                             onClick={()=>{this.sliderZoom(null, image.editorState.imageZoom*100+0.51)}}\r\n                             disabled={false}\r\n                             aria-label=\"Colors\">\r\n                            <Icon>zoom_in</Icon>\r\n                        </Fab>\r\n                    </div>\r\n                    <div className=\"vert-slider-wrapper h-85 position-relative d-inline-block\">\r\n\r\n                        <Slider className='app-slider-for-zoom'\r\n                                classes={{thumb: '_thumb'}}\r\n                                thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>zoom_in</Icon>}\r\n                                vertical\r\n                                max={image.editorState.imageZoomMax*100}\r\n                                min={image.editorState.imageZoomMin*100}\r\n                                value={image.editorState.imageZoom*100}\r\n                                onChange={this.sliderZoom} />\r\n                        {this.props.app.isDebugShow && (\r\n                        <div className={'_value'}><small>{image.editorState.imageZoom}</small></div>\r\n                        )}\r\n\r\n                    </div>\r\n                    <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\r\n                        <Fab color=\"primary\" className={'_fabmini ml-3'}\r\n                             onClick={()=>{this.sliderZoom(null, image.editorState.imageZoom*100-0.51)}}\r\n                             disabled={false}\r\n                             aria-label=\"Colors\">\r\n                            <Icon>zoom_out</Icon>\r\n                        </Fab>\r\n                    </div>\r\n                </div>\r\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\r\n                    <div className=\"h-90\">\r\n                        <ImageEditorZoomCanvas\r\n                            {...this.props}\r\n                        />\r\n                    </div>\r\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100  d-flex flex-row\">\r\n                        <div className=\"hori-slider-button-wrapper text-center flex-grow-0\">\r\n                            <Fab color=\"primary\" className=\"_fabmini mt-3\"\r\n                                 onClick={()=>{this.sliderChangeLR(null, image.editorState.sliderPositionLR-1)}}\r\n                                 disabled={false}\r\n                                 aria-label=\"Colors\">\r\n                                <Icon>navigate_before</Icon>\r\n                            </Fab>\r\n                        </div>\r\n                        <div className=\" flex-grow-1\">\r\n                            <div className=\"hori-slider-wrapper h-100 w-100 position-relative d-inline-flex\">\r\n                                <Slider className='app-slider-for-position'\r\n                                        classes={{trackAfter: '_trackAfter', thumb: '_thumb'}}\r\n                                        thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>image</Icon>}\r\n                                        max={(this.props.app.editorWidth-image.editorState.maskLR*2)*0.9}\r\n                                        value={image.editorState.sliderPositionLR}\r\n                                        min={(image.editorState.imgWidth)*-0.9}\r\n                                        onChange={this.sliderChangeLR}\r\n                                />\r\n\r\n                                {this.props.app.isDebugShow && (\r\n                                    <div className={'_value'}><small>({image.editorState.sliderPositionLR})</small></div>\r\n                                )}\r\n                            </div>\r\n\r\n                        </div>\r\n                        <div className=\"hori-slider-button-wrapper text-center flex-grow-0\" >\r\n                            <Fab color=\"primary\" className={'_fabmini mt-3'}\r\n                                 onClick={()=>{this.sliderChangeLR(null, image.editorState.sliderPositionLR+1)}}\r\n                                 disabled={false}\r\n                                 aria-label=\"Colors\">\r\n                                <Icon>navigate_next</Icon>\r\n                            </Fab>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\r\n\r\n                    <div className=\"d-inline-flex flex-column h-100\">\r\n                        <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\r\n                            <Fab color=\"primary\" className={'_fabmini'}\r\n                                 onClick={()=>{this.sliderChangeTB(null, image.editorState.sliderPositionTB-1)}}\r\n                                 disabled={false}\r\n                                 aria-label=\"Colors\">\r\n                                <Icon>expand_less</Icon>\r\n                            </Fab>\r\n                        </div>\r\n                        <div className=\"vert-slider-wrapper h-85 position-relative d-inline-flex\">\r\n                            <Slider className='app-slider-for-position'\r\n                                    classes={{trackAfter: '_trackAfter', thumb: '_thumb'}}\r\n                                    thumb={<Icon className={'app-slider-thumb-icon'} color='primary'>image</Icon>}\r\n                                    max={(image.editorState.imgHeight)*-0.9}\r\n                                    value={image.editorState.sliderPositionTB}\r\n                                    min={(this.props.app.editorHeight-image.editorState.maskTB*2)*0.9}\r\n                                    onChange={this.sliderChangeTB}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                                <div className={'_value'}><small>({image.editorState.sliderPositionTB})</small></div>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"vert-slider-button-wrapper text-center d-inline-block\">\r\n                            <Fab color=\"primary\" className={'_fabmini'}\r\n                                 onClick={()=>{this.sliderChangeTB(null, image.editorState.sliderPositionTB+1)}}\r\n                                 disabled={false}\r\n                                 aria-label=\"Colors\">\r\n                                <Icon>expand_more</Icon>\r\n                            </Fab>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n\r\n                    <div className=\"vert-buttons-wrapper h-100 d-inline-flex\">\r\n                        <div className=\"app-main-editor-visual-right-buttons\">\r\n                            <div className=\"zoom-positioning\">\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1  d-inline-block\"/>\r\n                                <div className=\"zoom-positioning-w2 zoom-positioning-h1 d-inline-block\">\r\n                                    <button type=\"button\"\r\n                                            className={\"btn btn-primary h-100\"}\r\n                                            onClick={()=>{this.props.alignTop()}}>\r\n                                        <Icon>vertical_align_top</Icon>\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\r\n                            </div>\r\n                            <div className=\"zoom-positioning\">\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h2 d-inline-block\">\r\n                                    <button type=\"button\"\r\n                                            className={\"btn btn-primary h-100\"}\r\n                                            onClick={()=>{this.props.alignLeft()}}>\r\n                                        <Icon style={{transform:'rotate(270deg)'}}>vertical_align_top</Icon>\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"d-inline-block\">\r\n                                    <div className=\"zoom-positioning-w2 zoom-positioning-h1\">\r\n                                        <button type=\"button\"\r\n                                                className={\"btn btn-primary h-100\"}\r\n                                                onClick={()=>{this.props.alignLandscape(this.props.app.currentImage, image.format)}}>\r\n                                            <Icon>swap_horiz</Icon>\r\n                                        </button>\r\n                                    </div>\r\n                                    <div className=\"zoom-positioning-w2 zoom-positioning-h1\">\r\n                                        <button type=\"button\"\r\n                                                className={\"btn btn-primary h-100\"}\r\n                                                onClick={()=>{this.props.alignPortrait(this.props.app.currentImage, image.format)}}>\r\n                                            <Icon>swap_vert</Icon>\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h2 d-inline-block\">\r\n                                    <button type=\"button\"\r\n                                            className={\"btn btn-primary h-100\"}\r\n                                            onClick={()=>{this.props.alignRight()}}>\r\n                                        <Icon style={{transform:'rotate(90deg)'}}>vertical_align_top</Icon>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"zoom-positioning\">\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\r\n                                <div className=\"zoom-positioning-w2 zoom-positioning-h1 d-inline-block\">\r\n                                    <button type=\"button\"\r\n                                            className={\"btn btn-primary h-100\"}\r\n                                            onClick={()=>{this.props.alignBottom()}}>\r\n                                        <Icon style={{transform:'rotate(180deg)'}}>vertical_align_top</Icon>\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"zoom-positioning-w1 zoom-positioning-h1 d-inline-block\"/>\r\n                            </div>\r\n                            <div className=\"app-main-editor-visual-rotate-buttons mt-4 text-center\">\r\n                                <button type=\"button\"\r\n                                        className={\"btn  btn-big btn-primary\"}\r\n                                        onClick={this.imageRotate}>\r\n                                    <Icon>rotate_right</Icon>\r\n                                </button>\r\n                            </div>\r\n\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport * as tools from \"../../tools\";\r\n\r\nexport default class ImageEditorColorCanvas extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.canvasImg = new Image();\r\n        this.canvasImg.crossOrigin = 'anonymous';\r\n        const _upd = this.updateCanvas.bind(this);\r\n        this.canvasImg.onload = function() {\r\n            _upd();\r\n        };\r\n\r\n\r\n\r\n        this.state = {\r\n            imgSrc: null,\r\n            fakeThins: true,\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n\r\n        // console.log('componentDidUpdate');\r\n\r\n        if(this.props.app.currentImage!==prevProps.app.currentImage) {\r\n            console.log('new image clicked');\r\n            this.setState({\r\n                imgSrc: null,\r\n            });\r\n            return;\r\n        }\r\n\r\n        this.props.appEditorChanged(this.myImgContainer.clientWidth, this.myImgContainer.clientHeight);\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n        if(!image.editorState.initedMask) {\r\n            this.props.appImageInitMask(this.props.app.currentImage);\r\n            return;\r\n        }\r\n\r\n        if(!image.editorState.initedImagePosition) {\r\n            this.props.alignInit(this.props.app.currentImage);\r\n            return;\r\n        }\r\n\r\n        let img_src = tools.makeGetUri()+encodeURI(image.src);\r\n        if(this.canvasImg.src!==img_src) {\r\n            const _upd = this.updateCanvas.bind(this);\r\n            this.canvasImg.onload = function() {\r\n                _upd();\r\n            };\r\n            this.canvasImg.src=img_src;\r\n            return;\r\n        }\r\n\r\n        // if(image.editorState.needUpdateCanvas) {\r\n        this.updateCanvas();\r\n        // }\r\n\r\n\r\n    }\r\n\r\n    updateCanvas() {\r\n\r\n        // console.log('Zoom updateCanvas');\r\n        if(!this.myCanvas || this.myCanvas.clientWidth===0 || this.myCanvas.clientHeight===0) return;\r\n\r\n        const ctx = this.myCanvas.getContext('2d');\r\n        let canvasX = this.myCanvas.clientWidth;\r\n        let canvasY = this.myCanvas.clientHeight;\r\n        // console.log('drawImage', this.canvasImg.src, canvasX, canvasY);\r\n\r\n        const editorState = this.props.app.images[this.props.app.currentImage].editorState;\r\n        ctx.drawImage(this.canvasImg, 0, 0, canvasX, canvasY);\r\n        let pixelArray = ctx.getImageData(0,0, canvasX, canvasY);\r\n\r\n        if(editorState.brightness!==1 || editorState.contrast!==1 || editorState.colorR!==1 || editorState.colorG!==1 || editorState.colorB!==1 ) {\r\n            pixelArray = tools.ColorCorrection(pixelArray, editorState.brightness, editorState.contrast, editorState.colorR, editorState.colorG, editorState.colorB);\r\n        }\r\n        if(editorState.sepia) {\r\n            pixelArray = tools.ColorSepia(pixelArray, 1);\r\n        }\r\n        if(editorState.saturate!==1) {\r\n            pixelArray = tools.saturate(pixelArray, editorState.saturate);\r\n        }\r\n        ctx.putImageData(pixelArray, 0, 0);\r\n\r\n        // this.setState({\r\n        //     imgSrc: this.myCanvas.toDataURL('image/jpeg', 0.7),\r\n        // });\r\n        // this.props.appImageChanged( this.props.app.currentImage,{needUpdateCanvas: false})\r\n    }\r\n\r\n    render() {\r\n\r\n        // console.log('ColorCanvas render');\r\n        const newImage = this.renderedImageIndex !== this.props.app.currentImage;\r\n        this.renderedImageIndex = this.props.app.currentImage;\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n        if(newImage) {\r\n            let img_src = tools.makeGetUri()+encodeURI(image.src);\r\n            if(this.canvasImg.src!==img_src) {\r\n                this.canvasImg.src=img_src;\r\n            }\r\n        }\r\n\r\n\r\n        // console.log('render ImageEditorZoomCanvas ');\r\n        let maskTBStyle = {\r\n            height: image.editorState.maskTB,\r\n        };\r\n        let viewportStyles = {\r\n            height: this.props.app.editorHeight - image.editorState.maskTB*2,\r\n            width: this.props.app.editorWidth - image.editorState.maskLR*2,\r\n            top: image.editorState.maskTB,\r\n            left: image.editorState.maskLR,\r\n        };\r\n        let maskLRStyle = {\r\n            width: image.editorState.maskLR,\r\n        };\r\n\r\n        let canvasWidth = image.editorState.imgWidth;\r\n        let canvasHeight = image.editorState.imgHeight;\r\n        let canvasStyle = {\r\n            top: image.editorState.sliderPositionTB,\r\n            left: image.editorState.sliderPositionLR,\r\n            transform: 'rotate('+image.editorState.imageRotate+'deg)',\r\n        };\r\n\r\n        return (\r\n            <div className=\"app-main-editor-Printable-Mask border-light fld3d\">\r\n                <div className=\"app-main-editor-Printable-mask _t\" style={{height:'1rem'}} />\r\n                <div className=\"app-main-editor-Printable-mask _l\" style={{width:'1rem'}} />\r\n\r\n                <div ref={(node)=>{this.myImgContainer=node}} className='app-main-editor-Printable' >\r\n\r\n                    <div className=\"app-main-editor-Printable-mask _t\" style={maskTBStyle} />\r\n                    <div className=\"app-main-editor-Printable-mask _l\" style={maskLRStyle} />\r\n\r\n                    <div className=\"app-main-editor-Printable-viewport\"\r\n                         style={viewportStyles}>\r\n                        <canvas\r\n                            className=\"app-main-editor-Printable-img\"\r\n                            ref={(node)=>{this.myCanvas=node}}\r\n                            width={ canvasWidth }\r\n                            height={ canvasHeight}\r\n                            style={ canvasStyle }\r\n                        />\r\n\r\n\r\n\r\n                    </div>\r\n                    <div className=\"app-main-editor-Printable-mask _r\" style={maskLRStyle} />\r\n                    <div className=\"app-main-editor-Printable-mask _b\" style={maskTBStyle} />\r\n\r\n\r\n                </div>\r\n\r\n                <div className=\"app-main-editor-Printable-mask _r\" style={{width:'1rem'}} />\r\n                <div className=\"app-main-editor-Printable-mask _b\" style={{height:'1rem'}} />\r\n\r\n            </div>\r\n\r\n\r\n        );\r\n    }\r\n}\r\n\r\n","import React from \"react\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Slider from \"@material-ui/lab/Slider\";\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\nimport ImageEditorColorCanvas from \"./ImageEditorColorCanvas\";\r\n\r\n\r\nexport default class ImageEditorBrightness extends React.Component {\r\n\r\n    sliderChangeBrightness =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, brightness: value} );\r\n        // this.props.setStateFromChild({ brightness: value, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderChangeContrast =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, contrast: value} );\r\n        // this.props.setStateFromChild({ contrast: value, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderChangeSaturate =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, saturate: value} );\r\n        // this.props.setStateFromChild({ saturate: value, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderResetBrightness =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, brightness: 1} );\r\n        // this.props.setStateFromChild({ brightness: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderResetContrast =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, contrast: 1} );\r\n        // this.props.setStateFromChild({ contrast: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderResetSaturate =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, saturate: 1} );\r\n        // this.props.setStateFromChild({ saturate: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderChangeSepia = () => {\r\n        this.props.appImageChanged(this.props.app.currentImage, {\r\n            sepia: !this.props.app.images[this.props.app.currentImage].editorState.sepia,\r\n            colorR: 1,\r\n            colorG: 1,\r\n            colorB: 1,\r\n            needUpdateCanvas: true,\r\n        } );\r\n        // this.props.setStateFromChild({\r\n        //     sepia: !this.props.parentState.sepia,\r\n        //     colorR: 1,\r\n        //     colorG: 1,\r\n        //     colorB: 1,\r\n        //     needUpdateCanvas: true,\r\n        // }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n\r\n\r\n    render() {\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n\r\n        return (\r\n            <div className=\"h-100 d-flex flex-row\">\r\n                <div className=\"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0\">\r\n                </div>\r\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\r\n                    <div className=\"h-90\">\r\n                        <ImageEditorColorCanvas\r\n                            {...this.props}\r\n                        />\r\n                    </div>\r\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100\">\r\n\r\n                    </div>\r\n                </div>\r\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\r\n                    <div className=\"h-75\">\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetBrightness}>brightness_medium</Icon>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    max={2}\r\n                                    value={image.editorState.brightness}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeBrightness}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.brightness})</small></div>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetContrast}>tonality</Icon>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    max={2}\r\n                                    value={image.editorState.contrast}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeContrast}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.contrast})</small></div>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <Icon className={'_reset'} color='primary' onClick={this.sliderResetSaturate}>color_lens</Icon>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    max={2}\r\n                                    value={image.editorState.saturate}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeSaturate}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.saturate})</small></div>\r\n                            )}\r\n                        </div>\r\n\r\n\r\n                    </div>\r\n                    <div className=\"h-25\">\r\n                        <div className=\"hori-slider-wrapper w-100 position-relative d-inline-flex\">\r\n                            <FormControlLabel\r\n                                control={\r\n                                    <Switch\r\n                                        checked={image.editorState.sepia}\r\n                                        onChange={this.sliderChangeSepia}\r\n                                        value=\"true\"\r\n                                        color=\"primary\"\r\n                                    />\r\n                                }\r\n                                label=\"Sepia\"\r\n                            />\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n\r\n    }\r\n}\r\n\r\n","import React from \"react\";\r\nimport {THEME} from \"../../tools\";\r\nimport Slider from \"@material-ui/lab/Slider\";\r\nimport ImageEditorColorCanvas from \"./ImageEditorColorCanvas\";\r\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\n\r\nexport default class ImageEditorBrightness extends React.Component {\r\n\r\n    sliderChangeColorR =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorR: value} );\r\n\r\n        // this.props.setStateFromChild({ colorR: value, needUpdateCanvas: true }, ()=>{\r\n        //         this.props.setStateFromChild({needUpdateCanvas: false});\r\n        //     })\r\n    };\r\n    sliderChangeColorG =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorG: value} );\r\n        // this.props.setStateFromChild({ colorG: value, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderChangeColorB =  (event, value)=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorB: value} );\r\n        // this.props.setStateFromChild({ colorB: value, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n\r\n    sliderResetColorR =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorR: 1} );\r\n        // this.props.setStateFromChild({ colorR: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderResetColorG =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorG: 1} );\r\n        // this.props.setStateFromChild({ colorG: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderResetColorB =  ()=>{\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas: true, colorB: 1} );\r\n        // this.props.setStateFromChild({ colorB: 1, needUpdateCanvas: true }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n    sliderChangeSepia = () => {\r\n        this.props.appImageChanged(this.props.app.currentImage, {\r\n            sepia: !this.props.app.images[this.props.app.currentImage].editorState.sepia,\r\n            colorR: 1,\r\n            colorG: 1,\r\n            colorB: 1,\r\n            needUpdateCanvas: true,\r\n        });\r\n        // this.props.setStateFromChild({\r\n        //     sepia: !this.props.parentState.sepia,\r\n        //     colorR: 1,\r\n        //     colorG: 1,\r\n        //     colorB: 1,\r\n        //     needUpdateCanvas: true,\r\n        // }, ()=>{\r\n        //     this.props.setStateFromChild({needUpdateCanvas: false});\r\n        // })\r\n    };\r\n\r\n\r\n\r\n    render() {\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n\r\n        return (\r\n            <div className=\"h-100 d-flex flex-row\">\r\n                <div className=\"app-main-editor-visual-left h-90  flex-grow-0 flex-shrink-0\">\r\n                </div>\r\n                <div className=\"app-main-editor-visual-container h-100  flex-grow-1 flex-shrink-1\">\r\n                    <div className=\"h-90\">\r\n                        <ImageEditorColorCanvas\r\n                            {...this.props}\r\n                        />\r\n                    </div>\r\n                    <div className=\"app-main-editor-visual-bottom h-10 w-100\">\r\n\r\n                    </div>\r\n                </div>\r\n                <div className=\"app-main-editor-visual-right h-90  flex-grow-0 flex-shrink-0\">\r\n                    <div className=\"h-75\">\r\n\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <div className=\"_reset app-slider-icon\"\r\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\r\n                                 onClick={this.sliderResetColorR}>R</div>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    classes={{track: '_trackR', thumb: '_thumbR'}}\r\n                                    step={0.05}\r\n                                    max={2}\r\n                                    value={image.editorState.colorR}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeColorR}\r\n                                    disabled={image.editorState.sepia}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.colorR})</small></div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <div className=\"_reset app-slider-icon\"\r\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\r\n                                 onClick={this.sliderResetColorG}>G</div>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    classes={{track: '_trackG', thumb: '_thumbG'}}\r\n                                    step={0.05}\r\n                                    max={2}\r\n                                    value={image.editorState.colorG}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeColorG}\r\n                                    disabled={image.editorState.sepia}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.colorG})</small></div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"vert-slider-wrapper h-100 position-relative d-inline-flex\">\r\n                            <div className=\"_reset app-slider-icon\"\r\n                                 style={{backgroundColor: THEME.palette.primary.main, color:THEME.palette.primary.contrastText }}\r\n                                 onClick={this.sliderResetColorB}>B</div>\r\n                            <Slider className='app-slider-for-filter'\r\n                                    classes={{track: '_trackB', thumb: '_thumbB'}}\r\n                                    step={0.05}\r\n                                    max={2}\r\n                                    value={image.editorState.colorB}\r\n                                    min={0}\r\n                                    onChange={this.sliderChangeColorB}\r\n                                    disabled={image.editorState.sepia}\r\n                                    vertical\r\n                            />\r\n                            {this.props.app.isDebugShow && (\r\n                            <div className={'_value'}><small>({image.editorState.colorB})</small></div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"h-25\">\r\n                        <div className=\"hori-slider-wrapper w-100 position-relative d-inline-flex\">\r\n                            <FormControlLabel\r\n                                control={\r\n                                    <Switch\r\n                                        checked={image.editorState.sepia}\r\n                                        onChange={this.sliderChangeSepia}\r\n                                        value=\"true\"\r\n                                        color=\"primary\"\r\n                                    />\r\n                                }\r\n                                label=\"Sepia\"\r\n                            />\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </div>\r\n\r\n        )\r\n\r\n    }\r\n}\r\n\r\n","import React from \"react\";\r\nimport * as tools from \"../../tools\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Fab from '@material-ui/core/Fab';\r\nimport ImageEditorZoom from \"./ImageEditorZoom\";\r\nimport ImageEditorBrightness from \"./ImageEditorBrightness\";\r\nimport ImageEditorColor from \"./ImageEditorColor\";\r\nimport Paper from \"@material-ui/core/Paper\";\r\n\r\nexport default class ImageEditor extends React.Component {\r\n    // constructor(props) {\r\n    //     super(props);\r\n    //     this.editorControlsStyle = null;\r\n    //     // this.need_init = true;\r\n    //\r\n    //     this.\r\n    // }\r\n    state = {\r\n        editorControlsStyle: null,\r\n        showTabButton: true,\r\n    };\r\n\r\n    componentDidMount(){\r\n        // console.log('componentDidMount');\r\n        // let editorControls_h = this.editorWrapper.clientHeight - this.editorTabs.clientHeight;\r\n        //\r\n        // this.editorControlsStyle = {height: editorControls_h};\r\n        // this.forceUpdate();\r\n        // console.log('componentDidMount, height:', this.editorWrapper.clientHeight - this.editorTabs.clientHeight);\r\n        this.setState({\r\n            editorControlsStyle: {height: this.editorWrapper.clientHeight - this.editorTabs.clientHeight}\r\n        });\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if(!this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\r\n            this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas:true, currentTab:0} );\r\n        }\r\n    }\r\n\r\n    tabChange = (value) => {\r\n        this.props.appImageChanged( this.props.app.currentImage, {needUpdateCanvas:true, currentTab:value} );\r\n    };\r\n\r\n    // setStateFromChild=(newState, callback)=> {\r\n    //     // console.log(newState);\r\n    //     this.setState(newState, ()=>{\r\n    //         if(typeof(callback)==='function') callback();\r\n    //     });\r\n    // };\r\n\r\n\r\n    alignTop = ()=> {\r\n        let image = this.props.app.images[this.props.app.currentImage];\r\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\r\n        let sliderPositionTB = 0;\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n            sliderPositionTB = (image.editorState.imgWidth-image.editorState.imgHeight)/2;\r\n        }\r\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionTB:sliderPositionTB} );\r\n    };\r\n\r\n    alignRight = ()=> {\r\n        let image = this.props.app.images[this.props.app.currentImage];\r\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\r\n\r\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi)*image.editorState.imageZoom*image.editorState.ratio;\r\n        let sliderPositionLR = this.props.app.editorWidth - image.editorState.maskLR*2 - imgWidth;\r\n\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n            sliderPositionLR += (image.editorState.imgWidth-image.editorState.imgHeight)/2;\r\n        }\r\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionLR: sliderPositionLR} );\r\n\r\n    };\r\n\r\n    alignBottom = ()=> {\r\n        let image = this.props.app.images[this.props.app.currentImage];\r\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\r\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi)*image.editorState.imageZoom*image.editorState.ratio;\r\n        let sliderPositionTB =  this.props.app.editorHeight - image.editorState.maskTB*2 - imgHeight;\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n            sliderPositionTB -= (image.editorState.imgWidth-image.editorState.imgHeight)/2;\r\n        }\r\n\r\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionTB:sliderPositionTB} );\r\n    };\r\n\r\n    alignLeft = ()=> {\r\n        let image = this.props.app.images[this.props.app.currentImage];\r\n        // if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) return;\r\n        let sliderPositionLR = 0;\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270) {\r\n            sliderPositionLR -= (image.editorState.imgWidth-image.editorState.imgHeight)/2;\r\n        }\r\n\r\n        this.props.appImageChanged( this.props.app.currentImage, {sliderPositionLR:sliderPositionLR} );\r\n    };\r\n\r\n    render() {\r\n\r\n        const image = this.props.app.images[this.props.app.currentImage];\r\n        let currentTab = image.editorState.currentTab;\r\n        if(currentTab<0 || currentTab>2) currentTab = 0;\r\n\r\n        return (\r\n            <div className=\"h-100\" ref={(node)=>{this.editorWrapper=node}}>\r\n                <div ref={(node)=>{this.editorTabs=node}} className=\"app-main-editor-visual-container-tabs\">\r\n\r\n                </div>\r\n                <Paper style={this.state.editorControlsStyle} className=\"app-main-editor-visual-container-controls app-bg-e position-relative\">\r\n                    {currentTab===0 &&(\r\n                        <ImageEditorZoom\r\n                            {...this.props}\r\n                            alignTop = {this.alignTop.bind(this)}\r\n                            alignRight = {this.alignRight.bind(this)}\r\n                            alignBottom = {this.alignBottom.bind(this)}\r\n                            alignLeft = {this.alignLeft.bind(this)}\r\n                        />\r\n                    )}\r\n                    {currentTab===1 &&(\r\n                        <ImageEditorBrightness\r\n                            {...this.props}\r\n                        />\r\n                    )}\r\n                    {currentTab===2 &&(\r\n                        <ImageEditorColor\r\n                            {...this.props}\r\n                        />\r\n                    )}\r\n\r\n                    <div onClick={ ()=>{this.setState({showTabButton: !this.state.showTabButton})} }\r\n                        className=\"app-btn-pie app-main-editor-tabs-pie bg-primary text-light \">\r\n                        <Icon>settings_brightness</Icon>\r\n                    </div>\r\n\r\n                    {this.state.showTabButton &&(\r\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\r\n                             style={{right: '1em', bottom: '8em'}}\r\n                             onClick={()=>{this.tabChange(2)}}\r\n                             disabled={false}\r\n                             aria-label=\"Colors\">\r\n                            <Icon>tune</Icon>\r\n                        </Fab>\r\n\r\n                    )}\r\n\r\n                    {this.state.showTabButton &&(\r\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\r\n                             style={{right: '5.5em', bottom: '5.5em' }}\r\n                             onClick={()=>{this.tabChange(1)}}\r\n                             disabled={false}\r\n                             aria-label=\"Brightness\"\r\n                             type=\"button\" >\r\n                            <Icon>brightness_medium</Icon>\r\n                        </Fab>\r\n                    )}\r\n\r\n                    {this.state.showTabButton &&(\r\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\r\n                             style={{right: '8em', bottom: '1em' }}\r\n                             onClick={()=>{this.tabChange(0)}}\r\n                             disabled={false}\r\n                             aria-label=\"Zoom\">\r\n                            <Icon>transform</Icon>\r\n                        </Fab>\r\n                    )}\r\n\r\n                    {this.state.showTabButton &&(\r\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\r\n                             style={{right: '1em', bottom: '18em' }}\r\n                             onClick={()=>{this.props.changeCountImage(this.props.app.currentImage, image.count+1)}}\r\n                             disabled={image.count>98}\r\n                             aria-label=\"Increase\">\r\n                            <Icon>add</Icon>\r\n                        </Fab>\r\n                    )}\r\n\r\n                    {this.state.showTabButton &&(\r\n                        <Fab color=\"primary\" className={'app-main-editor-tabs-pie-button position-absolute bg-success'}\r\n                             style={{right: '1em', bottom: '13em' }}\r\n                             onClick={()=>{this.props.changeCountImage(this.props.app.currentImage, image.count-1)}}\r\n                             disabled={image.count<0}\r\n                             aria-label=\"Decrease\">\r\n                            <Icon>remove</Icon>\r\n                        </Fab>\r\n                    )}\r\n\r\n                </Paper>\r\n\r\n\r\n\r\n\r\n\r\n\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\n\r\nimport './index.css';\r\n\r\nimport t from \"../i18n\";\r\nimport * as tools from \"../../tools\";\r\n\r\n\r\nimport ImageThumb from \"./ImageThumb\"\r\nimport ImageEditor from \"./ImageEditor\"\r\n\r\nimport Paper from \"@material-ui/core/Paper\";\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\r\n\r\n\r\nexport default class PageEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.undo = {\r\n            history:[],\r\n            current:null,\r\n            skipChanges: true,\r\n        };\r\n\r\n\r\n        this.state = {\r\n            confirmBack: false,\r\n            imagesCount: 0,\r\n            imagesSum: 0,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        // if(this.props.app.currentImage===null)\r\n            this.selectImage(0);\r\n        this.countSumm();\r\n    };\r\n\r\n    countSumm() {\r\n        let imagesCount = 0;\r\n        let imagesSum = 0;\r\n        let len=this.props.app.images.length;\r\n        for(let i=0; i<len; i++) {\r\n            imagesCount += this.props.app.images[i].count;\r\n            imagesSum += this.props.app.images[i].count * this.props.app.images[i].format.cost;\r\n        }\r\n        this.setState({imagesCount:imagesCount, imagesSum:imagesSum})\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState, nextContext) {\r\n        if(this.props.app.images[this.props.app.currentImage].editorState.initedImagePosition && this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\r\n            let wasChanged = true;\r\n            if(this.undo.history.length>0) {\r\n                let lastUndo = this.undo.history[this.undo.history.length-1];\r\n                wasChanged = !(tools.deepCompare(lastUndo, this.props.app.images[this.props.app.currentImage].editorState));\r\n            }\r\n            // console.log('skipChanges:', this.undo.skipChanges, 'history.length', this.undo.history.length);\r\n            if(!this.undo.skipChanges || this.undo.history.length===0) {\r\n                // console.log('wasChanged:', wasChanged);\r\n                if(wasChanged) {\r\n                    if(this.undo.current!==null) {\r\n                        this.undo.history = this.undo.history.slice(0, this.undo.current-1);\r\n                        // console.log('this.undo.history.slice', 0, this.undo.current);\r\n                        // console.log('slice undo', this.undo);\r\n                    }\r\n                    this.undo.history.push( Object.assign({}, this.props.app.images[this.props.app.currentImage].editorState ) );\r\n                    let maxHistoryLength = 99;\r\n                    if(this.undo.history.length>maxHistoryLength) {\r\n                        let start = this.undo.history.length-maxHistoryLength;\r\n                        this.undo.history = this.undo.history.slice(start, start+maxHistoryLength);\r\n                    }\r\n                    this.undo.current =null;\r\n                    // console.log('add undo', this.undo);\r\n                }\r\n            }\r\n            this.undo.skipChanges = false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n\r\n        // if(!this.props.app.images[this.props.app.currentImage].editorState.initedMask) {\r\n\r\n\r\n        // if(!this.props.app.images[0].editorState.initedMask) {\r\n        //     this.selectImage(0);\r\n        //     return;\r\n        // }\r\n        this.props.savePages();\r\n\r\n\r\n    }\r\n\r\n    checkUndo = () => {\r\n        return !(this.undo.history.length===1 || this.undo.current===0);\r\n    };\r\n    clickUndo = () => {\r\n        if(!this.checkUndo) return false;\r\n        let currentUndo = this.undo.history.length-2;\r\n        if(this.undo.current>0) currentUndo = this.undo.current-1;\r\n        this.props.appImageChanged( this.props.app.currentImage, this.undo.history[currentUndo] );\r\n\r\n        this.undo.current = currentUndo;\r\n        this.undo.skipChanges = true;\r\n\r\n        // console.log('clickUndo', currentUndo);\r\n        // console.log('undo:', this.undo);\r\n\r\n    };\r\n\r\n    checkRedo = () => {\r\n        return !(this.undo.current===null || this.undo.current===this.undo.history.length-1);\r\n    };\r\n    clickRedo = () => {\r\n        if(!this.checkRedo) return false;\r\n        let currentUndo = this.undo.current+1;\r\n        this.props.appImageChanged( this.props.app.currentImage, this.undo.history[currentUndo] );\r\n\r\n        this.undo.current = currentUndo;\r\n        this.undo.skipChanges = true;\r\n\r\n        // console.log('clickRedo', currentUndo);\r\n        // console.log('undo:', this.undo);\r\n\r\n    };\r\n\r\n    selectImage = (index) => {\r\n        // console.log('selected '+index, this.props.app.currentImage);\r\n        if(index!==this.props.app.currentImage) {\r\n            this.undo = {\r\n                history:[],\r\n                current:null,\r\n                skipChanges: true,\r\n            };\r\n        }\r\n\r\n        this.props.appSetState({\r\n            currentImage : index,\r\n        });\r\n    };\r\n\r\n    changeCurrentImage = (step) => {\r\n        const newCurrent = this.props.app.currentImage+step;\r\n        if(newCurrent>=0 && newCurrent<this.props.app.images.length) {\r\n            this.selectImage(newCurrent);\r\n        }\r\n    };\r\n\r\n    changeCountImage = (index, count) => {\r\n        if(count>-1) {\r\n            let images = this.props.app.images;\r\n            images[index].count = count;\r\n            let state = {images : images};\r\n            if(count===0) {\r\n                this.changeCurrentImage(1);\r\n            }\r\n            this.props.appSetState(state, ()=>{this.countSumm()})\r\n        } else {\r\n            this.changeCurrentImage(1);\r\n            if(this.props.app.currentImage<this.props.app.images.length-1) {\r\n                this.props.appSetState({currentImage : this.props.app.currentImage+1});\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n\r\n    scrollIntoViewIfNeed = (domNode) => {\r\n        domNode.scrollIntoViewIfNeeded();\r\n    };\r\n\r\n    backPressed() {\r\n        this.setState({confirmBack: true});\r\n\r\n    }\r\n    backConfirmed(back) {\r\n        if(back) {\r\n            this.props.onClickPrevBtn();\r\n        }\r\n        this.setState({confirmBack: false});\r\n    }\r\n\r\n    openFormatsPanel = () => {\r\n        this.setState({isFormatsOpen:!this.state.isFormatsOpen});\r\n    };\r\n\r\n    formatChange(index) {\r\n        let format = this.props.app.formats[index];\r\n        let currentImage = this.props.app.currentImage;\r\n        let images = this.props.app.images; //[this.props.app.currentImage];\r\n        images[currentImage].format = format;\r\n        images[currentImage].editorState.initedMask = false;\r\n        images[currentImage].editorState.initedImagePosition = false;\r\n\r\n        this.props.appSetState({images: images}, ()=>{\r\n            this.props.appImageInitMask(currentImage, true, ()=>{\r\n                this.props.alignInit(currentImage, ()=>{this.countSumm()});\r\n            });\r\n        });\r\n\r\n        // appSetState\r\n        this.setState({isFormatsOpen:false});\r\n    }\r\n\r\n    repeatColors =() => {\r\n        let colors = this.getColorsToRepeat();\r\n        if(colors)\r\n            this.props.appImageChanged( this.props.app.currentImage, colors );\r\n    };\r\n\r\n    getColorsToRepeat = () => {\r\n        if(this.props.app.currentImage===null || this.props.app.currentImage===0) return false;\r\n        let editorState = this.props.app.images[this.props.app.currentImage-1].editorState;\r\n        let current =  this.props.app.images[this.props.app.currentImage].editorState;\r\n        let hasChange = false;\r\n        if(editorState.brightness!==current.brightness) hasChange = true;\r\n        if(editorState.contrast!==current.contrast) hasChange = true;\r\n        if(editorState.saturate!==current.saturate) hasChange = true;\r\n        if(editorState.colorR!==current.colorR) hasChange = true;\r\n        if(editorState.colorG!==current.colorG) hasChange = true;\r\n        if(editorState.colorB!==current.colorB) hasChange = true;\r\n\r\n        if(!hasChange) return false;\r\n        return {\r\n            brightness: editorState.brightness,\r\n            contrast: editorState.contrast,\r\n            saturate: editorState.saturate,\r\n            colorR: editorState.colorR,\r\n            colorG: editorState.colorG,\r\n            colorB: editorState.colorB,\r\n        }\r\n    };\r\n\r\n    render() {\r\n\r\n        let format = this.props.app.images[this.props.app.currentImage] ? this.props.app.images[this.props.app.currentImage].format : {};\r\n\r\n        let formatsList = this.state.isFormatsOpen ? (\r\n            <ClickAwayListener onClickAway={()=>{this.openFormatsPanel()}}>\r\n                <Paper className=\"app-main-change-formats scrollbar position-absolute\">\r\n                    <table className=\"table-formats\">\r\n                        {this.props.app.formats.map( (format, index)=>format.enabled ?\r\n                            <tbody key={index} onClick={()=>this.formatChange(index)}>\r\n                            <tr>\r\n                                <th scope=\"row\">{format.name}</th>\r\n                                <th scope=\"row\">{format.height}\"x {format.width}\"</th>\r\n                                <th scope=\"row\">{Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}</th>\r\n                                <th scope=\"row\">{t(format.surface)}</th>\r\n                                <th scope=\"row\">{tools.Round(format.cost)}</th>\r\n                            </tr>\r\n                            </tbody>\r\n\r\n                            : '' )}\r\n                    </table>\r\n                </Paper>\r\n            </ClickAwayListener>\r\n        ) : null;\r\n\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\r\n                <div style={{display:'none', visibility:'hidden'}}>\r\n                    <canvas ref={(node)=>{this.processCanvasNode=node}} />\r\n                </div>\r\n                <div className=\"app-main h-75\">\r\n                    <div className=\"app-main-selectors w-100 h-100\">\r\n\r\n                        <div className=\"app-main-editor-wrapper h-100 p-2 d-inline-block\">\r\n                            <div className=\" h-100 position-relative\">\r\n                                {this.props.app.currentImage!==null && (\r\n                                    <ImageEditor\r\n                                        changeCountImage={this.changeCountImage.bind(this)}\r\n                                        processCanvas={this.processCanvasNode}\r\n                                        onMessage={this.props.onMessage}\r\n                                        {...this.props}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"app-main-rightwidget h-100 p-2 d-inline-block\">\r\n                            <Paper className=\"h-100 p-2 app-bg-e position-relative\">\r\n                                <div className=\"_fabwrapper\">\r\n                                    <button className={\"btn btn-big btn-primary\"}\r\n                                            onClick={() => this.props.onClickNextBtn()}\r\n                                            disabled={false}\r\n                                            title={t('Next')}\r\n                                            type=\"button\" >\r\n                                        <Icon>arrow_forward</Icon> {t('Next')}\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"_fabwrapper\">\r\n                                    <button className={\"btn btn-big btn-primary\"}\r\n                                            onClick={this.backPressed.bind(this)}\r\n                                            disabled={false}\r\n                                            title={t('Previous')}\r\n                                            type=\"button\" >\r\n                                        <Icon>arrow_back</Icon> {t('Previous')}\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"_fabwrapper\">\r\n                                    <button className=\"btn btn-light mr-2\"\r\n                                            onClick={this.repeatColors.bind(this)}\r\n                                            disabled={!this.getColorsToRepeat()}\r\n                                            title={t('repeat color settings')}\r\n                                            type=\"button\" >\r\n                                        <Icon>compare</Icon>\r\n                                    </button>\r\n\r\n                                    <button className=\"btn btn-light mr-2\"\r\n                                            onClick={this.clickUndo.bind(this)}\r\n                                            disabled={!this.checkUndo()}\r\n                                            title={t('Undo')}\r\n                                            type=\"button\" >\r\n                                        <Icon>undo</Icon>\r\n                                    </button>\r\n\r\n                                    <button className=\"btn btn-light mr-2\"\r\n                                            onClick={this.clickRedo.bind(this)}\r\n                                            disabled={!this.checkRedo()}\r\n                                            title={t('Redo')}\r\n                                            type=\"button\" >\r\n                                        <Icon>redo</Icon>\r\n                                    </button>\r\n                                </div>\r\n\r\n                                <div className=\"app-main-rightwidget-tablewrp\">\r\n\r\n                                        {formatsList}\r\n\r\n                                    <Fab color=\"primary\" className=\"app-main-change-formats-button position-absolute text-primary bg-light\"\r\n                                         style={{right: '0', bottom: '100%' }}\r\n                                         onClick={()=>{this.openFormatsPanel()}}\r\n                                         aria-label=\"Colors\">\r\n                                        <Icon>menu</Icon>\r\n                                    </Fab>\r\n\r\n                                    <table className=\"table\">\r\n                                        <tbody>\r\n\r\n                                        <tr>\r\n                                            <th scope=\"row\" colSpan={2}>\r\n                                                {t('Format')} {format.name}\r\n                                            </th>\r\n                                        </tr>\r\n                                        <tr>\r\n                                            <th scope=\"row\" colSpan={2}>\r\n                                                {format.height}\"x {format.width}\" {Math.round(format.height*25.4)}x{Math.round(format.width*25.4)}\r\n                                            </th>\r\n                                        </tr>\r\n\r\n                                        <tr>\r\n                                            <th scope=\"row\">{t('Files')}</th>\r\n                                            <th scope=\"row\">{this.props.app.images.length} / {this.state.imagesCount}</th>\r\n                                        </tr>\r\n                                        <tr>\r\n                                            <th scope=\"row\">{t('Cost')}</th>\r\n                                            <th scope=\"row\">{tools.Round(this.state.imagesSum)}</th>\r\n                                        </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n\r\n                                </div>\r\n\r\n                            </Paper>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <Paper className=\"app-bottomframe h-25 p-2 position-relative app-bg-e\">\r\n                    <div className=\"app-bottom-thumblist-button\">\r\n                        <button type=\"button\"\r\n                                className={\"btn btn-primary\"}\r\n                                disabled={this.props.app.currentImage===0}\r\n                                onClick={()=>{this.changeCurrentImage(-1)}}>\r\n                            <Icon>navigate_before</Icon>\r\n                        </button>\r\n                    </div>\r\n                    <div className=\"scrollbar _horizontal h-100 w-100\">\r\n\r\n                        <div id='listImages' className=\"app-bottom-thumblist h-100 p-2\">\r\n                            {this.props.app.images.map( (image, index)=>\r\n                                <ImageThumb\r\n                                    key={index}\r\n                                    image={image}\r\n                                    itemIndex={index}\r\n                                    selected={this.props.app.currentImage===index}\r\n                                    onSelect={()=>this.selectImage(index)}\r\n                                    scrollIntoView={this.scrollIntoViewIfNeed}\r\n                                    {...this.props}\r\n                                />\r\n                            )}\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <div className=\"app-bottom-thumblist-button\">\r\n                        <button type=\"button\"\r\n                                className={\"btn btn-primary\"}\r\n                                disabled={this.props.app.currentImage===this.props.app.images.length-1}\r\n                                onClick={()=>{this.changeCurrentImage(1)}}>\r\n                            <Icon>navigate_next</Icon>\r\n                        </button>\r\n                    </div>\r\n                </Paper>\r\n\r\n                <Dialog\r\n                    open={this.state.confirmBack}\r\n                    onClose={()=>this.backConfirmed(false)}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                    aria-describedby=\"alert-dialog-description\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">{t(\"Warning\")}</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText id=\"alert-dialog-description\">\r\n                            {t('Current state of editor images will be lost.')} {t('Are you sure?')}\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <button onClick={()=>this.backConfirmed(true)} className={\"btn btn-big btn-light\"} autoFocus>\r\n                            {t('OK')}\r\n                        </button>\r\n                        <button onClick={()=>this.backConfirmed(false)} className={\"btn btn-big btn-primary\"}>\r\n                            {t('Cancel')}\r\n                        </button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport axios from \"axios\";\r\n\r\nimport './index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {makeGetUri} from \"../../tools\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport t from \"../i18n\";\r\n\r\n\r\nexport default class PageSetupFormats extends React.Component {\r\n\r\n    state = {\r\n        editedFormats: null,\r\n    };\r\n\r\n    componentDidMount() {\r\n        let formats = this.props.app.formats.slice();\r\n        for(let i=0; i<formats.len; i++) {\r\n            formats[i].cost = tools.Round(formats[i].cost)\r\n        }\r\n        this.setState( {editedFormats: formats} );\r\n\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n    }\r\n\r\n    formatNew = ()=>{\r\n        let formats = this.state.editedFormats.slice();\r\n        if(formats.length>0) {\r\n            formats.push( Object.assign({}, formats[formats.length-1]) );\r\n        } else {\r\n            formats.push( {} );\r\n        }\r\n        const last = formats.length-1;\r\n        formats[last].name = 'new format';\r\n        formats[last].enabled = false;\r\n\r\n        this.setState({editedFormats: formats});\r\n\r\n    };\r\n\r\n    formatRemove = (index) => {\r\n        let formats = this.state.editedFormats;\r\n        formats.splice(index,1);\r\n        this.setState({editedFormats: formats});\r\n\r\n    };\r\n    formatChange = (index, id, ev) => {\r\n        let formats = this.state.editedFormats;\r\n        let changed = true;\r\n        switch (id) {\r\n            case 'enabled':\r\n            case 'portrait':\r\n                formats[index][id] = !formats[index][id];\r\n                break;\r\n\r\n            case 'name':\r\n            case 'height':\r\n            case 'width':\r\n            case 'surface':\r\n                formats[index][id] = ev.target.value;\r\n                break;\r\n\r\n            case 'dpi':\r\n                formats[index][id] = tools.Round(ev.target.value,0);\r\n                break;\r\n\r\n            case 'cost':\r\n                const x = ev.target.value.replace(/,/g,'.');\r\n                formats[index][id] = x;\r\n                break;\r\n\r\n            default:\r\n                changed = false;\r\n\r\n        }\r\n        if(changed)\r\n            this.setState({editedFormats: formats});\r\n    };\r\n\r\n    formatSave() {\r\n        let formats = this.state.editedFormats.slice();\r\n        console.log(formats);\r\n        for(let i=0; i<formats.length; i++) {\r\n            // console.log(i, formats[i]);\r\n\r\n            formats[i].dpi = Math.max(150, Math.min(tools.Round(formats[i].dpi,0), 1500));\r\n            formats[i].cost = tools.Round(formats[i].cost,2);\r\n        }\r\n        let uri = makeGetUri();\r\n        const params = new URLSearchParams();\r\n        params.append('q', 'setupFormatSave');\r\n        params.append('formats', JSON.stringify(formats));\r\n        params.append('p', this.props.app.isSetupPassword);\r\n        axios.post(uri, params ).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.props.appSetState({formats: formats}, ()=>{\r\n                        this.props.onMessage( t('successful saved') );\r\n                    });\r\n\r\n                } else {\r\n                    this.props.onMessage('error :'+res.data.error);\r\n                }\r\n            } else {\r\n                console.log('axios.post status ', res.status);\r\n            }\r\n        });\r\n    }\r\n\r\n    formatMove(index,shift) {\r\n        let newIndex = index+shift;\r\n\r\n        console.log(newIndex);\r\n        if(newIndex<0 || newIndex>this.state.editedFormats.length-1 ) {\r\n            return false;\r\n        }\r\n        let formats = this.state.editedFormats.slice();\r\n        let tmp = formats[index];\r\n        formats[index] = formats[newIndex];\r\n        formats[newIndex] = tmp;\r\n        this.setState({editedFormats: formats});\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        let formats = (this.state.editedFormats ? this.state.editedFormats : []);\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\r\n                <div className=\"app-setup  h-100\">\r\n\r\n\r\n\r\n                    <div className=\"app-setup-main h-100\">\r\n                        <Paper className=\"app-setup-formats scrollbar p-2 h-100\">\r\n                            <div className=\"app-setup-formats-header\">\r\n                                <div className=\"_wrp _wrp_enabled\"><small>On</small></div>\r\n                                <div className=\"_wrp _wrp_name\"><small>{t('Name')}</small></div>\r\n                                <div className=\"_wrp _wrp_dpi\"><small>DPI</small></div>\r\n                                <div className=\"_wrp _wrp_height\"><small>{t('Height')}</small></div>\r\n                                <div className=\"_wrp _wrp_width\"><small>{t('Width')}</small></div>\r\n                                <div className=\"_wrp _wrp_surface\"><small>{t('Surface')}</small></div>\r\n                                <div className=\"_wrp _wrp_cost\"><small>{t('Cost')}</small></div>\r\n                                <div className=\"_wrp _wrp_portrait\"><small>{t('Portrait')}</small></div>\r\n                                <div className=\"_wrp _wrp_movecontrol\"> </div>\r\n                            </div>\r\n\r\n                            {formats.map((format, index)=>\r\n                                <div key={index} className={\"app-setup-format-item\"+(format.enabled ? '' : ' _disabled' )}>\r\n                                    <div className=\"_wrp _wrp_enabled\">\r\n                                        <Switch\r\n                                            checked={format.enabled}\r\n                                            onChange={(ev) => this.formatChange(index,'enabled', ev)}\r\n                                            value={'enabled'}\r\n                                            color=\"primary\"\r\n                                        />\r\n\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_name\">\r\n                                        <input type=\"text\" value={format.name} onChange={(ev) => this.formatChange(index,'name', ev)}/>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_dpi\">\r\n                                        <input type=\"text\" value={format.dpi} onChange={(ev) => this.formatChange(index,'dpi', ev)}/>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_height\">\r\n                                        <select value={format.height} data-hint={format.height} onChange={(ev) => this.formatChange(index,'height', ev)}>\r\n                                            {[2.5, 3.5, 4, 4.5, 5, 6, 8, 10, 11, 12].map((h, i)=>\r\n                                                <option key={i} value={h}>{h}\" ({Math.round(h*25.4)})</option>\r\n                                            )}\r\n                                        </select>\r\n\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_width\">\r\n                                        <select value={format.width} onChange={(ev) => this.formatChange(index,'width', ev)}>\r\n                                            {[3.5, 5, 6, 7, 8, 10, 12, 14, 15, 16, 17, 18].map((h, i)=>\r\n                                                <option key={i} value={h}>{h}\" ({Math.round(h*25.4)})</option>\r\n                                            )}\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_surface\">\r\n                                        <select value={format.surface} onChange={(ev) => this.formatChange(index,'surface', ev)}>\r\n                                            {['glance', 'matte'].map((h, i)=>\r\n                                                <option key={i} value={h}>{t(h)}</option>\r\n                                            )}\r\n                                        </select>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_cost\">\r\n                                        <input type=\"text\" value={format.cost} onChange={(ev) => this.formatChange(index,'cost', ev)}/>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_portrait\">\r\n                                        <Switch\r\n                                            checked={format.portrait}\r\n                                            onChange={(ev) => this.formatChange(index,'portrait', ev)}\r\n                                            value={'portrait'}\r\n                                            color=\"primary\"\r\n                                        />\r\n                                    </div>\r\n\r\n                                    {format.enabled && (\r\n                                        <div className=\"_wrp _wrp_movecontrol\">\r\n                                            <div>\r\n                                                <Icon className=\"text-primary\"\r\n                                                      onClick={()=>{this.formatMove(index,-1)}}\r\n                                                >arrow_upward</Icon>\r\n                                            </div>\r\n                                            <div>\r\n                                                <Icon className=\"text-primary\"\r\n                                                      onClick={()=>{this.formatMove(index,1)}}\r\n                                                >arrow_downward</Icon>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                    {!format.enabled && (\r\n                                        <div className=\"_wrp _wrp_movecontrol\">\r\n                                            <Fab className={\"app-setup-format-item-remove\"}\r\n                                                 onClick={() => this.formatRemove(index)}\r\n                                                 color=\"secondary\" aria-label=\"Remove\"\r\n                                                 size=\"small\">\r\n                                                <Icon>delete</Icon>\r\n                                            </Fab>\r\n                                        </div>\r\n\r\n                                    )}\r\n\r\n\r\n\r\n\r\n                                    <hr/>\r\n                                </div>\r\n                            )\r\n                            }\r\n                            <div className=\"app-setup-format-new\">\r\n                                <button className={\"btn btn-primary\"}\r\n                                        onClick={this.formatNew}\r\n                                        disabled={false}\r\n                                        title=\"newFormat\"\r\n                                        type=\"button\" >\r\n                                    <Icon>add</Icon>\r\n                                </button>\r\n                                <span className=\"float-right\">\r\n                                    <button className={\"btn btn-success \"}\r\n                                            onClick={this.formatSave.bind(this)}\r\n                                            disabled={false}\r\n                                            title=\"Save\"\r\n                                            type=\"button\" >\r\n                                        <Icon>save</Icon>\r\n                                    </button>\r\n\r\n                                </span>\r\n                            </div>\r\n\r\n                        </Paper>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport axios from \"axios\";\r\nimport * as tools from \"../../tools\";\r\n\r\n\r\nimport './index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\nimport t from \"../i18n\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\n\r\n\r\nexport default class PageSetupArchive extends React.Component {\r\n\r\n    state = {\r\n        arhives: [],\r\n        currentArchive: null,\r\n        isLoading: false,\r\n        archiveFiles: [],\r\n        currentArchiveFile: null,\r\n        isMultipleSelectOrders: false,\r\n        isDeleteConfirmation: 0,\r\n    };\r\n\r\n\r\n    componentDidMount() {\r\n        this.loadList();\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n    }\r\n\r\n    loadList() {\r\n        if(this.state.isLoading) return;\r\n\r\n        let uri = tools.makeGetUri({'q':'loadArchives', 'p': this.props.app.isSetupPassword});\r\n        this.setState({arhives:[], currentArchive:null, archiveFiles:[], isLoading:true});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        let arhives = res.data.data.map((d)=>{return {folder:d, selected:false}});\r\n                        this.setState({arhives: arhives});\r\n                    }\r\n                }\r\n            }\r\n            this.setState({isLoading: false});\r\n        });\r\n\r\n    }\r\n\r\n    tryDeleteArchive() {\r\n        let archCount = 0;\r\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\r\n        if (isMultipleSelectOrders) {\r\n            let as = this.state.arhives.filter((a)=>{return a.selected});\r\n            console.log(as);\r\n            archCount = as.length;\r\n        }\r\n        if(archCount>0)\r\n            this.setState({isDeleteConfirmation: archCount});\r\n    }\r\n    deleteArchive() {\r\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\r\n        if (isMultipleSelectOrders) {\r\n            let len = this.state.arhives.length;\r\n            for( let i=0; i<len; i++) {\r\n                if(this.state.arhives[i].selected)\r\n                    this._remove(this.state.arhives[i].folder);\r\n            }\r\n        }\r\n\r\n        this.setState({isDeleteConfirmation:0, isMultipleSelectOrders:false, currentArchive:null, archiveFiles:[]});\r\n    }\r\n    _remove(folder) {\r\n        let uri = tools.makeGetUri({'q':'removeArchive', folder: folder, 'p': this.props.app.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.loadList();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    toggleMultiple() {\r\n        const isMultipleSelectOrders = !this.state.isMultipleSelectOrders;\r\n        if (!isMultipleSelectOrders) {\r\n            let arhives = this.state.arhives.slice();\r\n            let len = arhives.length;\r\n            for( let i=0; i<len; i++) {\r\n                arhives[i].selected = false;\r\n            }\r\n            this.setState({arhives: arhives, isMultipleSelectOrders: isMultipleSelectOrders});\r\n        } else {\r\n            this.setState({isMultipleSelectOrders: isMultipleSelectOrders});\r\n        }\r\n    }\r\n\r\n    selectArchive(index) {\r\n        if(this.state.isMultipleSelectOrders) {\r\n            let arhives = this.state.arhives.slice();\r\n            arhives[index].selected = !arhives[index].selected;\r\n            this.setState({arhives: arhives, currentArchive: index});\r\n        } else {\r\n            this.setState({currentArchive: index});\r\n        }\r\n        if(index===this.state.currentArchive) return;\r\n\r\n        let uri = tools.makeGetUri({'q':'loadArchive', folder: this.state.arhives[index].folder, 'p': this.props.app.isSetupPassword});\r\n        this.setState({archiveFiles: [], isLoading: true});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        this.setState({archiveFiles: res.data.data});\r\n                    }\r\n                }\r\n            }\r\n            this.setState({isLoading: false, currentArchiveFile: null});\r\n        });\r\n    }\r\n\r\n    selectFile(index) {\r\n        this.setState({currentArchiveFile: index});\r\n    }\r\n\r\n    render() {\r\n        let archiveCount = 0;\r\n        let archiveTotal = 0;\r\n        let len = this.state.archiveFiles.length;\r\n        for(let i=0; i<len; i++) {\r\n            archiveCount += this.state.archiveFiles[i].count;\r\n            archiveTotal += this.state.archiveFiles[i].format.cost * this.state.archiveFiles[i].count;\r\n        }\r\n\r\n        let archiveFile = null;\r\n        if(this.state.currentArchiveFile>=0 && this.state.archiveFiles[this.state.currentArchiveFile]) {\r\n            archiveFile = this.state.archiveFiles[this.state.currentArchiveFile];\r\n            // console.log(archiveFile);\r\n        }\r\n\r\n        const isMultipleSelectOrders = this.state.isMultipleSelectOrders;\r\n        let selectedArchiveCount = 0;\r\n        if (isMultipleSelectOrders) {\r\n            let as = this.state.arhives.filter((a)=>{return a.selected});\r\n            console.log(as);\r\n            selectedArchiveCount = as.length;\r\n        }\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\r\n                <div className=\"app-setup  h-100\">\r\n\r\n\r\n\r\n                    <div className=\"app-setup-main h-100\">\r\n                        <Paper className=\"app-setup-arhives p-2 h-100 w-100 d-flex flex-column\">\r\n                            <div className=\"_listswrp flex-grow-1 h-75\">\r\n                                <div className=\"h-100 d-flex flex-row\">\r\n                                    <div className=\"app-setup-archives-list scrollbar flex-grow-0 border position-relative\">\r\n                                        {(this.state.isLoading) && (\r\n                                            <div className = \"spinner-border text-primary position-absolute\" role = \"status\" >\r\n                                                <span className = \"sr-only\" > Loading...</span>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {this.state.arhives.map((a, i)=>\r\n                                        <div key={i} className={\"_item\"+(i===this.state.currentArchive ? ' bg-primary text-light' : ' bg-light')}\r\n                                             onClick={()=>{this.selectArchive(i)}}\r\n                                        >\r\n\r\n                                            {isMultipleSelectOrders && (\r\n                                                <Icon fontSize={\"inherit\"} className=\"text-success\">{a.selected ? 'check_circle' : 'radio_button_unchecked'}</Icon>\r\n                                            )}\r\n                                            {a.folder}\r\n\r\n                                        </div>\r\n                                        ) }\r\n                                    </div>\r\n                                    <div className=\"app-setup-archive-files scrollbar flex-grow-0 border position-relative\">\r\n                                        {(this.state.isLoading) && (\r\n                                            <div className = \"spinner-border text-primary position-absolute\" role = \"status\" >\r\n                                                <span className = \"sr-only\" > Loading...</span>\r\n                                            </div>\r\n                                        )}\r\n                                        {this.state.archiveFiles.map((f, i)=>\r\n                                            <div key={i} className={\"_item\"+(i===this.state.currentArchiveFile ? ' bg-primary text-light' : ' bg-light')}\r\n                                                 onClick={()=>{this.selectFile(i)}}\r\n                                            >\r\n                                                {f.name}\r\n\r\n                                            </div>\r\n                                        ) }\r\n                                    </div>\r\n                                    <div className=\"app-setup-archive-fileview flex-grow-1 border h-100\">\r\n                                        <div className=\"d-flex flex-column h-100\">\r\n                                            <div className=\"_view-img border bg-light flex-grow-1\"\r\n                                                 style={{backgroundImage: (archiveFile ? \"url('\"+tools.makeGetUri()+archiveFile.file+\"')\" : '')}}\r\n                                            > </div>\r\n                                            <div className=\"_infobottom flex-grow-0\">\r\n                                                <table className=\"table\">\r\n                                                    <thead>\r\n                                                    <tr>\r\n                                                        <th scope=\"col\" colSpan=\"2\">{t('Format')}</th>\r\n                                                        <th scope=\"col\">{t('Amount')}</th>\r\n                                                        <th scope=\"col\">{t('Date')}</th>\r\n                                                        <th scope=\"col\">{t('Prints')}</th>\r\n                                                        <th scope=\"col\">{t('Total')}</th>\r\n                                                    </tr>\r\n                                                    </thead>\r\n                                                    <tbody>\r\n                                                        <tr>\r\n                                                            <td>{archiveFile ? archiveFile.format.name+' '+archiveFile.format.width+'\"x'+archiveFile.format.height+'\"' : ''}</td>\r\n                                                            <td>{archiveFile ? Math.round(archiveFile.format.height*25.4)+'x'+Math.round(archiveFile.format.width*25.4)+' , '+t(archiveFile.format.surface) : '' }</td>\r\n                                                            <td>{archiveFile ? archiveFile.count : ''}</td>\r\n                                                            <td>{archiveFile ? archiveFile.date+' '+archiveFile.time : ''}</td>\r\n                                                            <td>{archiveCount}</td>\r\n                                                            <td>{tools.Round(archiveTotal)}</td>\r\n                                                        </tr>\r\n                                                    </tbody>\r\n                                                </table>\r\n\r\n\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"_btnswrp flex-grow-0\">\r\n                                <div className=\"m-2 d-inline-block\">\r\n                                    <button className={\"btn btn-success btn \"}\r\n                                            onClick={()=>{this.loadList()}}\r\n                                            title=\"sample\"\r\n                                            type=\"button\" >\r\n                                        <Icon>refresh</Icon>\r\n                                    </button>\r\n\r\n                                </div>\r\n                                <div className=\"m-2 d-inline-block\">\r\n                                    <button className={\"btn\"+(isMultipleSelectOrders ? ' btn-outline-success':' btn-outline-secondary')}\r\n                                            onClick={()=>{this.toggleMultiple()}}\r\n                                            title=\"multiple\"\r\n                                            type=\"button\" >\r\n                                        <Icon>filter_none</Icon>\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"m-2 d-inline-block\">\r\n                                    <button className={\"btn btn-success btn \"}\r\n                                            onClick={()=>{this.tryDeleteArchive()}}\r\n                                            disabled={selectedArchiveCount===0}\r\n                                            title=\"Delete\"\r\n                                            type=\"button\" >\r\n                                        <Icon>delete_forever</Icon>\r\n                                    </button>\r\n\r\n                                </div>\r\n\r\n\r\n                            </div>\r\n                        </Paper>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n\r\n\r\n                <Dialog\r\n                    open={this.state.isDeleteConfirmation>0}\r\n                    onClose={()=>this.setState({isDeleteConfirmation:0})}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                    aria-describedby=\"alert-dialog-description\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">{t(\"Warning\")}</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText id=\"alert-dialog-description\">\r\n                            {t('You are selected archives to remove:')} <span className=\"text-center text-dark\" style={{fontSize:'1.4em'}}>{this.state.isDeleteConfirmation>0 ? this.state.isDeleteConfirmation : ''}</span>\r\n                            <br/>\r\n                            {t('Are you sure?')}\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <button onClick={()=>this.deleteArchive()} className={\"btn btn-big btn-light\"}>\r\n                            {t('OK')}\r\n                        </button>\r\n                        <button onClick={()=>this.setState({isDeleteConfirmation:0})} className={\"btn btn-big btn-primary\"} autoFocus>\r\n                            {t('Cancel')}\r\n                        </button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport axios from \"axios\";\r\n\r\nimport './index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {makeGetUri} from \"../../tools\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport t from \"../i18n\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\n\r\n\r\nexport default class PageSetupSources extends React.Component {\r\n\r\n    state = {\r\n        editedSources: this.props.app.sources.slice(),\r\n        listIcons: [],\r\n        listScripts: [],\r\n        scriptTxt: false,\r\n\r\n    };\r\n\r\n    componentDidMount() {\r\n        if(!this.state.editedSources) {\r\n            this.setState({\r\n                editedSources: this.props.app.sources.slice()\r\n            });\r\n        }\r\n\r\n        let uri = tools.makeGetUri({'q':'setupSourcesListIcons', 'p': this.props.app.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        this.setState({listIcons: res.data.data});\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        uri = tools.makeGetUri({'q':'setupSourcesListScripts', 'p': this.props.app.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        this.setState({listScripts: res.data.data});\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    viewScript(name) {\r\n        let scriptTxt = false;\r\n        let len = this.state.listScripts.length;\r\n        for(let i=0; i<len; i++) {\r\n            console.log(this.state.listScripts[i].name, name);\r\n            if(this.state.listScripts[i].name === name) {\r\n                console.log('gotcha');\r\n                scriptTxt = this.state.listScripts[i].script;\r\n                break;\r\n            }\r\n        }\r\n        this.setState({scriptTxt: scriptTxt});\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n    }\r\n\r\n    sourceNew = ()=>{\r\n        let sources = this.state.editedSources.slice();\r\n        sources.push( Object.assign({}, sources[0]) );\r\n        const last = sources.length-1;\r\n        sources[last].name = 'new source';\r\n        sources[last].enabled = false;\r\n\r\n        this.setState({editedSources: sources});\r\n\r\n    };\r\n\r\n    sourceRemove = (index) => {\r\n        let sources = this.state.editedSources;\r\n        sources.splice(index,1);\r\n        this.setState({editedSources: sources});\r\n\r\n    };\r\n    sourceChange = (index, id, ev) => {\r\n        let sources = this.state.editedSources;\r\n        let changed = true;\r\n        switch (id) {\r\n            case 'enabled':\r\n            case 'emptyhide':\r\n            case 'autoclear':\r\n                sources[index][id] = !sources[index][id];\r\n                break;\r\n\r\n            case 'name':\r\n            case 'path':\r\n            case 'icon':\r\n            case 'scripton':\r\n            case 'scriptoff':\r\n                sources[index][id] = ev.target.value;\r\n                break;\r\n\r\n            default:\r\n                changed = false;\r\n\r\n        }\r\n        if(changed)\r\n            this.setState({editedSources: sources});\r\n    };\r\n\r\n    sourcesSave() {\r\n        let sources = this.state.editedSources;\r\n        // for(let i=0; i<sources.length; i++) {\r\n        //     console.log(i, sources[i]);\r\n        // }\r\n        let uri = makeGetUri();\r\n        const params = new URLSearchParams();\r\n        params.append('q', 'setupSourcesSave');\r\n        params.append('sources', JSON.stringify(sources));\r\n        params.append('p', this.props.app.isSetupPassword);\r\n        axios.post(uri, params ).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.props.appSetState({sources: sources}, ()=>{\r\n                        this.props.onMessage( t('successful saved') );\r\n                    });\r\n\r\n                } else {\r\n                    this.props.onMessage('error :'+res.data.error);\r\n                }\r\n            } else {\r\n                console.log('axios.post status ', res.status);\r\n            }\r\n        });\r\n    }\r\n\r\n    sourceMove(index,shift) {\r\n        let newIndex = index+shift;\r\n\r\n        console.log(newIndex);\r\n        if(newIndex<0 || newIndex>this.state.editedSources.length-1 ) {\r\n            return false;\r\n        }\r\n        let sources = this.state.editedSources.slice();\r\n        let tmp = sources[index];\r\n        sources[index] = sources[newIndex];\r\n        sources[newIndex] = tmp;\r\n        this.setState({editedSources: sources});\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        let sources = (this.state.editedSources ? this.state.editedSources : []);\r\n        let listIcons = this.state.listIcons;\r\n        let listScripts = this.state.listScripts;\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\r\n                <div className=\"app-setup  h-100\">\r\n\r\n\r\n\r\n                    <div className=\"app-setup-main h-100\">\r\n                        <Paper className=\"app-setup-sources scrollbar p-2 h-100\">\r\n                            <div className=\"app-setup-sources-header\">\r\n                                <div className=\"_wrp _wrp_enabled\"><small>On</small></div>\r\n                                <div className=\"_wrp _wrp_name\"><small>{t('Name')}</small></div>\r\n                                <div className=\"_wrp _wrp_icondisplay\"> </div>\r\n                                <div className=\"_wrp _wrp_path\"><small>{t('Path')}</small></div>\r\n                                <div className=\"_wrp _wrp_scripton\"><small>{t('Script ON / OFF')}</small></div>\r\n                                <div className=\"_wrp _wrp_emptyhide\"><small>{t('Emptyhide')}</small></div>\r\n                                <div className=\"_wrp _wrp_autoclear\"><small>{t('Autoclear')}</small></div>\r\n                                <div className=\"_wrp _wrp_movecontrol\"> </div>\r\n                            </div>\r\n\r\n                            {sources.map((source, index)=>\r\n                                <div key={index} className={\"app-setup-source-item\"+(source.enabled ? '' : ' _disabled' )}>\r\n                                    <div className=\"_wrp _wrp_enabled\">\r\n                                        <Switch\r\n                                            checked={source.enabled}\r\n                                            onChange={(ev) => this.sourceChange(index,'enabled', ev)}\r\n                                            value={'enabled'}\r\n                                            color=\"primary\"\r\n                                        />\r\n\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_name\">\r\n                                        <div>\r\n                                            <input type=\"text\" value={source.name} onChange={(ev) => this.sourceChange(index,'name', ev)} className=\"w-100\"/>\r\n                                        </div>\r\n                                        <div>\r\n                                            <select value={source.icon} data-value={source.icon} onChange={(ev) => this.sourceChange(index,'icon', ev)}  className=\"w-100\">\r\n                                                {listIcons.map((h, i)=>\r\n                                                    <option key={i} value={h}>{h.replace(/^.*[\\\\\\/]/, '')}</option>\r\n                                                )}\r\n                                            </select>\r\n\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_icondisplay\"\r\n                                         style={{backgroundImage: (source.icon ? 'url('+tools.makeGetUri()+source.icon+')' : '')}}\r\n                                    > </div>\r\n                                    <div className=\"_wrp _wrp_path\">\r\n                                        <input type=\"text\" value={source.path} onChange={(ev) => this.sourceChange(index,'path', ev)} className=\"w-100\"/>\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_scripton\">\r\n                                        <div>\r\n                                            <select value={source.scripton} onChange={(ev) => this.sourceChange(index,'scripton', ev)}>\r\n                                                <option key={'d'} value=''>{t('---')}</option>\r\n                                                {listScripts.map((h, i)=>\r\n                                                    <option key={i} value={h.name}>{h.name}</option>\r\n                                                )}\r\n                                            </select>\r\n                                            <Icon onClick={()=>{this.viewScript(source.scripton)}} className=\"text-success\" >description</Icon>\r\n                                        </div>\r\n                                        <div>\r\n                                            <select value={source.scriptoff} onChange={(ev) => this.sourceChange(index,'scriptoff', ev)}>\r\n                                                <option key={'d'} value=''>{t('---')}</option>\r\n                                                {listScripts.map((h, i)=>\r\n                                                    <option key={i} value={h.name}>{h.name}</option>\r\n                                                )}\r\n                                            </select>\r\n                                            <Icon onClick={()=>{this.viewScript(source.scriptoff)}} className=\"text-warning\" >description</Icon>\r\n\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    <div className=\"_wrp _wrp_emptyhide\">\r\n                                        <Switch\r\n                                            checked={source.emptyhide}\r\n                                            onChange={(ev) => this.sourceChange(index,'emptyhide', ev)}\r\n                                            value={'emptyhide'}\r\n                                            color=\"primary\"\r\n                                        />\r\n                                    </div>\r\n                                    <div className=\"_wrp _wrp_autoclear\">\r\n                                        <Switch\r\n                                            checked={source.autoclear}\r\n                                            onChange={(ev) => this.sourceChange(index,'autoclear', ev)}\r\n                                            value={'autoclear'}\r\n                                            color=\"primary\"\r\n                                        />\r\n                                    </div>\r\n                                    {source.enabled && (\r\n                                        <div className=\"_wrp _wrp_movecontrol\">\r\n                                            <div>\r\n                                                <Icon className=\"text-primary\"\r\n                                                      onClick={()=>{this.sourceMove(index,-1)}}\r\n                                                >arrow_upward</Icon>\r\n                                            </div>\r\n                                            <div>\r\n                                                <Icon className=\"text-primary\"\r\n                                                      onClick={()=>{this.sourceMove(index,1)}}\r\n                                                >arrow_downward</Icon>\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {!source.enabled && (\r\n                                        <div className=\"_wrp _wrp_movecontrol\">\r\n                                            <Fab className={\"app-setup-format-item-remove\"}\r\n                                                 onClick={() => this.sourceRemove(index)}\r\n                                                 color=\"secondary\" aria-label=\"Remove\"\r\n                                                 size=\"small\">\r\n                                                <Icon>delete</Icon>\r\n                                            </Fab>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    <hr/>\r\n                                </div>\r\n                            )\r\n                            }\r\n                            <div className=\"app-setup-format-new\">\r\n                                <button className={\"btn btn-primary\"}\r\n                                        onClick={this.sourceNew}\r\n                                        disabled={false}\r\n                                        title=\"newFormat\"\r\n                                        type=\"button\" >\r\n                                    <Icon>add</Icon>\r\n                                </button>\r\n                                <span className=\"float-right\">\r\n                                    <button className={\"btn btn-success \"}\r\n                                            onClick={this.sourcesSave.bind(this)}\r\n                                            disabled={false}\r\n                                            title=\"Save\"\r\n                                            type=\"button\" >\r\n                                        <Icon>save</Icon>\r\n                                    </button>\r\n\r\n                                </span>\r\n                            </div>\r\n\r\n                        </Paper>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n\r\n                <Dialog\r\n                    open={this.state.scriptTxt}\r\n                    onClose={()=>this.setState({scriptTxt: null})}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                    aria-describedby=\"alert-dialog-description\"\r\n                    maxWidth={false}\r\n                >\r\n                    <DialogContent>\r\n                        <DialogContentText id=\"alert-dialog-description\" className=\"app-setup-view-code-wrapper\">\r\n                        <textarea className=\"app-setup-view-code\" readOnly>\r\n                            {this.state.scriptTxt}\r\n                        </textarea>\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <button onClick={()=>this.setState({scriptTxt: null})} className={\"btn btn-primary\"}>\r\n                            {t('Close')}\r\n                        </button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport axios from \"axios\";\r\n\r\nimport './index.css';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport {makeGetUri} from \"../../tools\";\r\nimport t from \"../i18n\";\r\nimport Switch from \"@material-ui/core/Switch\";\r\n\r\n\r\nexport default class PageSetupParameters extends React.Component {\r\n\r\n    state = {\r\n        inputNP: '',\r\n        inputNP2: '',\r\n        setup: this.props.app.setup,\r\n        removeOlder: !(this.props.app.setup.removeArchiveOlder<14 || this.props.app.setup.removeArchiveOlder>5000),\r\n    };\r\n\r\n    savePass() {\r\n        if(this.state.inputNP!==this.state.inputNP2) {\r\n            this.props.onMessage(t('New password and his confirm does not match'));\r\n            this.setState({inputNP:'', inputNP2:''});\r\n            return;\r\n        }\r\n        let uri = tools.makeGetUri({'q':'setupPasswordSave', 'value': this.state.inputNP, 'p':this.props.app.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.props.onMessage(t('New password saved'));\r\n                    this.setState({inputNP:'', inputNP2:''})\r\n                } else {\r\n                    this.props.onMessage(t('error')+res.data.error);\r\n                    console.log(res.data.error);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    saveParameters() {\r\n        let uri = makeGetUri();\r\n        const params = new URLSearchParams();\r\n        params.append('q', 'setupParametersSave');\r\n        let setup = Object.assign(this.state.setup);\r\n        if(setup.removeArchiveOlder<14 || setup.removeArchiveOlder>5000) {\r\n            setup.removeArchiveOlder = 0;\r\n            this.setState( {setup: setup, removeOlder: false} );\r\n        }\r\n        params.append('setup', JSON.stringify(setup));\r\n        params.append('p', this.props.app.isSetupPassword);\r\n        axios.post(uri, params ).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.props.onMessage(t('Parameters saved'));\r\n                } else {\r\n                    this.props.onMessage(t('error')+res.data.error);\r\n                    console.log(res.data.error);\r\n                }\r\n            } else {\r\n                console.log('axios.post status ', res.status);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    inputTyped = (ev , key) => {\r\n        let state = {};\r\n        state[key] = ev.target.value;\r\n        this.setState(state);\r\n    };\r\n\r\n    removeOlderToggle() {\r\n        this.setState( {removeOlder: !this.state.removeOlder} );\r\n    }\r\n\r\n    setupChange(key, ev) {\r\n        let setup = Object.assign(this.state.setup);\r\n        let changed = true;\r\n        switch (key) {\r\n\r\n            case 'processMode':\r\n            case 'batchSaveMode':\r\n            case 'copiesMode':\r\n            case 'printNaming':\r\n            case 'copiesNaming':\r\n            case 'removeArchiveOlder':\r\n\r\n                setup[key] = ev.target.value;\r\n                break;\r\n\r\n\r\n            default:\r\n                changed = false;\r\n\r\n        }\r\n        if(changed)\r\n            this.setState( {setup: setup} );\r\n\r\n    }\r\n\r\n    render() {\r\n\r\n        let namingOption = [\r\n            '_4x6_102x152_glance',\r\n            '_102x152_glance',\r\n            '_4x6_glance',\r\n            '_102x152',\r\n            '_4x6',\r\n            '_4x6_102x152',\r\n        ];\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-page-setup-formats w-100 h-100\">\r\n                <div className=\"app-setup  h-100\">\r\n\r\n\r\n\r\n                    <div className=\"app-setup-main h-100\">\r\n                        <Paper className=\"app-setup-formats scrollbar p-4 mr-2\">\r\n                            <div className=\"m-2\">\r\n                                <form>\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"np\">{t('New password')}</label>\r\n                                        <input id=\"np\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.state.inputNP} onChange={(e)=>this.inputTyped(e,'inputNP')} autoFocus/>\r\n                                    </div>\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"np2\">{t('Retype password')}</label>\r\n                                        <input id=\"np2\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.state.inputNP2} onChange={(e)=>this.inputTyped(e,'inputNP2')} />\r\n                                    </div>\r\n\r\n                                    <div className=\"p-2 text-right\">\r\n                                        <button className={\"btn btn-primary\"}\r\n                                                onClick={this.savePass.bind(this)}\r\n                                                disabled={false}\r\n                                                title=\"save\"\r\n                                                type=\"button\" >\r\n                                            {t('Save')}\r\n                                        </button>\r\n\r\n                                    </div>\r\n                                </form>\r\n\r\n                            </div>\r\n\r\n                        </Paper>\r\n                        <Paper className=\"app-setup-formats scrollbar p-4 mr-2\">\r\n                            <div className=\"m-2\">\r\n                                <form>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"processmode\">{t('Process mode')}</label>\r\n                                        <select  id=\"processmode\" value={this.state.setup.processMode} onChange={(ev) => this.setupChange('processMode', ev)} className={\"form-control\"}>\r\n                                            <option key={'frontend'} value='frontend'>DOESN'T WORK{t('frontend')}</option>\r\n                                            <option key={'backend'} value='backend'>{t('backend')} ({t('Recomended')})</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"batch\">{t('Print mode')}</label>\r\n                                        <select  id=\"batch\" value={this.state.setup.batchSaveMode} onChange={(ev) => this.setupChange('batchSaveMode', ev)} className={\"form-control\"}>\r\n                                            <option value='0'>DOESN'T WORK {t('Wait for each file')}</option>\r\n                                            <option value='1'>{t('Fast batch on backend')} ({t('Recomended')})</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"copiesMode\">{t('Print copies')}</label>\r\n                                        <select  id=\"copiesMode\" value={this.state.setup.copiesMode} onChange={(ev) => this.setupChange('copiesMode', ev)} className={\"form-control\"}>\r\n                                            <option value='1'>{t('Make copy for each file')}</option>\r\n                                            <option value='0'>{t('Add count to name of file')} ({t('Recomended')})</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"printNaming\">{t('Print naming')}</label>\r\n                                        <select  id=\"printNaming\" value={this.state.setup.printNaming} onChange={(ev) => this.setupChange('printNaming', ev)} className={\"form-control\"}>\r\n                                            {namingOption.map((t,n)=>\r\n                                                <option value={n}>{t}</option>\r\n                                            )}\r\n                                        </select>\r\n                                    </div>\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"copiesNaming\">{t('Copies naming')}</label>\r\n                                        <select  id=\"copiesNaming\" value={this.state.setup.copiesNaming} onChange={(ev) => this.setupChange('copiesNaming', ev)} className={\"form-control\"}>\r\n                                            <option value='0'>999_copy2{namingOption[this.state.setup.printNaming]}</option>\r\n                                            <option value='1'>999{namingOption[this.state.setup.printNaming]}_copy2</option>\r\n                                            <option value='2'>999{namingOption[this.state.setup.printNaming]}_c2</option>\r\n                                            <option value='3'>999_c2{namingOption[this.state.setup.printNaming]}</option>\r\n                                        </select>\r\n                                    </div>\r\n\r\n\r\n                                    <div className=\"form-group\">\r\n                                        <label htmlFor=\"removeArchiveOlder\">{t('Remove archives, older than days')}</label>\r\n                                        <Switch\r\n                                            checked={this.state.removeOlder}\r\n                                            onChange={(ev) => this.removeOlderToggle()}\r\n                                            value={'enabled'}\r\n                                            color=\"primary\"\r\n                                        />\r\n                                        <input type=\"text\" value={this.state.setup.removeArchiveOlder} onChange={(ev) => this.setupChange('removeArchiveOlder', ev)}/>\r\n\r\n                                    </div>\r\n\r\n\r\n                                    <div className=\"p-2 text-right\">\r\n                                        <button className={\"btn btn-primary\"}\r\n                                                onClick={this.saveParameters.bind(this)}\r\n                                                disabled={false}\r\n                                                title=\"save\"\r\n                                                type=\"button\" >\r\n                                            {t('Save')}\r\n                                        </button>\r\n\r\n                                    </div>\r\n                                </form>\r\n\r\n                            </div>\r\n                        </Paper>\r\n                    </div>\r\n\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\n\r\nimport './index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\nimport t from \"../i18n\";\r\nimport PageSetupFormats from './PageSetupFormats'\r\nimport PageSetupArchive from './PageSetupArchive'\r\nimport PageSetupSources from './PageSetupSources'\r\nimport PageSetupParameters from './PageSetupParameters'\r\n\r\nexport default class PageSetup extends React.Component {\r\n\r\n    state = {\r\n        currentTab: 'archive',\r\n    };\r\n\r\n\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n    }\r\n\r\n    openTab = (tab) => {\r\n        if(tab!== this.state.currentTab)\r\n            this.setState({currentTab: tab})\r\n    };\r\n\r\n    render() {\r\n\r\n        let tab = null;\r\n        switch (this.state.currentTab) {\r\n            case 'formats':\r\n                tab = <PageSetupFormats {...this.props}/>;\r\n                break;\r\n\r\n            case 'sources':\r\n                tab = <PageSetupSources {...this.props}/>;\r\n                break;\r\n\r\n            case 'parameters':\r\n                tab = <PageSetupParameters {...this.props}/>;\r\n                break;\r\n\r\n\r\n            default:\r\n                tab = <PageSetupArchive {...this.props}/>;\r\n                break;\r\n        }\r\n\r\n        return (\r\n            <div className=\"app-page app-bg-e0 app-setup w-100 h-100\">\r\n                <div className=\"app-setup-wrapper h-100\">\r\n                    <div className=\"app-setup-main h-85 w-100\">\r\n                        <div className=\"app-setup-main-tabcontrol w-15 h-100 d-inline-block p-2\">\r\n                            <Paper className=\"_tab-control w-100 h-100 p-2\">\r\n                                <div className=\"_menuwrapper\">\r\n                                    <button className={\"btn \"+(this.state.currentTab==='formats' ? 'btn-primary' : 'btn-outline-primary')}\r\n                                            onClick={()=>{this.openTab('formats')}}\r\n                                            type=\"button\" > {t('Formats')}\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"_menuwrapper\">\r\n                                    <button className={\"btn \"+(this.state.currentTab==='sources' ? 'btn-primary' : 'btn-outline-primary')}\r\n                                            onClick={()=>{this.openTab('sources')}}\r\n                                            type=\"button\" > {t('Sources')}\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"_menuwrapper\">\r\n                                    <button className={\"btn \"+(this.state.currentTab==='archive' ? 'btn-primary' : 'btn-outline-primary')}\r\n                                            onClick={()=>{this.openTab('archive')}}\r\n                                            type=\"button\" > {t('Archive')}\r\n                                    </button>\r\n                                </div>\r\n                                <div className=\"_menuwrapper\">\r\n                                    <button className={\"btn \"+(this.state.currentTab==='parameters' ? 'btn-primary' : 'btn-outline-primary')}\r\n                                            onClick={()=>{this.openTab('parameters')}}\r\n                                            type=\"button\" > {t('Parameters')}\r\n                                    </button>\r\n                                </div>\r\n\r\n                            </Paper>\r\n                        </div>\r\n                        <div className=\"app-setup-main-tab w-85 h-100 d-inline-block p-2\">\r\n                            {tab}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"app-setup-bottom h-15 p-2\">\r\n                            <Paper className=\"app-setup-bottom-buttons text-center h-100 p-2\">\r\n                                <Paper className=\"float-left h-100 p-2\">\r\n                                    {this.props.app.appWidth}x{this.props.app.appHeight}\r\n                                    <div>\r\n                                        <button className={\"btn btn-light\"}\r\n                                                onClick={()=>{if(window.confirm(t('Refresh application')+'?')) document.location.reload();}}\r\n                                                disabled={false}\r\n                                                title=\"Refresh\"\r\n                                                type=\"button\" >\r\n                                            <Icon>update</Icon> {this.props.app.version}\r\n                                        </button>\r\n\r\n                                    </div>\r\n                                </Paper>\r\n                                <div className=\"m-2 d-inline-block\">\r\n                                    <button className={\"btn btn-primary btn-big\"}\r\n                                            onClick={()=>{this.props.Logout()}}\r\n                                            disabled={false}\r\n                                            title=\"Logout\"\r\n                                            type=\"button\" >\r\n                                        <Icon>close</Icon>\r\n                                    </button>\r\n                                </div>\r\n\r\n                            </Paper>\r\n\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport * as tools from \"../../tools\";\r\nimport axios from \"axios\";\r\nimport t from \"../i18n\";\r\n\r\nimport './index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport {makeGetUri} from \"../../tools\";\r\nimport {calculateImageDimensions} from \"../../tools\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\n\r\nexport default class PagePrint extends React.Component {\r\n    state = {\r\n        orderFolder: null,\r\n        orderNum: null,\r\n        savingImages: false,\r\n        orderPrinted: false,\r\n    };\r\n\r\n    savePartialProgress(start, processed, party, imageslen) {\r\n        processed /= 2; // increment twice (init + process)\r\n        let progress = Math.ceil((start+processed)/imageslen*100);\r\n        let job_done = start+processed >= imageslen;\r\n        if(job_done) {\r\n            progress = -1;\r\n            if(this.props.app.setup.batchSaveMode==='1') {\r\n                let uri = makeGetUri({'q':'orderFilesProcessBatch', 'folder': this.state.orderFolder});\r\n                axios.get(uri).then(res => {\r\n                    if(res.status===200) {\r\n                        if(res.data.error!=='') {\r\n                            this.props.onMessage(t('orderFilesProcessBatch error:')+res.data.error);\r\n                        }\r\n                    } else {\r\n                        this.props.onMessage(t('orderFilesProcessBatch error status, let see log'));\r\n                        console.log(t('orderFilesProcessBatch error status'), res.status);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // job done\r\n        } else {\r\n            if(processed >= party) {\r\n                // partial end\r\n                setTimeout(()=>{ this.saveImage(start+processed); },500);\r\n                // console.log('partial end', start, processed); job_done = true;\r\n            }\r\n        }\r\n        if(this.props.app.progressBarValue !== progress) {\r\n            let isPleaseWait = (progress>-1 && progress<99);\r\n            this.props.appSetState({progressBarValue:progress, isPleaseWait:isPleaseWait, savingImages:!job_done });\r\n        }\r\n        if(job_done)\r\n            this.setState({orderPrinted: true} );\r\n    }\r\n\r\n    checkBeforeSaveImage() {\r\n        let total = 0;\r\n        for(let i=0; i<this.props.app.images.length; i++) {\r\n            total += this.props.app.images[i].count;\r\n        }\r\n        if(total) {\r\n            this.saveImage(0);\r\n        } else {\r\n            this.props.onClickNextBtn();\r\n        }\r\n    }\r\n    saveImage = (first) => {\r\n        let party = 10;\r\n        let imageslen = this.props.app.images.length;\r\n        if(first+party>imageslen) {\r\n            party = imageslen - first;\r\n        }\r\n\r\n        let processed = 0;\r\n        let orderFolder = '';// '../';\r\n        if(this.state.orderFolder) {\r\n            orderFolder = this.state.orderFolder;\r\n        }\r\n        this.savePartialProgress(first, processed, party, imageslen);\r\n        let uri = makeGetUri({'q':'orderGetFolder', 'folder': orderFolder});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        orderFolder = res.data.data;\r\n                        this.setState({orderFolder: orderFolder, orderNum: res.data.orderNum});\r\n\r\n                        let partImages = this.props.app.images.slice(first, first+party);\r\n                        partImages.forEach( (image, index)=>{\r\n                            let i = first+index;\r\n                            processed++; // count init\r\n                            this.savePartialProgress(first, processed, party, imageslen);\r\n\r\n                            // console.log('Process image from:', first, 'index:', index, 'key', i );\r\n\r\n                            this.autoInitImage(i, ()=>{\r\n\r\n                                let image = this.props.app.images[i];\r\n                                if(image.count) {\r\n                                    if(this.props.app.setup.processMode === 'frontend') {\r\n                                        tools.processImage(this.processCanvasNode, this.props.app, i, (DataURL)=>{\r\n\r\n                                            let uri = tools.makeGetUri();\r\n                                            const params = new URLSearchParams();\r\n                                            params.append('q', 'orderFileWrite');\r\n                                            params.append('folder', orderFolder);\r\n                                            params.append('image', JSON.stringify(image));\r\n                                            params.append('name', (i+1)+'.'+image.extension);\r\n                                            params.append('count', image.count);\r\n                                            params.append('copy', this.props.app.setup.copiesMode ? this.props.app.setup.copiesMode : 1);\r\n                                            params.append('data', DataURL);\r\n\r\n                                            axios.post(uri, params ).then(res => {\r\n                                                if(res.status===200) {\r\n                                                    if(res.data.error!=='') {\r\n                                                        this.props.onMessage('error '+res.data.error);\r\n                                                    }\r\n                                                    processed++;\r\n                                                    // console.log('processed', processed);\r\n                                                    this.savePartialProgress(first, processed, party, imageslen);\r\n                                                }\r\n                                            });\r\n                                        });\r\n\r\n                                    } else { // this.props.app.setup.processMode === backend\r\n                                        const p = calculateImageDimensions(this.props.app, i);\r\n\r\n                                        let uri = tools.makeGetUri();\r\n                                        const params = new URLSearchParams();\r\n                                        params.append('q', 'orderFileToProcess');\r\n                                        if(this.props.app.setup.batchSaveMode==='1') params.append('batch', '1');\r\n                                        params.append('folder', orderFolder);\r\n                                        params.append('name', (i+1)+'.'+image.extension);\r\n                                        params.append('image', JSON.stringify(image));\r\n                                        params.append('dimensions', JSON.stringify(p));\r\n                                        params.append('count', image.count);\r\n                                        params.append('copy', this.props.app.setup.copiesMode ? this.props.app.setup.copiesMode : 1);\r\n\r\n                                        axios.post(uri, params ).then(res => {\r\n                                            if(res.status===200) {\r\n                                                if(res.data.error!=='') {\r\n                                                    this.props.onMessage(t('error')+':'+res.data.error);\r\n                                                }\r\n                                                processed++;\r\n                                                // console.log('processed', processed);\r\n                                                this.savePartialProgress(first, processed, party, imageslen);\r\n                                            }\r\n                                        });\r\n                                    }\r\n\r\n                                } else {\r\n                                    processed++;\r\n                                    this.savePartialProgress(first, processed, party, imageslen);\r\n                                }\r\n                            });\r\n                        }, this );\r\n\r\n                        // for(let i=first; i<first+party; i++) {\r\n                        //\r\n                        //     // console.log('image init ', first+i);\r\n                        //     processed++; // count init\r\n                        //     this.savePartialProgress(first, processed, party, imageslen);\r\n                        //\r\n                        // }//for\r\n\r\n                    }\r\n                } else {\r\n                    this.props.onMessage(t('error')+':'+res.data.error);\r\n                }\r\n            } else {\r\n                this.props.onMessage(t('error status, let see log'));\r\n                console.log('error status', res.status);\r\n            }\r\n        });\r\n    };\r\n\r\n    autoInitImage = (i, fn_callback) => {\r\n        let image = this.props.app.images[i];\r\n\r\n        this.props.appImageInitMask(i, false, ()=>{\r\n\r\n            // console.log(' autoInitImage appImageInitMask', i );\r\n\r\n            if(!image.editorState.initedImagePosition) {\r\n                // console.log('init image '+i);\r\n                this.props.alignInit(i, fn_callback);\r\n            } else {\r\n                if( typeof(fn_callback) === 'function') { fn_callback(); }\r\n            }\r\n\r\n        });\r\n\r\n    };\r\n\r\n\r\n\r\n    render() {\r\n\r\n        const formats = this.props.app.formats;\r\n        const images = this.props.app.images;\r\n        let temporary = [];\r\n        let _flen = formats.length;\r\n        for(let i=0; i<_flen; i++) {\r\n            const ims = images.filter((image)=>{\r\n                for (let key in image.format) {\r\n                    if (formats[i][key] === undefined || formats[i][key] !== image.format[key])\r\n                        return false;\r\n                }\r\n                return true;\r\n            });\r\n            temporary.push(ims);\r\n        }\r\n        // console.log(temporary);\r\n\r\n        let summary = []; //temporary.filter((t,i)=>t.length>0);\r\n        _flen = temporary.length;\r\n        let totalSum = 0;\r\n        for(let i=0; i<_flen; i++) {\r\n            const tmp = temporary[i];\r\n            if(tmp.length>0) {\r\n                let cnt = 0;\r\n                for(let j=0; j<tmp.length; j++) {\r\n                    cnt += tmp[j].count;\r\n                }\r\n                if(cnt>0) {\r\n                    summary.push({ format: formats[i], count: cnt, });\r\n                    totalSum += formats[i].cost * cnt;\r\n                }\r\n            }\r\n        }\r\n        // console.log(summary);\r\n\r\n        return (\r\n\r\n            <div className=\"app-page app-bg-e0 app-page-start w-100 h-100\">\r\n                <div className=\"app-print h-90 p-2\">\r\n                    <Paper className=\"h-100 w-100 p-2 app-bg-e text-center\">\r\n                        <Paper className=\"app-print-costs-paper scrollbar p-2 m-2\">\r\n                            <table className=\"table\">\r\n                                <thead>\r\n                                <tr>\r\n                                    <th scope=\"col\" colSpan=\"2\">{t('Format')}</th>\r\n                                    <th scope=\"col\">{t('Amount')}</th>\r\n                                    <th scope=\"col\">{t('Total')}: {totalSum}</th>\r\n                                </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                {summary.map((sum, i)=>\r\n                                    <tr key={i}>\r\n                                        <td>{sum.format.name} {sum.format.width}\" x{sum.format.height}\"</td>\r\n                                        <td>{Math.round(sum.format.height*25.4)}x{Math.round(sum.format.width*25.4)} , {t(sum.format.surface)}</td>\r\n                                        <td>{sum.count}</td>\r\n                                        <td>{tools.Round(sum.format.cost * sum.count)}</td>\r\n                                    </tr>\r\n                                ) }\r\n                                </tbody>\r\n                            </table>\r\n\r\n                        </Paper>\r\n                        <div className=\"app-print-costs-buttons text-center\">\r\n                            <button className={\"btn btn-big btn-primary m-2\"}\r\n                                    onClick={() => {this.props.onClickPrevBtn()}}\r\n                                    disabled={false}\r\n                                    title={t('Previous')}\r\n                                    type=\"button\" >\r\n                                <Icon>arrow_back</Icon> {t('Previous')}\r\n                            </button>\r\n\r\n                            <button type=\"button\"\r\n                                    className={\"btn btn-big btn-success m-2\"}\r\n                                    disabled={this.state.savingImages}\r\n                                    onClick={()=>{this.checkBeforeSaveImage()}}>\r\n                                <Icon>print</Icon> {t('Print')}\r\n                            </button>\r\n\r\n                        </div>\r\n                    </Paper>\r\n\r\n\r\n                </div>\r\n\r\n                <div className=\"app-bottomframe w-100 h-10 p-2 position-relative\">\r\n                    <Paper className=\"h-100 w-100 p-2 app-bg-e\">\r\n                        {(this.props.app.progressBarValue>=0 && (\r\n                            <div className=\"app-bottom-progress h-100 p-2 w-100\">\r\n                                <LinearProgress variant=\"determinate\" value={this.props.app.progressBarValue} />\r\n                            </div>\r\n                        ))}\r\n                    </Paper>\r\n                </div>\r\n\r\n                <Dialog\r\n                    open={this.state.orderPrinted}\r\n                    onClose={this.props.onClickNextBtn}\r\n                    aria-labelledby=\"alert-dialog-title\"\r\n                    aria-describedby=\"alert-dialog-description\"\r\n                >\r\n                    <DialogTitle id=\"alert-dialog-title\">{t('Successful printed')}</DialogTitle>\r\n                    <DialogContent>\r\n                        <DialogContentText id=\"alert-dialog-description\">\r\n                            {t(\"The number of your order is\")}\r\n                            <span className=\"text-center text-dark\" style={{fontSize:'1.4em', display:'block'}}>{this.state.orderNum}</span>\r\n                            {t('Dont forget to remove your source.')}\r\n                            <br/><br/>\r\n                            {t('Thank you!')}\r\n                        </DialogContentText>\r\n                    </DialogContent>\r\n                    <DialogActions>\r\n                        <button onClick={this.props.onClickNextBtn} className={\"btn btn-big  btn-primary\"} autoFocus>\r\n                            OK\r\n                        </button>\r\n                    </DialogActions>\r\n                </Dialog>\r\n\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport '../index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\n\r\nexport default class SetupPin extends React.Component {\r\n\r\n    passTyped = (ev) => {\r\n        this.props.appSetState({isSetupPassword: ev.target.value});\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.app.isSetup || this.props.app.isSetupLogged) return null;\r\n\r\n        return (\r\n            <div className=\"app-page-login p-2 w-100 h-100\">\r\n                <div className=\"app-login-wrapper-bkg app-bg-e0 app-page-start p-2 w-100 h-100\"> </div>\r\n\r\n                <div className=\"app-main app-login-wrapper w-100\">\r\n                    <Paper className=\"app-login p-2\">\r\n                        <form onSubmit={(ev)=>this.props.Login(ev)}>\r\n                            <div className=\"form-group\">\r\n                                <label htmlFor=\"p\">Pin</label>\r\n                                <input id=\"p\" type=\"text\" autoComplete={'off'} className={\"app-login-pass form-control text-center\"} value={this.props.isSetupPassword} onChange={this.passTyped} autoFocus/>\r\n                            </div>\r\n                            <div className=\"m-2 d-inline-block\">\r\n                                <button className={\"btn btn-big btn-success\"}\r\n                                        disabled={false}\r\n                                        title=\"Login\"\r\n                                        type=\"submit\" >\r\n                                    <Icon>vpn_key</Icon>\r\n                                </button>\r\n                            </div>\r\n\r\n                            <div className=\"m-2 d-inline-block\">\r\n                                <button className={\"btn btn-big btn-primary\"}\r\n                                        onClick={this.props.Logout}\r\n                                        disabled={false}\r\n                                        title=\"Logout\"\r\n                                        type=\"button\" >\r\n                                    <Icon>close</Icon>\r\n                                </button>\r\n                            </div>\r\n                        </form>\r\n                    </Paper>\r\n\r\n                </div>\r\n\r\n            </div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport './splash-screen.css';\r\nimport t from \"./i18n\";\r\nimport {getLangs} from \"./i18n\";\r\nimport {setLang} from \"./i18n\";\r\nimport '../index.css';\r\nimport Icon from \"@material-ui/core/Icon\";\r\n\r\n\r\nexport default class LoaderSplashScreen extends React.Component {\r\n    state = {\r\n        caseInfinityLoop: false,\r\n    };\r\n\r\n    componentDidMount() {\r\n        this.tm = setTimeout( ()=>{ this.setState({caseInfinityLoop:true}) }, 179000);\r\n    }\r\n    componentWillUnmount() {\r\n        if(this.tm) clearTimeout(this.tm);\r\n    }\r\n\r\n    langOnLoad(key) {\r\n        setLang(key);\r\n        this.setState({caseInfinityLoop:false});\r\n    }\r\n\r\n    render() {\r\n\r\n        let langs = getLangs();\r\n\r\n        return (\r\n            <div className=\"splash-screen app-bg-e\">\r\n                {this.props.serverError || this.state.caseInfinityLoop ?\r\n                    <div className='text-center'>\r\n                        <div className=\"splash-screen-text-wrapper error bg-danger text-light pr-5 pl-5\">\r\n                            {t('Server error:')}\r\n                            <br/><br/>\r\n                            {this.props.serverError}\r\n                        </div>\r\n                        <div className=\"p-4\">\r\n                            <button className={\"btn btn-primary btn-big btn-3d\"}\r\n                                    onClick={()=>{ document.location.reload();}}\r\n                                    disabled={false}\r\n                                    title=\"Refresh\"\r\n                                    type=\"button\" >\r\n                                <Icon>update</Icon> {t('Restart')}\r\n                            </button>\r\n                        </div>\r\n\r\n                    </div>\r\n                    :\r\n                    <div className=\"splash-screen-text-wrapper\">\r\n                        {t('Wait a moment while app loading')}\r\n                        <div className=\"loading-dot\">.</div>\r\n                    </div>\r\n                }\r\n\r\n                <div className=\"splash-screen-lang-buttons\">\r\n                    {langs.map( (lang, index)=>\r\n                        <div key={index} className=\"m-3 d-inline-block\">\r\n                            <button className=\"btn btn-success btn-3d p-3\"\r\n                                    onClick={()=>this.langOnLoad(lang.key)}\r\n                                    disabled={false}\r\n                                    title=\"Language\"\r\n                                    type=\"button\" >\r\n                                <Icon>language</Icon>{lang.caption}\r\n                            </button>\r\n\r\n                        </div>\r\n                    )}\r\n\r\n                </div>\r\n\r\n\r\n            </div>\r\n        )\r\n\r\n    }\r\n}\r\n\r\n","import React from 'react';\r\nimport './App.css';\r\nimport {version} from './version.json';\r\n\r\nimport {makeGetUri, THEME} from './tools.js';\r\nimport axios from \"axios\";\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport PageStart from './Components/PageStart';\r\nimport PageLoadImages from './Components/PageLoadImages';\r\nimport PageEditor from './Components/PageEditor';\r\nimport PageSetup from './Components/PageSetup';\r\nimport PagePrint from './Components/PagePrint';\r\nimport SetupPin from './Components/SetupPin.js';\r\n\r\nimport LoaderSplashScreen from './Components/LoaderSplashScreen';\r\n\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\n\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\nimport './assets/iconfont/material-icons.css';\r\nimport './assets/iconfont/test.css';\r\n\r\nimport * as tools from \"./tools\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport t from \"./Components/i18n\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\n\r\n\r\n// CANCELED:    \r\n\r\n// DONE: repeat apply contrast & brightness & color from previous photo (and undo)\r\n\r\n// TODO:    - /\r\n// DONE:       DPI\r\n// TODO: printMode 'backend - Wait for each file' broken\r\n// TODO:   printMode frontent\r\n// TODO:     \r\n// TODO:   CDROM   ,  /  \r\n\r\n\r\nclass App extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.updateSavePageTimer = null;\r\n        this.appWrapperNode = null;\r\n    }\r\n    state = {\r\n        appstate: 'start',\r\n        pages: {},\r\n        sources: [],\r\n        currentSource: null,\r\n        formats: [],\r\n        currentFormat: null,\r\n        images: [],\r\n        is_loading_init: false,\r\n\r\n        editorHeight: 0,\r\n        editorWidth: 0,\r\n\r\n        // needUpdateCanvas: false,\r\n\r\n        snackMessage: null,\r\n        setup: {\r\n            batchSaveMode: false\r\n        },\r\n\r\n        isAppStarting: true,\r\n        isSetup: false,\r\n        isSetupLogged: false,\r\n        isSetupPassword: '',\r\n        isUploadEnable: false,\r\n        isPleaseWait: false,\r\n        progressBarValue: -1,\r\n\r\n        isDebugShow: false,\r\n\r\n        appWidth: null,\r\n        appHeight: null,\r\n\r\n        serverError: null,\r\n        version: version\r\n    };\r\n\r\n\r\n    appSetState = (stateToSave, fn_callback)=> {\r\n        let state = this.state;\r\n        for (let prop in stateToSave) {\r\n            state[prop] = stateToSave[prop];\r\n        }\r\n        this.setState(state,\r\n            ()=>{\r\n                if( typeof(fn_callback) === 'function') fn_callback();\r\n            });\r\n    };\r\n\r\n    appImageChanged = (index, editorState, fn_callback) => {\r\n        let image = this.state.images[index];\r\n        for (let prop in editorState) {\r\n            image.editorState[prop] = editorState[prop];\r\n        }\r\n        let images = this.state.images;\r\n        images[index] = image;\r\n        this.setState({\r\n            images: images,\r\n        }, ()=>{\r\n            if( typeof(fn_callback) === 'function') fn_callback();\r\n        })\r\n    };\r\n\r\n\r\n    appEditorChanged = (clientWidth,clientHeight) => {\r\n        // console.log(\"appEditorChanged: \"+this.state.editorWidth+\" === \"+clientWidth+\" && \"+this.state.editorHeight+\" === \"+clientHeight)\r\n\r\n        if(this.state.editorWidth === clientWidth && this.state.editorHeight === clientHeight) {\r\n            return;\r\n        }\r\n\r\n        let images = this.state.images;\r\n        let len = images.length;\r\n        for(let i=0; i<len; i++ ) {\r\n            images[i].editorState.initedMask = false;\r\n        }\r\n        this.setState({\r\n            editorWidth: clientWidth,\r\n            editorHeight: clientHeight,\r\n            images: images,\r\n        }, ()=>{\r\n            if(this.state.currentImage>=0) {\r\n                console.log('try reinit');\r\n                this.appImageInitMask(this.state.currentImage, true);\r\n            }\r\n        })\r\n    };\r\n\r\n    appImageInitMask(index, force, fn_callback) {\r\n\r\n        let image = this.state.images[index];\r\n        if(image.editorState.initedMask && !force) {\r\n            if( typeof(fn_callback) === 'function') fn_callback();\r\n            return;\r\n        }\r\n\r\n        // console.log(p.stateEditorWidth, p.editorWidth, p.stateEditorHeight, p.editorHeight);\r\n        let formatRatio = (image.format.height && image.format.width ? image.format.height / image.format.width : 1);\r\n        // console.log('this ratio : '+ratio);\r\n        let maskTB = 0;\r\n        let maskLR = 0;\r\n\r\n        let editorRatio = this.state.editorHeight / this.state.editorWidth;\r\n        // console.log('editorWidth:'+this.state.editorWidth, ' editorHeight:'+this.state.editorHeight);\r\n        if(formatRatio>editorRatio) {\r\n            maskLR = (this.state.editorWidth-image.format.width/image.format.height*this.state.editorHeight)/2;\r\n        } else {\r\n            maskTB = (this.state.editorHeight-image.format.height/image.format.width*this.state.editorWidth)/2;\r\n        }\r\n\r\n        let newState = {\r\n            maskTB: maskTB,\r\n            maskLR: maskLR,\r\n            ratio: (this.state.editorHeight-maskTB*2)/tools.dpi_inch2dots(image.format.height, image.format.dpi),\r\n            initedMask: true,\r\n        };\r\n        // console.log(newState);\r\n        // if(!ret) {\r\n            this.appImageChanged(index, newState, ()=>{\r\n                if( typeof(fn_callback) === 'function') fn_callback();\r\n            });\r\n        // }\r\n\r\n        // return newState;\r\n\r\n    }\r\n\r\n    alignInit = (index, fn_callback)=> {\r\n        let image = this.state.images[index];\r\n        let format = image.format;\r\n        let initrotate = false;\r\n        let format_lanscape = (format.width-format.height)>1;\r\n        let image_landscape = (image.width-image.height)>1;\r\n\r\n        // console.log('format_lanscape:', format.width,'>', format.height, '=', format_lanscape);\r\n\r\n        if(format_lanscape !== image_landscape) {\r\n            initrotate = true;\r\n                        // console.log('initrotate', initrotate);\r\n        }\r\n\r\n        if(initrotate) {\r\n            if(format_lanscape) {\r\n                this.alignPortrait(index, fn_callback,true, initrotate);\r\n            } else {\r\n                this.alignLandscape(index, fn_callback, true, initrotate);\r\n            }\r\n        } else {\r\n            if(format_lanscape) {\r\n                this.alignLandscape(index, fn_callback, true);\r\n            } else {\r\n                this.alignPortrait(index, fn_callback, true);\r\n            }\r\n        }\r\n    };\r\n\r\n    alignLandscape = (index, fn_callback, init, initrotate)=> {\r\n        let image = this.state.images[index];\r\n                                // console.log('alignLandscape landscape', image.editorState.ratio);\r\n        let sliderPositionLR = 0;\r\n        let imageZoom = image.format.width/image.width;\r\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n        let viewportY = this.state.editorHeight - image.editorState.maskTB*2;\r\n        let sliderPositionTB = (viewportY - imgHeight)/2;\r\n        let isWhiteFields = viewportY > imgHeight;\r\n                                // console.log('alignLandscape', 'isWhiteFields', isWhiteFields,)\r\n\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270 || initrotate) {\r\n            imageZoom = image.format.width/image.height;\r\n            imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n            imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n            sliderPositionTB = (imgWidth-imgHeight)/2 + (viewportY-imgWidth)/2 ;\r\n            sliderPositionLR = (imgHeight-imgWidth)/2;\r\n            isWhiteFields = viewportY > imgWidth;\r\n                                // console.log('alignLandscape', 'isWhiteFields', isWhiteFields,)\r\n        }\r\n\r\n        if(init && isWhiteFields) {\r\n            this.alignPortrait(index, fn_callback, false, initrotate);\r\n            return;\r\n        }\r\n\r\n        let editorState = {\r\n            imageZoom : imageZoom,\r\n            imageZoomMax: imageZoom*5,\r\n            imageZoomMin: imageZoom*0.5,\r\n            sliderPositionTB: sliderPositionTB,\r\n            sliderPositionLR: sliderPositionLR,\r\n            imgWidth: imgWidth,\r\n            imgHeight: imgHeight,\r\n            initedImagePosition: !(imgWidth===0 && imgHeight===0),\r\n            needUpdateCanvas: imageZoom>image.editorState.imageZoom,\r\n        };\r\n        if(initrotate) editorState['imageRotate']=90;\r\n\r\n        this.appImageChanged(index, editorState, fn_callback);\r\n\r\n    };\r\n    alignPortrait = (index, fn_callback, init, initrotate)=> {\r\n        let image = this.state.images[index];\r\n                                // console.log('alignPortrait', image.editorState.ratio);\r\n        let sliderPositionTB = 0;\r\n        let imageZoom = image.format.height/image.height;\r\n        let imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n        let imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n        let viewportX = this.state.editorWidth - image.editorState.maskLR*2;\r\n        let sliderPositionLR = (viewportX - imgWidth)/2;\r\n        let isWhiteFields = viewportX > imgWidth;\r\n                                // console.log('alignPortrait', 'isWhiteFields', isWhiteFields,)\r\n\r\n        if(image.editorState.imageRotate===90 || image.editorState.imageRotate===270 || initrotate) {\r\n            imageZoom = image.format.height/image.width;\r\n            imgWidth = tools.dpi_inch2dots(image.width, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n            imgHeight = tools.dpi_inch2dots(image.height, image.format.dpi) * imageZoom * image.editorState.ratio;\r\n            sliderPositionLR = (imgHeight-imgWidth)/2 + (viewportX-imgHeight)/2 ;\r\n            sliderPositionTB = (imgWidth-imgHeight)/2;\r\n            isWhiteFields = viewportX > imgHeight;\r\n                                // console.log('alignPortrait', 'isWhiteFields', isWhiteFields,)\r\n        }\r\n\r\n        if(init && isWhiteFields) {\r\n            this.alignLandscape(index, fn_callback, false, initrotate);\r\n            return;\r\n        }\r\n\r\n        let editorState = {\r\n            imageZoom: imageZoom,\r\n            imageZoomMax: imageZoom*5,\r\n            imageZoomMin: imageZoom*0.5,\r\n            sliderPositionTB: sliderPositionTB,\r\n            sliderPositionLR: sliderPositionLR,\r\n            imgWidth: imgWidth,\r\n            imgHeight: imgHeight,\r\n            initedImagePosition: !(imgWidth===0 && imgHeight===0),\r\n            needUpdateCanvas: imageZoom>image.editorState.imageZoom,\r\n        };\r\n        if(initrotate) editorState['imageRotate']=90;\r\n\r\n        this.appImageChanged(index, editorState, fn_callback);\r\n\r\n    };\r\n\r\n    updateDimensions() {\r\n        if(this.appWrapperNode) {\r\n            let appWidth = this.appWrapperNode.clientWidth;\r\n            let appHeight = this.appWrapperNode.clientHeight;\r\n            if(this.appWrapperNode.clientWidth > this.appWrapperNode.clientHeight) {\r\n                // console.log(appWidth,appHeight);\r\n                this.setState({appWidth: appWidth, appHeight: appHeight});\r\n            }\r\n        }\r\n    }\r\n\r\n    checkLoadedState = (state)=> {\r\n        state.isUploadEnable = false;\r\n        delete state.version;\r\n        delete state.appWidth;\r\n        delete state.appHeight;\r\n        state.isAppStarting = false;\r\n        return state;\r\n    };\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener(\"resize\", this.updateDimensions);\r\n    }\r\n    componentDidMount() {\r\n        window.addEventListener(\"resize\", this.updateDimensions);\r\n\r\n        // this.updateDimensions();\r\n\r\n        let uri = makeGetUri({'q':'init'});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        let state = this.checkLoadedState(res.data.data);\r\n                        for (let prop in res.data.setup) {\r\n                            state.setup[prop] = res.data.setup[prop];\r\n                        }\r\n                        this.setState(state, ()=>{\r\n                            this.updateDimensions();\r\n                        });\r\n                    }\r\n                } else {\r\n                    this.setState({serverError:res.data.error});\r\n                }\r\n            } else {\r\n                this.setState({serverError:'Error: server fail'});\r\n            }\r\n        }).catch((error)=>{\r\n            console.log(error);\r\n            this.setState({serverError:error.message});\r\n        });\r\n    }\r\n\r\n    resetApp() {\r\n        let uri = makeGetUri({'q':'init', 'reset':'reset'});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if(res.data.data) {\r\n                        let state = this.checkLoadedState(res.data.data);\r\n                        for (let prop in res.data.setup) {\r\n                            state.setup[prop] = res.data.setup[prop];\r\n                        }\r\n                        this.setState(state, ()=>{ this.updateDimensions(); this.savePages(); });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n\r\n    onMessage = (msg) => {\r\n      if(msg) {\r\n          this.setState({\r\n              snackMessage: msg\r\n          })\r\n      }\r\n    };\r\n    onMessageHide = () => {\r\n        this.setState({\r\n            snackMessage: null\r\n        })\r\n    };\r\n\r\n    uploadEnable =(ev)=> {\r\n        ev.preventDefault();\r\n\r\n        let uri = tools.makeGetUri({'q':'login', 'pass': this.state.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.setState({isUploadEnable:true, isSetup:false});\r\n                } else {\r\n                    console.log(res.data.error);\r\n                    this.Logout();\r\n                }\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    Login = (ev) => {\r\n        ev.preventDefault();\r\n        // ev.stopPropagation();\r\n        let uri = tools.makeGetUri({'q':'login', 'pass': this.state.isSetupPassword});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    this.setState({isSetupLogged: true,})\r\n                } else {\r\n                    console.log(res.data.error);\r\n                    this.Logout();\r\n                }\r\n            }\r\n        });\r\n        return false;\r\n    };\r\n\r\n    Logout = () => {\r\n        this.setState({isSetup : false, isSetupLogged: false, isSetupPassword: '' }, ()=>{this.savePages();});\r\n\r\n    };\r\n\r\n\r\n\r\n    savePages(pageid, pagestate, OKmessage) {\r\n      let newAppState = this.state;\r\n\r\n        if(this.updateSavePageTimer) clearTimeout(this.updateSavePageTimer);\r\n        this.updateSavePageTimer = setTimeout(()=>{\r\n            let uri = makeGetUri();\r\n            const params = new URLSearchParams();\r\n            params.append('q', 'saveClientState');\r\n            params.append('state', JSON.stringify(newAppState));\r\n            axios.post(uri, params ).then(res => {\r\n                if(res.status===200) {\r\n                    if(res.data.error==='') {\r\n                        if(OKmessage) this.onMessage(OKmessage);\r\n                        // console.log('state saved, '+this.state.appstate);\r\n                    }\r\n                }\r\n            });\r\n        }, 1700);\r\n    }\r\n\r\n\r\n    sourceClick(id) {\r\n      //console.log(id);\r\n        const source = this.state.sources[id];\r\n        if(!source.enabled) return;\r\n\r\n        if(!source.emptyhide || (source.emptyhide && source.hasFiles))\r\n            this.setState({currentSource: id})\r\n    }\r\n\r\n    formatClick(id) {\r\n        //console.log(id);\r\n        this.setState({currentFormat: id})\r\n    }\r\n\r\n    removeTmp( fn_callback ){\r\n        let uri = makeGetUri({'q':'removetmp'});\r\n        axios.get(uri).then(res => {\r\n            if(res.status===200) {\r\n                if(res.data.error==='') {\r\n                    if( typeof(fn_callback) === 'function') fn_callback();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    scriptSource = (source, s_key) => {\r\n        // let s_key = 'scripton';\r\n        if(source[s_key] && source[s_key]!=='') {\r\n            let uri = makeGetUri({'q':'scriptSource', 'scripts':source[s_key]});\r\n            axios.get(uri);\r\n        }\r\n    };\r\n\r\n    autoclearSource = (source_id) => {\r\n        if(this.state.sources[source_id].autoclear) {\r\n            let uri = makeGetUri({'q':'autoclearSource','id':source_id} );\r\n            axios.get(uri);\r\n        }\r\n    };\r\n\r\n    ClickNextBtn(args) {\r\n      switch (this.state.appstate) {\r\n          case 'start':\r\n              this.scriptSource(this.state.sources[this.state.currentSource], 'scripton');\r\n              this.removeTmp(()=>{ this.setState({appstate: 'loadImages'}) });\r\n              break; // ---------------------------------------------------------------------------------\r\n\r\n          case 'loadImages':\r\n              this.scriptSource(this.state.sources[this.state.currentSource], 'scriptoff');\r\n              this.setState({appstate:'editor', images:args, currentImage:null, isPleaseWait:false });\r\n              break; // ---------------------------------------------------------------------------------\r\n\r\n          case 'editor':\r\n              this.setState({appstate:'print' }, ()=>{this.savePages()});\r\n              break; // ---------------------------------------------------------------------------------\r\n\r\n          case 'print':\r\n              this.autoclearSource(this.state.currentSource);\r\n              this.resetApp();\r\n              break; // ---------------------------------------------------------------------------------\r\n\r\n          default:\r\n              alert('no action');\r\n              break;\r\n      }\r\n    }\r\n\r\n    ClickPrevBtn() {\r\n        switch (this.state.appstate) {\r\n            case 'loadImages':\r\n                this.autoclearSource(this.state.currentSource);\r\n                this.resetApp();\r\n                break; // ---------------------------------------------------------------------------------\r\n\r\n            case 'editor':\r\n                this.scriptSource(this.state.sources[this.state.currentSource], 'scripton');\r\n                this.setState({appstate: 'loadImages'});\r\n                break; // ---------------------------------------------------------------------------------\r\n\r\n            case 'print':\r\n                this.setState({appstate: 'editor'});\r\n                break; // ---------------------------------------------------------------------------------\r\n\r\n            default:\r\n                alert('no action');\r\n\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        let wrongOrientation = (!this.state.serverError && this.appWrapperNode && this.appWrapperNode.clientHeight > this.appWrapperNode.clientWidth) ? true: false;\r\n\r\n        let toRenderd = <div> </div>;\r\n        let appstate = this.state.appstate;\r\n        if(this.state.isSetupLogged) {\r\n            appstate = 'setup';\r\n        }\r\n\r\n        if(this.state.isAppStarting || wrongOrientation) {\r\n            toRenderd = <LoaderSplashScreen serverError={this.state.serverError} />;\r\n        } else {\r\n            switch (appstate) {\r\n                case 'setup':\r\n                    toRenderd =  (\r\n                        <PageSetup\r\n                            app={this.state}\r\n                            onMessage={this.onMessage}\r\n                            appSetState = {this.appSetState.bind(this)}\r\n                            Logout = {this.Logout.bind(this)}\r\n                            savePages={this.savePages.bind(this)}\r\n\r\n                />\r\n                    );\r\n                    break;\r\n                case 'start':\r\n                    toRenderd =  (\r\n                        <PageStart\r\n                            app={this.state}\r\n                            onMessage={this.onMessage}\r\n                            onClickSource={(id) => this.sourceClick(id)}\r\n                            onClickFormat={(id) => this.formatClick(id)}\r\n                            onClickNextBtn={() => this.ClickNextBtn()}\r\n                            savePages={this.savePages.bind(this)}\r\n                            appSetState = {this.appSetState.bind(this)}\r\n                        />\r\n                    );\r\n                    break;\r\n\r\n                case 'loadImages':\r\n                    toRenderd =  (\r\n                        <PageLoadImages\r\n                            app={this.state}\r\n                            onMessage={this.onMessage}\r\n                            onClickNextBtn={(this.ClickNextBtn.bind(this))}\r\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\r\n                            savePages={this.savePages.bind(this)}\r\n                            appSetState = {this.appSetState.bind(this)}\r\n                        />\r\n                    );\r\n                    break;\r\n\r\n                case 'editor':\r\n                    toRenderd =  (\r\n                        <PageEditor\r\n                            app={this.state}\r\n                            onMessage={this.onMessage}\r\n                            onClickNextBtn={() => this.ClickNextBtn()}\r\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\r\n                            savePages={this.savePages.bind(this)}\r\n\r\n                            appSetState = {this.appSetState.bind(this)}\r\n                            appImageInitMask = {this.appImageInitMask.bind(this)}\r\n                            appEditorChanged = {this.appEditorChanged.bind(this)}\r\n                            appImageChanged = {this.appImageChanged.bind(this)}\r\n                            alignInit = {this.alignInit.bind(this)}\r\n                            alignLandscape = {this.alignLandscape.bind(this)}\r\n                            alignPortrait = {this.alignPortrait.bind(this)}\r\n\r\n\r\n\r\n                        />\r\n                    );\r\n                    break;\r\n\r\n                case 'print':\r\n                    toRenderd =  (\r\n                        <PagePrint\r\n                            app={this.state}\r\n                            onMessage={this.onMessage}\r\n                            onClickNextBtn={(this.ClickNextBtn.bind(this))}\r\n                            onClickPrevBtn={() => this.ClickPrevBtn()}\r\n                            savePages={this.savePages.bind(this)}\r\n                            appSetState = {this.appSetState.bind(this)}\r\n                            alignInit = {this.alignInit.bind(this)}\r\n                            alignLandscape = {this.alignLandscape.bind(this)}\r\n                            alignPortrait = {this.alignPortrait.bind(this)}\r\n                            appImageInitMask = {this.appImageInitMask.bind(this)}\r\n                        />\r\n                    );\r\n                    break;\r\n\r\n                default:\r\n                    toRenderd = (\r\n                        <div className=\"App\">\r\n                            Learn React\r\n                        </div>\r\n                    );\r\n            }\r\n\r\n        }\r\n\r\n\r\n        let appWidth = this.state.appWidth ? this.state.appWidth : '100%';\r\n        let appHeight = this.state.appHeight ? this.state.appHeight : '100%';\r\n        return (\r\n            <div ref={(node)=>{this.appWrapperNode=node}}\r\n                style={{width:appWidth, height:appHeight}}\r\n                className={\"app-wrapper\"}>\r\n                <CssBaseline />\r\n                <MuiThemeProvider theme={THEME}>\r\n                    <SetupPin app={this.state}\r\n                              appSetState = {this.appSetState.bind(this)}\r\n                              Login = { this.state.isSetup === 1 ? this.Login.bind(this) :\r\n                                        this.state.isSetup === 2 ? this.uploadEnable.bind(this) :\r\n                                        this.Login.bind(this)\r\n                              }\r\n                              Logout = {this.Logout.bind(this)}\r\n                    />\r\n                    {toRenderd}\r\n                    <Snackbar\r\n                        anchorOrigin={{ vertical: 'bottom', horizontal: 'left', }}\r\n                        autoHideDuration={6000}\r\n                        open={(this.state.snackMessage!==null)}\r\n                        onClose={this.onMessageHide}\r\n                        ContentProps={{\r\n                            'aria-describedby': 'message-id',\r\n                        }}\r\n                        message={<span id=\"message-id\">{this.state.snackMessage}</span>}\r\n                        action={[\r\n                            <IconButton\r\n                                key=\"close\"\r\n                                aria-label=\"Close\"\r\n                                color=\"inherit\"\r\n                                className={'classes.close'}\r\n                                onClick={this.onMessageHide}\r\n                            >\r\n                                <CloseIcon />\r\n                            </IconButton>\r\n                        ]}\r\n                    />\r\n\r\n                    {this.state.isPleaseWait && (\r\n                        <div className=\"app-please-wait-wrp position-fixed\">\r\n                            <div onClick={()=>{this.setState({isPleaseWait:false})}} className = \"app-please-wait spinner-border text-primary\" role = \"status\" >\r\n                                <span className = \"sr-only\" > Loading...</span>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <Dialog\r\n                        open={wrongOrientation}\r\n                        onClose={()=>{this.updateDimensions()}}\r\n                        aria-labelledby=\"alert-dialog-title\"\r\n                        aria-describedby=\"alert-dialog-description\"\r\n                    >\r\n                        <DialogTitle id=\"alert-dialog-title\">{t('Wrong orientation')}</DialogTitle>\r\n                        <DialogContent>\r\n                            <DialogContentText id=\"alert-dialog-description\">\r\n                                {t(\"Please, turn your device to lanscape\")}\r\n                            </DialogContentText>\r\n                        </DialogContent>\r\n                        <DialogActions>\r\n                            <button onClick={()=>{this.updateDimensions()}} className={\"btn btn-big  btn-primary\"} autoFocus>\r\n                                OK\r\n                            </button>\r\n                        </DialogActions>\r\n                    </Dialog>\r\n\r\n\r\n                </MuiThemeProvider>\r\n\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n//import 'bootstrap/dist/css/bootstrap.css';\nimport './index.css';\n\nimport App from './App';\n\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}